!function(_){function e(e){for(var o,a,l=e[0],s=e[1],n=e[2],d=0,b=[];d<l.length;d++)a=l[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&b.push(i[a][0]),i[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(_[o]=s[o]);for(c&&c(e);b.length;)b.shift()();return r.push.apply(r,n||[]),t()}function t(){for(var _,e=0;e<r.length;e++){for(var t=r[e],o=!0,l=1;l<t.length;l++){var s=t[l];0!==i[s]&&(o=!1)}o&&(r.splice(e--,1),_=a(a.s=t[0]))}return _}var o={},i={"web/photoview":0},r=[];function a(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return _[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.e=function(_){var e=[],t=i[_];if(0!==t)if(t)e.push(t[2]);else{var o=new Promise((function(e,o){t=i[_]=[e,o]}));e.push(t[2]=o);var r,l=document.createElement("script");l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.src=function(_){return a.p+"bundles/"+({youla_item_create:"youla_item_create"}[_]||_)+"."+{youla_item_create:"447456a6bbc85e11223c"}[_]+".js"}(_);var s=new Error;r=function(e){l.onerror=l.onload=null,clearTimeout(n);var t=i[_];if(0!==t){if(t){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;s.message="Loading chunk "+_+" failed.\n("+o+": "+r+")",s.name="ChunkLoadError",s.type=o,s.request=r,t[1](s)}i[_]=void 0}};var n=setTimeout((function(){r({type:"timeout",target:l})}),12e4);l.onerror=l.onload=r,document.head.appendChild(l)}return Promise.all(e)},a.m=_,a.c=o,a.d=function(_,e,t){a.o(_,e)||Object.defineProperty(_,e,{enumerable:!0,get:t})},a.r=function(_){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_,"__esModule",{value:!0})},a.t=function(_,e){if(1&e&&(_=a(_)),8&e)return _;if(4&e&&"object"==typeof _&&_&&_.__esModule)return _;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:_}),2&e&&"string"!=typeof _)for(var o in _)a.d(t,o,function(e){return _[e]}.bind(null,o));return t},a.n=function(_){var e=_&&_.__esModule?function(){return _.default}:function(){return _};return a.d(e,"a",e),e},a.o=function(_,e){return Object.prototype.hasOwnProperty.call(_,e)},a.p="/js/cmodules/",a.oe=function(_){throw console.error(_),_};var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var n=0;n<l.length;n++)e(l[n]);var c=s;r.push([294,"evbus","lottie","common","palette","e0b5e85860cc0e43692001a90ce0d3bc","e664f14fb87266cecd9413da563dcda4","88ece9fd553062188532d75b5446f241"]),t()}({"/bCM":function(_,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return i})),t.d(e,"c",(function(){return r})),t.d(e,"d",(function(){return a})),t.d(e,"e",(function(){return l}));var o=0,i=7,r=0,a=void 0,l=2},"1OKH":function(_,e,t){"use strict";t.d(e,"a",(function(){return f}));t("SRfc"),t("KKXr"),t("pIFo");var o,i=t("zxIV"),r=t("v+DW"),a=t("EasH"),l=t("smNX"),s=t("YoAk"),n=t("/PiP"),c=t("Egk5"),d=t("HLtZ"),b=t("Nk8j");!function(_){_[_.ACTIVE=0]="ACTIVE",_[_.CONFIRMED=1]="CONFIRMED",_[_.DECLINED=2]="DECLINED",_[_.DELETED=3]="DELETED"}(o||(o={}));var p,u=function(){function _(_){var e=this;this.status=o.ACTIVE,this.isLoading=!1,this.onPhotoClick=function(_){_.ctrlKey||_.metaKey||(e.showPhoto(_),Object(c.c)(_))},this.onConfirmClick=function(){e.confirm().then((function(){var _=e.getTags();e.tagArea.setConfirmedTags(_),e.updatePhotoviewCache(!0),e.setViewStatus(o.CONFIRMED)}),(function(_){_&&Object(d.c)(_)})).finally((function(){e.isLoading=!1}))},this.onDeclineClick=function(){e.isLoading||(e.isLoading=!0,e.decline().then((function(){e.setOverlay(),e.updatePhotoviewCache(!0),e.setViewStatus(o.DECLINED)}),(function(_){_&&Object(d.c)(_)})).finally((function(){e.isLoading=!1})))},this.onCancelClick=function(){e.setOverlay(!1),e.tagArea.reset(),e.setViewStatus(o.ACTIVE)},this.el=_;var t=_.dataset.photoViewOptions,i=_.dataset.photoContext,r=_.dataset.photoRawId,a=t&&Object(l.a)(t),n=_.dataset.tagHash;if(!(a&&r&&i&&n))throw new Error("PhotoTagCard: incorrect arguments");var b=r.split("_"),p=b[0],u=b[1];this.ownerId=Number(p),this.photoId=Number(u),this.photoRawId=r,this.photoContext=i,this.photoViewOptions=a,this.photoUrl=_.dataset.photoUrl;var E=_.querySelector(".PhotoTagCard__button--confirm"),O=_.querySelector(".PhotoTagCard__button--decline"),h=_.querySelector(".PhotoTagCard__button--cancelConfirm"),w=_.querySelector(".PhotoTagCard__button--cancelDecline"),v=_.querySelector(".PhotoTagCard__desc"),m=_.querySelector(".PhotoTagCard__photo"),P=_.querySelector(".PhotoTagCard__result");if(!(E&&O&&v&&m&&P))throw new Error("PhotoTagCard: there are not elements");this.photoEl=m,this.confirmBtn=E,this.declineBtn=O,this.description=v,this.cancelConfirmBtn=h,this.cancelDeclineBtn=w,this.resultPanel=P,this.tagArea=new s.a(this,n),this.init()}return _.prototype.destroy=function(){this.deInitListeners()},_.prototype.getPhotoRawId=function(){return this.photoRawId},_.prototype.getEl=function(){return this.photoEl},_.prototype.setConfirmedTagsByIds=function(_){this.tagArea.setConfirmedTagsByIds(_)&&this.setViewStatus(o.CONFIRMED)},_.prototype.setDeclinedTagsByIds=function(_){this.tagArea.setDeclinedTagsByIds(_)&&(this.setOverlay(),this.setViewStatus(o.DECLINED))},_.prototype.setDeletedTagsByIds=function(_){this.tagArea.setDeclinedTagsByIds(_)&&this.setViewStatus(o.DELETED)},_.isPhotoSuggestedTagCard=function(_){return Boolean(Number(_.dataset.isSuggest))},_.prototype.init=function(){this.initListeners(),this.photoUrl&&this.checkPhotoHasNoSizes()&&this.correctTagView(this.photoUrl)},_.prototype.initListeners=function(){var _,e;this.confirmBtn.addEventListener("click",this.onConfirmClick),this.declineBtn.addEventListener("click",this.onDeclineClick),null===(_=this.cancelConfirmBtn)||void 0===_||_.addEventListener("click",this.onCancelClick),null===(e=this.cancelDeclineBtn)||void 0===e||e.addEventListener("click",this.onCancelClick),this.photoEl.addEventListener("click",this.onPhotoClick)},_.prototype.deInitListeners=function(){var _,e;this.confirmBtn.removeEventListener("click",this.onConfirmClick),this.declineBtn.removeEventListener("click",this.onDeclineClick),null===(_=this.cancelConfirmBtn)||void 0===_||_.removeEventListener("click",this.onCancelClick),null===(e=this.cancelDeclineBtn)||void 0===e||e.removeEventListener("click",this.onCancelClick),this.photoEl.removeEventListener("click",this.onPhotoClick)},_.prototype.setViewStatus=function(_){var e=this.resultPanel.querySelector(".PhotoTagCard__resultWrapper");if(e){if(this.status=_,_===o.ACTIVE)return Object(i.bb)(this.resultPanel),void Object(i.xb)(this.description);e.innerHTML=this.getResultText(_),Object(i.bb)(this.description),_===o.CONFIRMED?(this.resultPanel.classList.add("PhotoTagCard__result--confirm"),this.resultPanel.classList.remove("PhotoTagCard__result--decline")):_===o.DECLINED?(this.resultPanel.classList.remove("PhotoTagCard__result--confirm"),this.resultPanel.classList.add("PhotoTagCard__result--decline")):(this.resultPanel.classList.remove("PhotoTagCard__result--confirm"),this.resultPanel.classList.remove("PhotoTagCard__result--decline")),Object(i.xb)(this.resultPanel)}},_.prototype.setOverlay=function(_){void 0===_&&(_=!1),this.photoEl.classList.toggle("PhotoTagCard__photo--disable",_)},_.prototype.showPhoto=function(_){Object(n.D)(this.photoRawId,this.photoContext,this.photoViewOptions,_),this.updatePhotoviewCache()},_.prototype.getTags=function(){return this.tagArea.getTags()},_.prototype.getConfirmedTags=function(){return this.tagArea.getConfirmedTags()},_.prototype.updatePhotoviewCache=function(_){void 0===_&&(_=!1),this.photoViewOptions.noCache=_,_&&Object(b.a)()},_.prototype.checkPhotoHasNoSizes=function(){return this.el.classList.contains("PhotoTagCard--noSize")},_.prototype.correctTagView=function(_){var e=this,t=new Image;t.onload=function(){var o=t.width,i=t.height;if(o&&i){var r=s.a.calculateTagAreaSizes(e.photoEl,o,i),a=r[0],l=r[1],n=e.el.querySelector(".PhotoTagCard__stub");n&&n.remove();var c=document.createElement("div");c.classList.add("PhotoTagCard__image"),c.style.backgroundSize=a+"px "+l+"px",c.style.backgroundImage="url('"+_+"')",e.photoEl.appendChild(c);var d=a+1,b=l+1;e.tagArea.setSizes(d,b),e.tagArea.show(),e.el.classList.remove("PhotoTagCard--noSize")}},t.src=_},_.prototype.getOwnerId=function(){return this.ownerId},_.prototype.isActive=function(){return this.status===o.ACTIVE},_}(),E=t("dBLD"),O=t("4+be"),h=(p=function(_,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,e){_.__proto__=e}||function(_,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(_[t]=e[t])})(_,e)},function(_,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=_}p(_,e),_.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),w=function(_){function e(e){return _.call(this,e)||this}return h(e,_),e.prototype.confirm=function(){var _=this.getTags();return this.tagArea.confirmTag(_[0],this,this.confirmBtn)},e.prototype.decline=function(){var _=this.getTags();return this.tagArea.declineTag(_[0],this,this.declineBtn)},e.prototype.getResultText=function(_){var e=this.getTags()[0].getPlacerNameGenitive()||"",t="";switch(_){case o.CONFIRMED:t=Object(O.d)("photo_recognition_confirm_myself").replace("{name}",e);break;case o.DECLINED:t=Object(O.d)("photo_recognition_decline_myself").replace("{name}",e);break;default:t=Object(O.d)("photo_recognition_deleted_tag")}return t},e}(u),v=function(){var _=function(e,t){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,e){_.__proto__=e}||function(_,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(_[t]=e[t])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}_(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),m=function(_){function e(e){return _.call(this,e)||this}return v(e,_),e.prototype.confirm=function(){return this.tagArea.confirmSuggestedTags(this.getTags(),this,this.confirmBtn)},e.prototype.decline=function(){return this.tagArea.declineSuggestedTags(this.getTags(),this,this.declineBtn)},e.prototype.getResultText=function(_){var e=this.getOwnerId(),t=this.tagArea.getTags()[0].getOwnerNameGenitive(),i="";switch(_){case o.CONFIRMED:i=(i=e>0?Object(O.d)("photo_recognition_confirm_myself_on_photo"):Object(O.d)("photo_recognition_confirm_myself_on_photo_group")).replace("{name}",t);break;case o.DECLINED:i=(i=e>0?Object(O.d)("photo_recognition_decline_on_photo"):Object(O.d)("photo_recognition_decline_on_photo_group")).replace("{name}",t);break;default:i=Object(O.d)("photo_recognition_deleted_tag")}return i},e}(u),P=t("BJj/"),D=t("7lz1"),M=t("kcIO"),g=function(){function _(_,e){var t=this;this.isLoading=!1,this.isDestroyed=!1,this.handleOutsideConfirmationSuggestedTags=function(_){var e=_.detail.photoRawId,o=_.detail.tagIds;t.cards.filter((function(_){return _.getPhotoRawId()===e})).forEach((function(_){return _.setConfirmedTagsByIds(o)}))},this.handleOutsideDeclinationSuggestedTags=function(_){var e=_.detail.photoRawId,o=_.detail.tagIds;t.cards.filter((function(_){return _.getPhotoRawId()===e})).forEach((function(_){return _.setDeclinedTagsByIds(o)}))},this.handleOutsideConfirmationUserTag=function(_){var e=_.detail.photoRawId,o=_.detail.tagId,i=t.cards.find((function(_){return _.getPhotoRawId()===e}));i&&i.setConfirmedTagsByIds([o])},this.handleOutsideDeclinationUserTag=function(_){var e=_.detail.photoRawId,o=_.detail.tagId,i=t.cards.find((function(_){return _.getPhotoRawId()===e}));i&&i.setDeclinedTagsByIds([o])},this.handleOutsideDeletingTags=function(_){var e=_.detail.photoRawId,o=_.detail.tagIds;t.cards.filter((function(_){return _.getPhotoRawId()===e})).forEach((function(_){return _.setDeletedTagsByIds(o)}))},this.checkScroll=Object(P.a)((function(){t.isLoading||window.innerHeight+window.pageYOffset+700>=t.cardsBlock.getBoundingClientRect().bottom&&t.loadMore()}),200),this.loadMore=function(){!t.isLoading&&t.nextOffset&&(t.isLoading=!0,window.ajax.post("al_photos.php",{act:"recognition_tags",part:1,offset:t.nextOffset,is_full_page:Number(t.isFullPage)},{onDone:function(_,e,o){var r;if(t.isLoading=!1,!t.isDestroyed){t.fullCardsNumber=e,t.nextOffset=o,t.nextOffset||document.removeEventListener("scroll",t.checkScroll);var a=null==_?void 0:_.map((function(_){var e=Object(i.rb)(_);return t.cardsBlock.appendChild(e),e}));(null==a?void 0:a.length)&&(r=t.cards).push.apply(r,t.createCards(a)),o||Object(i.bb)(t.loadMoreBtn)}},showProgress:function(){return Object(r.o)(t.loadMoreBtn)},hideProgress:function(){return Object(r.w)(t.loadMoreBtn)}}))},this.getAllTagElements=function(_){return Array.from(_.querySelectorAll(".PhotoTagCard"))},this.onConfirmAll=function(){if(t.confirmAllHash){var _=t.getActiveCardsNumber();window.ajax.post("al_photos.php",{act:"confirm_all_tags",hash:t.confirmAllHash},{onDone:function(){t.onSubmitAll(_,Object(O.d)("photo_tags_confirmed_text",_))},onFail:function(_){return Object(a.d)(Object(O.d)("global_error"),_||Object(O.d)("global_unknown_error")),!0},showProgress:function(){return Object(r.o)(t.confirmAllBtn)},hideProgress:function(){return Object(r.w)(t.confirmAllBtn)}})}},this.onDeclineAll=function(){if(t.declineAllHash){var _=t.getActiveCardsNumber();Object(a.d)(Object(O.d)("photo_tag_decline_box_title",_),Object(O.d)("photo_tag_decline_box_description"),Object(O.d)("photo_recognition_decline_all"),(function(e){!function(e){window.ajax.post("al_photos.php",{act:"decline_all_tags",hash:t.declineAllHash},{onDone:function(){t.onSubmitAll(_,Object(O.d)("photo_tags_declined_text",_))},onFail:function(_){return Object(a.d)(Object(O.d)("global_error"),_||Object(O.d)("global_unknown_error")),!0},showProgress:function(){return Object(r.o)(e)},hideProgress:function(){return Object(r.w)(e)}})}(e)}),Object(O.d)("global_cancel"))}},this.block=_,this.isFullPage=e.isFullPage,this.fullCardsNumber=e.fullCardsNumber,this.nextOffset=e.nextOffset,this.confirmAllHash=e.confirmAllHash,this.declineAllHash=e.declineAllHash,this.submitAllLimit=e.submitAllLimit;var o=this.block.querySelector(".PhotoTagBlock__cards");if(!o)throw new Error("PhotoTagBlock: incorrect data");this.cardsBlock=o,this.loadMoreBtn=this.block.querySelector(".PhotoTagBlock__loadMoreBtn"),this.confirmAllBtn=document.querySelector(".PhotoTagBlock__confirmAll"),this.declineAllBtn=document.querySelector(".PhotoTagBlock__declineAll"),this.cards=this.createCards(this.getAllTagElements(this.cardsBlock)),this.initListeners()}return _.prototype.initListeners=function(){var _,e,t;null===(_=this.confirmAllBtn)||void 0===_||_.addEventListener("click",this.onConfirmAll),null===(e=this.declineAllBtn)||void 0===e||e.addEventListener("click",this.onDeclineAll),null===(t=this.loadMoreBtn)||void 0===t||t.addEventListener("click",this.loadMore),document.addEventListener(E.a.CONFIRM_SUGGESTED_TAGS,this.handleOutsideConfirmationSuggestedTags),document.addEventListener(E.a.DECLINE_SUGGESTED_TAGS,this.handleOutsideDeclinationSuggestedTags),document.addEventListener(E.a.CONFIRM_USER_TAG,this.handleOutsideConfirmationUserTag),document.addEventListener(E.a.DECLINE_USER_TAG,this.handleOutsideDeclinationUserTag),document.addEventListener(E.a.DELETE_TAG,this.handleOutsideDeletingTags),this.nextOffset&&this.isFullPage&&window.addEventListener("scroll",this.checkScroll)},_.prototype.deInitListeners=function(){var _,e,t;null===(_=this.confirmAllBtn)||void 0===_||_.removeEventListener("click",this.onConfirmAll),null===(e=this.declineAllBtn)||void 0===e||e.removeEventListener("click",this.onDeclineAll),null===(t=this.loadMoreBtn)||void 0===t||t.removeEventListener("click",this.loadMore),document.removeEventListener(E.a.CONFIRM_SUGGESTED_TAGS,this.handleOutsideConfirmationSuggestedTags),document.removeEventListener(E.a.DECLINE_SUGGESTED_TAGS,this.handleOutsideDeclinationSuggestedTags),document.removeEventListener(E.a.CONFIRM_USER_TAG,this.handleOutsideConfirmationUserTag),document.removeEventListener(E.a.DECLINE_USER_TAG,this.handleOutsideDeclinationUserTag),document.removeEventListener(E.a.DELETE_TAG,this.handleOutsideDeletingTags),this.isFullPage&&this.nextOffset&&document.removeEventListener("scroll",this.checkScroll)},_.prototype.onSubmitAll=function(_,e){var t=Object(M.b)();t&&t.hide(),Object(D.a)(_);var o="";o=!this.submitAllLimit||this.fullCardsNumber<=this.submitAllLimit?"/albums"+window.vk.id:"/albums"+window.vk.id+"?act=recognition_tags",this.go(o,e)},_.prototype.go=function(_,e){void 0===e&&(e="");var t=document.querySelector("#box_layer_wrap"),o=document.querySelector("#box_loader");window.nav.go(_,!1,{onDone:function(){e&&Object(M.f)(e)},showProgress:function(){Object(i.xb)(t),Object(i.xb)(o),Object(M.a)(o)},hideProgress:function(){Object(i.bb)(t),Object(i.bb)(o)}})},_.prototype.getActiveCardsNumber=function(){var _=this.cards.filter((function(_){return _.isActive()})).length,e=this.cards.length-_;return this.fullCardsNumber-e},_.prototype.destroy=function(){this.isDestroyed=!0,this.deInitListeners(),this.cards.forEach((function(_){return _.destroy()}))},_.prototype.createCards=function(_){return _.map((function(_){return u.isPhotoSuggestedTagCard(_)?new m(_):new w(_)}))},_}(),f={LOAD_TYPE_PHOTOS:"photos",LOAD_TYPE_ALBUMS:"albums",LOAD_TYPE_TAGGED:"tagged",MAX_DESC_INPUT_HEIGHT:600,changeAlbumPhoto(_){showBox("al_photos.php",{act:"change_thumb_box",album:_})},onMouseOverEditRow(_){var e=Object(i.L)("photos_photo_edit_row_desc_placeholder",_),t=Object(i.L)("photos_photo_edit_row_desc_input",_);Object(i.wb)(e,!1,Object(i.Cb)(t))},editInitSorter(){var _=Object(i.J)("photos_container_photos");cur.photosEditSorter=new GridSorter(_,"photos_photo_edit_row_thumb",{onReorder:f.reorderPhotos})},updateEditHeaderPos(){void 0===cur.photosEditHeaderEl&&(cur.photosEditHeaderEl=Object(i.L)("photos_edit_selection_header")),cur.photosEditHeaderEl&&(cur.photosEditHeaderElOffset=cur.photosEditHeaderElOffset||Object(i.V)(cur.photosEditHeaderEl)[1]-Object(i.S)(Object(i.J)("page_header_cont"))[1],scrollGetY()>=cur.photosEditHeaderElOffset?Object(i.ab)(cur.photosEditHeaderEl,"photos_header_fixed")||(Object(i.c)(cur.photosEditHeaderEl,"photos_header_fixed"),Object(i.vb)(cur.photosEditHeaderEl,{width:Object(i.S)(Object(i.J)("page_body"))[0]}),Object(i.vb)(Object(i.B)(cur.photosEditHeaderEl),{"margin-top":Object(i.S)(cur.photosEditHeaderEl)[1]+"px"})):(Object(i.mb)(cur.photosEditHeaderEl,"photos_header_fixed"),Object(i.vb)(cur.photosEditHeaderEl,{width:""}),Object(i.vb)(Object(i.B)(cur.photosEditHeaderEl),{"margin-top":0})))},_editGetSelectedCount(){var _=Object(i.K)("photos_edit_selected").length;if(cur.photoEditSelectedAll){var e=Object(i.K)("photos_photo_edit_row").length;_=_<e?cur.count-e+_:cur.count}return _},editSelectAll(_){cur.photoEditSelectedAll=!_,each(Object(i.K)("photos_photo_edit_row"),(function(){Object(i.zb)(this,"photos_edit_selected",cur.photoEditSelectedAll)})),f._editUpdateSelectedCounter()},_editUpdateSelectedCounter(){var _,e=f._editGetSelectedCount();_=e?Object(O.d)("photos_edit_selected_count").replace("{total}",cur.count).replace("{count}",e):langNumeric(cur.count,cur.lang.photos_edit_selected_count_initial,!0),Object(i.Cb)(Object(i.J)("photos_edit_selected_label"),_);var t=Object(i.J)("photos_edit_selected_actions");Object(i.zb)(t,"photos_selected",!!e),Object(i.K)("photos_edit_selected_action",t).forEach((function(_){Object(i.zb)(_,"link_lock",!e)}));var o=Object(i.J)("photos_select_all_toggle");cur.photosEditSelectedHalf=e>=cur.count/2,cur.photosEditSelectedHalf?Object(i.Cb)(o,Object(O.d)("photos_edit_deselect_all")):Object(i.Cb)(o,Object(O.d)("photos_edit_select_all"))},selectEditPhoto(_,e){var t=Object(i.Y)("photos_photo_edit_row",e),o=Object(i.zb)(t,"photos_edit_selected");if(_.shiftKey&&cur.photoEditPrevSelectedRowEl&&cur.photoEditPrevSelectedRowEl!=t)for(var r=Object(i.Y)("photos_edit_photos_container",e),a=Object(i.x)(r),l=0;l<2&&a;)a!=cur.photoEditPrevSelectedRowEl&&a!=t||l++,l&&Object(i.zb)(a,"photos_edit_selected",o),a=Object(i.B)(a);return cur.photoEditPrevSelectedRowEl=t,f._editUpdateSelectedCounter(),cancelEvent(_),!1},startEditPhotoDescription(_,e){f.stopEditPhotoDescription();var t=Object(i.Y)("photos_edit_photos_container",e),o=Object(i.ab)(e,"photos_photo_edit_row")?e:Object(i.Y)("photos_photo_edit_row",e),r=Object(i.L)("photos_photo_edit_row_desc_cont",o),a=Object(i.L)("photos_photo_edit_row_desc_placeholder",o),l=Object(i.L)("photos_photo_edit_row_desc_input",o);function s(_,e,t,o){var r=clean(Object(i.Cb)(t)).split("\n").join("<br>")+"&nbsp;",a=Object(i.g)("div",{innerHTML:r,className:"photos_photo_edit_row_desc_input"},{width:Object(i.S)(e)[0],display:"block",visibility:"hidden"});_.appendChild(a);var l=Object(i.S)(a)[1]+(browser.msie?10:0);Object(i.vb)(t,{height:Math.min(f.MAX_DESC_INPUT_HEIGHT,Math.round(l))}),Object(i.kb)(a)}Object(i.Cb)(l,l.getAttribute("data-orig-desc")),s(r,a,l),Object(i.xb)(l),addEvent(document,"click",f.stopEditPhotoDescription),removeEvent(l,"input"),addEvent(l,"input",s.pbind(r,a,l)),l.select(),Object(i.c)(t,"photos_desc_editing"),Object(i.c)(o,"photos_row_desc_editing"),_&&cancelEvent(_)},onEditPhotoDescriptionKeyPress(_){switch(_.keyCode){case 27:f.stopEditPhotoDescription(null,!0);break;case 9:f.stopEditPhotoDescription(null,!1);var e=Object(i.Y)("photos_photo_edit_row",_.currentTarget);(e=Object(i.B)(e))&&f.startEditPhotoDescription(null,e),cancelEvent(_)}},stopEditPhotoDescription(_,e){var t;_&&Object(i.ab)(_.target,"photos_photo_edit_row_desc_input")||(removeEvent(document,"click",f.stopEditPhotoDescription),each(Object(i.K)("photos_row_desc_editing"),(function(){t=this,Object(i.mb)(t,"photos_row_desc_editing");var _=Object(i.L)("photos_photo_edit_row_desc_placeholder",t),o=Object(i.L)("photos_photo_edit_row_desc_input",t),r=t.getAttribute("data-id"),a=t.getAttribute("data-edit-hash"),l="";e?l=o.getAttribute("data-orig-desc"):((l=trim(Object(i.Cb)(o)))!=o.getAttribute("data-orig-desc")&&ajax.post("al_photos.php",{act:"save_desc",photo:r,hash:a,text:l,edit:1},{}),o.setAttribute("data-orig-desc",l),_.titleSet=!1);Object(i.Cb)(_,clean(l)||Object(O.d)("photos_add_description_placeholder")),Object(i.zb)(_,"photos_edit_has_desc",!!l),Object(i.bb)(o)})),Object(i.mb)(Object(i.Y)("photos_edit_photos_container",t),"photos_desc_editing"))},updatePeriods(){cur.periods=Object(i.K)("photos_period_delimiter",Object(i.J)("photos_all_block"))},destroyPeriod(){cur.fixedPeriod&&(Object(i.kb)(cur.fixedPeriod),cur.fixedPeriod=!1,cur.fixedPeriodEl=!1)},fixPeriod(){if(Object(i.J)("photos_albums_block")&&(f.headerHeight=f.headerHeight||Object(i.S)(Object(i.J)("page_header_cont"))[1],cur.periods&&cur.periods.length)){var _=vk.staticheader?Math.max(scrollGetY(),f.headerHeight):scrollGetY()+f.headerHeight,e=!1,t=!1,o=Object(i.S)(cur.periods[0])[1];for(var r in cur.periods)if(cur.periods.hasOwnProperty(r)){if(Object(i.V)(cur.periods[r])[1]>=_)break;e=cur.periods[r];var a=intval(r)+1;t=!!cur.periods[a]&&Object(i.V)(cur.periods[a])[1]-_}if(e&&!cur.fileApiUploadStarted){if(e==cur.fixedPeriodEl)setTimeout((function(){Object(i.vb)(cur.fixedPeriod,{left:Object(i.V)(e)[0]+"px"})}));else{if(cur.fixedPeriod)cur.fixedPeriod.innerHTML=e.innerHTML;else{var l=cur.fixedPeriod=Object(i.g)("div",{innerHTML:e.innerHTML,className:"photos_period_delimiter_fixed"},{left:Object(i.V)(e)[0]+"px"});Object(i.J)("page_body").appendChild(cur.fixedPeriod),(cur._back?cur._back.hide:cur.destroy).push((function(){Object(i.kb)(l)}))}cur.fixedPeriodEl=e}var s=!1!==t?t-o:0;s>=0&&(s=0),cur.fixedPeriodTop!==s&&(Object(i.vb)(cur.fixedPeriod,{top:s+"px"}),cur.fixedPeriodTop=s)}else!e&&cur.fixedPeriod&&(Object(i.kb)(cur.fixedPeriod),cur.fixedPeriod=!1,cur.fixedPeriodEl=!1)}},scrollResize(){if(!browser.mobile&&!cur.pvShown){var _=document.documentElement,e=window.innerHeight||_.clientHeight||bodyNode.clientHeight,t=scrollGetY(),o=Object(i.J)("ui_photos_load_more"),r=Object(i.J)("ui_albums_load_more"),a=Object(i.J)("ui_tagged_load_more"),l=.8*e;Object(i.fb)(o)&&o.offsetTop-(t+e)<l&&f.load(),Object(i.fb)(r)&&cur.showAllAlbums&&r.offsetTop-(t+e)<l&&f.load(f.LOAD_TYPE_ALBUMS),Object(i.fb)(a)&&cur.showAllTagged&&a.offsetTop-(t+e)<l&&f.load(f.LOAD_TYPE_TAGGED),cur.fixPeriods&&f.fixPeriod(),f.updateEditHeaderPos()}},initScroll(){cur.module="photos",f.scrollnode=browser.msie6?pageNode:window,addEvent(f.scrollnode,"scroll",f.scrollResize),addEvent(window,"resize",f.scrollResize),removeEvent(window,"load",f.initScroll),cur.destroy.push((function(){removeEvent(f.scrollnode,"scroll",f.scrollResize),removeEvent(window,"resize",f.scrollResize)}))},recache(_,e){if(cur.loading)return cur.loading=1,void setTimeout(f.recache.pbind(_,e),100);for(var t=cur.offset;ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+t+"&part=1"];t+=20){var o=ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+t+"&part=1"];o[0]+=e,ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+(t+e)+"&part=1"]=o,delete ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+t+"&part=1"]}cur.offset+=e},loaded(_,e,t,o){var r,a,l,s,n,c;switch(o||(cur.loading=0),o=o||f.LOAD_TYPE_PHOTOS){case f.LOAD_TYPE_TAGGED:cur.taggedOffset=_,l=cur.moreFromTagged,n=cur.moreTaggedOpts,s=cur.taggedOffset;break;case f.LOAD_TYPE_ALBUMS:cur.albumsOffset=_,l=cur.moreFromAlbums,n=cur.moreAlbumsOpts,s=cur.albumsOffset,c=cur.albumsCount;break;default:cur.offset=_,l=cur.moreFrom,n=cur.moreOpts,s=cur.offset,c=cur.count}r=Object(i.J)("photos_container_"+o),a=Object(i.J)("ui_"+o+"_load_more");for(var d=Object(i.g)("div",{innerHTML:trim(e)});d.firstChild;){if(Object(i.ab)(d.firstChild,"photos_period_delimiter")){var b=d.firstChild.getAttribute("data-year");if(Object(i.L)("photos_period_delimiter_"+b)){Object(i.kb)(d.firstChild);continue}}cur.photoEditSelectedAll&&Object(i.c)(d.firstChild,"photos_edit_selected"),r.appendChild(d.firstChild)}t&&extend(cur.privacy,t),o==f.LOAD_TYPE_PHOTOS&&f.updatePeriods(),_>=c||!e?Object(i.bb)(a):o!=f.LOAD_TYPE_PHOTOS&&(cur.loading=1,ajax.post(l,extend({offset:s,part:1},n||{}),{cache:1,onDone:function(){2==cur.loading?f.loaded.apply(window,arguments):cur.loading=!1},onFail:function(){return cur.loading=0,!0}}))},load(_){var e,t,o,a;switch(_=_||f.LOAD_TYPE_PHOTOS){case f.LOAD_TYPE_PHOTOS:e=Object(i.J)("ui_photos_load_more"),t=cur.moreFrom,o=cur.moreOpts,a=cur.offset;break;case f.LOAD_TYPE_TAGGED:e=Object(i.J)("ui_tagged_load_more"),t=cur.moreFromTagged,o=cur.moreTaggedOpts,a=cur.taggedOffset;break;case f.LOAD_TYPE_ALBUMS:e=Object(i.J)("ui_albums_load_more"),t=cur.moreFromAlbums,o=cur.moreAlbumsOpts,a=cur.albumsOffset}t&&Object(i.fb)(e)&&!Object(r.k)(e)&&(cur.loading?cur.loading=2:(_==f.LOAD_TYPE_PHOTOS&&o&&(cur.loading=1),ajax.post(t,extend({offset:a,part:1},o||{}),{onDone:f.loaded,onFail:function(){return cur.loading=0,!0},showProgress:function(){Object(r.o)(e)},hideProgress:function(){Object(r.w)(e)},cache:1})))},loadMoreButtonClick(_){switch(_){case f.LOAD_TYPE_ALBUMS:cur.showAllAlbums=!0;break;case f.LOAD_TYPE_TAGGED:cur.showAllTagged=!0}this.load(_)},reorderAlbums(_,e,t){var o=_.id.replace("album",""),i=(e&&e.id||"").replace("album",""),r=(t&&t.id||"").replace("album","");ajax.post("al_photos.php",{act:"reorder_albums",album:o,before:i,after:r,hash:cur.reorderHash})},reorderPhotos(_,e,t){var o="edit"==nav.objLoc.act?"photo_edit_row_":"photo_row_",r=_.id.replace(o,""),a=(e&&e.id||"").replace(o,""),l=(t&&t.id||"").replace(o,""),s=Object(i.v)(Object(i.J)("photos_container_photos"),"rev");s=s?"1"===s?1:"":nav.objLoc.rev,ajax.post("al_photos.php",{act:"reorder_photos",photo:r,before:a,after:l,rev:s,hash:cur.reorderHash})},privacy(_){if("photos_move"==_){var e=Privacy.getValue(_);return(e=(e=e.split("_"))[2])!=cur.album.split("_")[1]&&f.movePhoto(e),!0}var t=_.match(/^album(\d+)/);if(t){var o=Object(i.J)("album"+vk.id+"_"+t[1]);if(o){if(o.helper){var r=Object(i.S)(o);if(r[0]!=o.w||r[1]!=o.h){Object(i.vb)(o.helper,{width:r[0],height:r[1]-Object(i.J)("photos_container").sorter.dh}),extend(o,{x:o.x-o.w/2+r[0]/2,w:r[0],y:o.y-o.h/2+r[1]/2,h:r[1]});for(var a=o.nextSibling;a&&a.nextSibling;a=a.nextSibling.nextSibling)Object(i.vb)(a.nextSibling,{left:a.offsetLeft,top:a.offsetTop})}}clearTimeout(cur["privacy_timer_"+_]),cur["privacy_timer_"+_]=setTimeout(ajax.post.pbind("al_friends.php",{act:"save_privacy",key:_,val:Privacy.getValue(_),hash:cur.privacyHash}),500)}}},deleteAlbum(_,e){Object(a.d)({title:Object(O.d)("photos_deleting_album"),dark:1,bodyStyle:"padding: 20px;"},Object(O.d)("photos_sure_del_album"),Object(O.d)("global_delete"),(function(t){ajax.post("al_photos.php",{act:"delete_album",album:_,hash:e},{showProgress:r.o.pbind(t),hideProgress:r.w.pbind(t)})}),Object(O.d)("global_cancel"))},showSaved(_,e){var t=Object(i.J)(_),o=function(){setTimeout(animate.pbind(t,{backgroundColor:e,borderLeftColor:"#D8DFEA",borderRightColor:"#D8DFEA",borderTopColor:"#D8DFEA",borderBottomColor:"#D8DFEA"},1e3),1e3)};Object(i.fb)(t)?animate(t,{backgroundColor:"#E7F1F9",borderLeftColor:"#4C96D4",borderRightColor:"#4C96D4",borderTopColor:"#4C96D4",borderBottomColor:"#4C96D4"},200,o):(Object(i.xb)(t),o())},saveAlbum(_){var e={act:"save_album",album:cur.album,hash:cur.albumhash,title:Object(i.J)("album_title").value,desc:Object(i.J)("album_description").value,enable_hintach:isChecked("hintach_enabled_for_album")};if(!e.title)return Object(r.q)("album_title");var t=cur.album.replace(vk.id+"_","");cur.privacy["album"+t]?extend(e,{view:Privacy.getValue("album"+t),comm:Privacy.getValue("albumcomm"+t)}):Object(i.J)("album_only_check")&&extend(e,{main:isChecked("album_main_check"),only:isChecked("album_only_check"),comm:isChecked("album_comments_check")}),ajax.post("al_photos.php",e,{onDone:function(){var _=Object(i.J)("album_main_check");_&&isChecked(_)&&(Object(i.c)(_,"on"),Object(i.c)(_,"disabled"),Object(i.bb)("album_delete_action"));var e=Object(i.J)("photos_changes_saved");Object(i.vb)(e,{opacity:1}),setTimeout((function(){Object(i.vb)(e,{opacity:0})}),1500)},showProgress:r.o.pbind(_),hideProgress:r.w.pbind(_)})},savePhotos(){for(var _={act:"save_photos",album:cur.album,hash:cur.albumhash},e=Object(i.J)("photos_container"),t=0,o=e.firstChild;o;o=o.nextSibling)if(o.firstChild&&Object(i.fb)(o.firstChild)){var r=o.id.replace("photo_edit_row","");_["photo_id"+t]=r,_["photo_desc"+t]=Object(i.J)("photo_caption"+r).value,++t}ajax.post("al_photos.php",_,{onDone:function(){for(var _=e.firstChild;_;_=_.nextSibling)if(_.firstChild&&Object(i.fb)(_.firstChild)){var t=_.id.replace("photo_edit_row","");Object(i.J)("photo_save_result"+t).innerHTML=Object(O.d)("photos_privacy_description")}cur.descs=!1,scrollToTop(200),f.showSaved("photos_saved_msg","#F3F8FC"),Object(i.J)("photos_container").sorter&&sorter.update(Object(i.J)("photos_container").sorter.elems[0])},progress:"photos_save_progress"})},deleteSelectedPhotos(_){var e=[];each(Object(i.K)("photos_edit_selected"),(function(){e.push(this.getAttribute("data-id"))}));var t=intval(f._editGetSelectedCount()>e.length),o=cur.album.split("_");showBox("/al_photos.php",{act:"delete_selected_box",Photo_ids:t?"":e.join(","),owner_id:o[0],album_id:o[1],all:t},{onDone(){var e=curBox();e.removeButtons(),e.addButton(Object(O.d)("photos_del_selected_box_yes"),e=>{Object(i.xb)("photos_del_box_progress"),Object(i.bb)("photos_del_box_text"),Object(i.kb)(e);var t=Object(i.J)("photos_del_box_progress_text");f.doEditBatchProcess({act:"delete_photos",hash:_,owner_id:o[0],album_id:o[1]},cur.editDeletePhotosArray,Object(i.J)("photos_del_box_progress_wrap"),"photos_del_selected_title_progress",(function(_,e,o,r,a){Object(i.Cb)(t,Object(O.d)("photos_del_selected_box_text_progress").replace("{count}",r).replace("{total}",a)),cur.count=Math.max(cur.count-_,0),each(o,(function(_,e){Object(i.kb)("photo_edit_row_"+e),cur.count=Math.max(cur.count,0)})),f._editUpdateSelectedCounter()}),(function(){var _=curBox();(_&&_.hide(),0==cur.count)?nav.reload():Object(i.K)("photos_photo_edit_row").length<40&&f.load()}))}),e.addButton(Object(O.d)("box_cancel"),(function(){e.hide(),cur.editDeletePhotosArray=!1}),"no")}})},doEditBatchProcess(_,e,t,o,r,a){var l=e.split(","),s=l.length,n=cur.editPhotosMaxChunkSize||50,c=Math.ceil(s/n),d=Object(i.L)("photos_progress_bar",Object(i.J)(t))||Object(i.L)("ui_progress_bar",Object(i.J)(t)),b=0,p=document.title,u=curBox();r(0,!1,[],0,s),function e(t){if(!u.isVisible())return a(b),void Object(i.tb)(p);var E=l.slice(t*n,(t+1)*n);ajax.post("/al_photos.php",extend({photos:E.join(",")},_),{onDone:function(_,l,n){b+=_,t++,Object(i.vb)(d,{width:100*t/c+"%"});var u=Object(O.d)(o).replace("{count}",b).replace("{total}",s);Object(i.tb)(u),r(_,l,E,b,s,n),t<c?e(t):setTimeout((function(){Object(i.tb)(p),a(b,l)}),200)}})}(0)},_showProgressPanel(_){var e=Object(i.rb)('<div class="photo_mask_progress _photo_mask_progress"><div class="round_spinner"></div></div>');return _.appendChild(e),e},_hideProgressPanel(_){Object(i.kb)(Object(i.L)("_photo_mask_progress",_))},deletePhoto(_,e,t,o){var r;if(""===_&&t&&(r=Object(i.Y)("photos_photo_edit_row",t),_=Object(i.e)(r,"data-id"),e=Object(i.e)(r,"data-edit-hash")),r=r||Object(i.J)("photo_edit_row_"+_)){var a=f._showProgressPanel(r);return Object(i.c)(r,"photos_deleted"),ajax.post("al_photos.php",{act:"delete_photo",photo:_,hash:e,edit:1},{onDone:function(_){Object(i.kb)(a),r.appendChild(Object(i.rb)(_)),f.recache(cur.offset,-1),cur.count-=1,f._editUpdateSelectedCounter(),cur.count<2&&Object(i.bb)("album_thumb_action"),Object(i.J)("photos_go_to_album_cont")&&!cur.count&&Object(i.bb)("photos_go_to_album_cont"),cur.photoAddUpdate&&cur.photoAddUpdate(r),cur.introTooltipHide&&cur.introTooltipHide(!0)}}),cancelEvent(o)}},restorePhoto(_,e,t){var o=Object(i.J)("photo_edit_row_"+e);if(o&&Object(i.ab)(o,"photos_deleted")){var r=f._showProgressPanel(o);Object(i.kb)(Object(i.L)("photos_restore",o)),ajax.post("al_photos.php",{act:"restore_photo",photo:e,hash:t,edit:1},{onDone:function(){Object(i.kb)(r),Object(i.mb)(o,"photos_deleted"),f.recache(cur.offset,1),cur.count+=1,f._editUpdateSelectedCounter(),cur.count>1&&Object(i.xb)("album_thumb_action"),Object(i.J)("photos_go_to_album_cont")&&cur.count&&Object(i.xb)("photos_go_to_album_cont"),cur.photoAddUpdate&&cur.photoAddUpdate(o)},progress:"photo_restore_progress"+e})}},toggleMoveToAlbumMode(_,e){var t=Object(i.J)("photos_move_box_search"),o=Object(i.J)("pv_move_to_album_cont"),r=Object(i.J)("photos_box_edit_data"),a=curBox(),l=Object(i.L)("box_title",a.titleWrap);if(_){Object(i.bb)(t),Object(i.bb)(o),Object(i.xb)(r),a.setOptions({width:500});var s=Object(O.d)("photos_move_to_new_album_title");cur.noAlbums||(s+=`\n          <span class="divider">|</span>\n          <a onclick="return photos.toggleMoveToAlbumMode(false, event)" href="" class="toggle">\n            ${Object(O.d)("photos_move_to_another_album_toggle")}\n          </a>\n        `),Object(i.Cb)(l,s),a.removeButtons().addButton(Object(O.d)("photos_create_album_and_move"),cur.saveNewAlbum).addButton(Object(O.d)("global_cancel"),a.hide,"no"),cur.onNewAlbumDone=function(_){curBox().hide(),f.movePhotosBox(cur.editPhotosArray.split(","),!1,(function(){setTimeout((function(){var e=Object(i.J)("album"+_);f.doMovePhotos(!1,e)}))}))}}else Object(i.xb)(t),Object(i.xb)(o),Object(i.bb)(r),a.setOptions({width:795}),Object(i.Cb)(l,Object(O.d)("photos_move_box_title")+'<span class="divider">|</span><a onclick="return photos.toggleMoveToAlbumMode(true, event)" href="" class="toggle">'+Object(O.d)("photos_move_to_new_album")+"</a>"),a.removeButtons().addButton(Object(O.d)("global_cancel"),a.hide);return cancelEvent(e)},showMove(_,e,t){var o=cur.moveddc,r=Object(i.J)("photos_move_link"+_);cur.privacyPhotoMove?Privacy.show(r,t,"photos_move"):(cur.zIndexUpdated&&(f.hideMove(),cur.noZIndexUpdate=!0),Object(i.J)("photo_edit_row"+_)&&(cur.zIndexUpdated=_,Object(i.vb)(Object(i.J)("photo_edit_row"+_),{zIndex:150})),f.hideMove()),extend(cur,{movelnk:r,moveph:_,movehash:e}),cur.privacyPhotoMove||(r.parentNode.replaceChild(o,r),cur.movedd.focus(),cur.movedd.showDefaultList(),addEvent(document,"click",f.hideMove))},hideMove(){if(cur.noZIndexUpdate)delete cur.noZIndexUpdate;else if(!cur.privacyPhotoMove){if(cur.movelnk)try{cur.moveddc.parentNode.replaceChild(cur.movelnk,cur.moveddc),cur.movelnk=!1,cur.movedd.clear(),cur.zIndexUpdated&&Object(i.J)("photo_edit_row"+cur.zIndexUpdated)&&(Object(i.vb)(Object(i.J)("photo_edit_row"+cur.zIndexUpdated),{zIndex:100}),delete cur.zIndexUpdated)}catch(_){}removeEvent(document,"click",f.hideMove)}},movePhoto(_,e,t){_=intval(_);var o=i.xb.pbind("photo_return_progress"+e),r=i.bb.pbind("photo_return_progress"+e);if(!e){if(!_||_==cur.album.split("_")[1])return f.hideMove();e=cur.moveph,t=cur.movehash,o=function(){Object(i.bb)("photo_delete_link"+e),Object(i.xb)("photo_edit_progress"+e)},r=function(){Object(i.bb)("photo_edit_progress"+e),Object(i.xb)("photo_delete_link"+e)}}ajax.post("al_photos.php",{act:"move_photo",album:_,photo:e,hash:t},{onDone:function(t){var o=Object(i.J)("photo_edit_row"+e);if(o&&o.firstChild){if(_==cur.album.split("_")[1]){if(Object(i.fb)(o.firstChild))return;o.removeChild(o.firstChild.nextSibling),Object(i.xb)(o.firstChild),f.recache(cur.offset,1),++cur.count,cur.count>1&&Object(i.xb)("album_thumb_action")}else{if(!Object(i.fb)(o.firstChild))return;f.hideMove(),Object(i.bb)(o.firstChild),o.appendChild(Object(i.g)("div",{innerHTML:t})),f.recache(cur.offset,-1),--cur.count,cur.count<2&&Object(i.bb)("album_thumb_action")}cur.photoAddUpdate&&cur.photoAddUpdate(o),cur.introTooltipHide&&cur.introTooltipHide(!0),Object(i.J)("photos_go_to_album_cont")&&Object(i.yb)("photos_go_to_album_cont",!!cur.count)}},onFail:function(_){if(f.hideMove(),_)return setTimeout(Object(a.d)({title:Object(O.d)("global_error"),dark:1,bodyStyle:"padding: 20px;"},_).hide,2e3),!0},showProgress:o,hideProgress:r})},updateThumbs(_,e){var t=Object(i.J)("photos_add_img"+cur.peEditPhoto);t&&(t.src=_)},editPhoto(_,e,t){cur.peEditPhoto=_,showBox("al_photos.php",{act:"edit_photo",photo:_,webgl:1,stat:["ui_controls.css","ui_controls.js"]},{dark:1})},backupDesc(_){cur.descs||(cur.descs={}),cur.descs[_]=trim(Object(i.J)("photo_caption"+_).value)},saveDesc(_,e){var t=Object(i.J)("photo_caption"+_).value,o=cur.descs[_];delete cur.descs[_],trim(t)!=o&&ajax.post("al_photos.php",{act:"save_desc",photo:_,hash:e,text:t,edit:1},{onDone:function(e){Object(i.J)("photo_save_result"+_).innerHTML=e},onFail:function(e){return Object(i.J)("photo_save_result"+_).innerHTML='<div class="photo_save_error">'+e+"</div>",!0},showProgress:function(){Object(i.J)("photo_save_result"+_).innerHTML=Object(O.d)("photos_privacy_description"),Object(i.xb)("photo_save_progress"+_)},hideProgress:function(){Object(i.bb)("photo_save_progress"+_)}})},genFile:(_,e,t)=>Object(i.g)("div",{innerHTML:`\n        <a class="photo_file_cancel" id="photo_cancel${_}" onclick="${e}">${t}</a>\n        <div class="photo_file_button">\n          <div class="file_button_gray">\n            <div class="file_button" id="photo_file_button${_}">${Object(O.d)("photos_choose_file")}</div>\n          </div>\n        </div>\n      `}),initFile(_){FileButton.init("photo_file_button"+_,{name:"photo",id:"photo_file"+_,accept:"image/jpeg,image/png,image/gif",onchange:f.fileSelected})},addFile(){var _=cur.files.length,e=f.genFile(_,"photos.fileCancel("+_+")",Object(O.d)("global_cancel"));extend(e,{className:"photo_upload_file",id:"photo_upload_row"+_}),Object(i.J)("photo_upload_files").appendChild(e),f.initFile(_),cur.files.push({})},filesLoad(){for(var _=0,e=0;_<cur.files.length;++_){if(Object(i.J)("photo_file"+_).value)break}if(_!=cur.files.length){cur.allcont=utilsNode.appendChild(Object(i.g)("div",{innerHTML:`\n        <iframe name="photo_frame_all"></iframe>\n        <form target="photo_frame_all" id="photo_form_all" method="POST" action="${cur.url}" enctype="multipart/form-data"></form>\n      `}));var t=Object(i.J)("photo_form_all"),o=extend(cur.fields,{act:"do_add",al:1,from_host:locHost,ondone:"photos.filesDone",onfail:"photos.filesFail"});for(e in o)o.hasOwnProperty(e)&&t.appendChild(Object(i.g)("input",{name:e,value:o[e]}));for(_=0,e=0;_<cur.files.length;++_){var r=Object(i.J)("photo_file"+_);r.value&&(r.name="file"+e,t.appendChild(r),++e)}t.submit()}},fileSelected(){var _=intval(this.id.replace("photo_file",""));if(cur.files[_].deleting||!cur.files[_].cont&&!cur.files[_].id){cur["fileDone"+_]=f.fileDone.pbind(_),cur["fileFail"+_]=f.fileFail.pbind(_),cur.files[_].cont=utilsNode.appendChild(Object(i.g)("div",{innerHTML:`\n        <iframe name="photo_frame${_}"></iframe>\n        <form target="photo_frame${_}" id="photo_form${_}" method="POST" action="${cur.url}" enctype="multipart/form-data"></form>\n      `}));var e=Object(i.J)("photo_form"+_),t=extend(cur.fields,{act:"do_add",al:1,from_host:locHost,ondone:"cur.fileDone"+_,onfail:"cur.fileFail"+_});for(var o in t)t.hasOwnProperty(o)&&e.appendChild(Object(i.g)("input",{name:o,value:t[o]}));e.appendChild(this),e.submit();var a=Object(i.J)("photo_file_button"+_);Object(r.o)(a),setTimeout((function(){a.innerHTML=a.innerHTML}),0),Object(i.xb)("photo_cancel"+_),Object(i.J)("photo_cancel"+_).innerHTML=Object(O.d)("global_cancel"),_==cur.files.length-1&&f.addFile()}},fileDone(_,e){Object(i.bb)("photo_cancel"+_);for(var t="",o=_+1;o<cur.files.length;++o)if(cur.files[o].id&&!cur.files[o].deleting){t=cur.files[o].id;break}setTimeout(ajax.post.pbind("al_photos.php",extend({act:"done_add",before:t,context:1},AjaxConvert.fromQueryString(e)),{onDone:function(e,t){if(!e)return f.fileFail(_,0);cur.files[_].cont.innerHTML="",utilsNode.removeChild(cur.files[_].cont),extend(cur.files[_],{id:e,deleting:!1,cont:!1}),Object(i.J)("photo_upload_row"+_).innerHTML=t,autosizeSetup("photo_caption"+e,{minHeight:30}),Object(i.xb)("photo_delete"+e)},onFail:function(e){if(e)return setTimeout(Object(a.d)({title:Object(O.d)("global_error"),dark:1,bodyStyle:"padding: 20px;"},e).hide,3e3),f.fileCancel(_),!0}}),0)},fileCancel(_,e){if(cur.files[_].cont&&(cur.files[_].cont.innerHTML="",utilsNode.removeChild(cur.files[_].cont)),!e){var t=Object(i.J)("photo_file_button"+_);Object(r.w)(t),t.innerHTML=Object(O.d)("photos_choose_file"),cur.files[_]={},f.initFile(_),Object(i.bb)("photo_cancel"+_)}},fileFail(_,e){f.fileCancel(_)},fileDelete(_,e){for(var t=0;t<cur.files.length&&cur.files[t].id!=_;)++t;if(t!=cur.files.length&&!cur.files[t].deleting){cur.files[t].deleting=!0,ajax.post("al_photos.php",{act:"delete_photo",photo:_,hash:e,edit:2},{onFail:function(){cur.files[t].deleting=!1}});var o=Object(i.J)("photo_edit_row"+_);o.parentNode.insertBefore(f.genFile(t,"photos.fileRestore('"+_+"', '"+e+"')",Object(O.d)("global_restore")),o),Object(i.bb)(o),f.initFile(t),Object(i.xb)("photo_cancel"+t)}},fileRestore(_,e){for(var t=0,o="";t<cur.files.length&&cur.files[t].id!=_;)++t;if(t!=cur.files.length&&cur.files[t].deleting&&-1!==cur.files[t].deleting){if(cur.files[t].cont)return f.fileCancel(t);for(var r=t+1;r<cur.files.length;++r)if(cur.files[r].id&&!cur.files[r].deleting){o=cur.files[r].id;break}cur.files[t].deleting=-1,ajax.post("al_photos.php",{act:"restore_photo",photo:_,hash:e,before:o,edit:2},{onDone:function(){cur.files[t].deleting=!1}});var a=Object(i.J)("photo_edit_row"+_);Object(i.xb)(a),Object(i.kb)(a.previousSibling)}},filesDone(_){setTimeout(ajax.post.pbind("al_photos.php",extend({act:"done_add",context:2},AjaxConvert.fromQueryString(_))),0)},filesFail(){for(var _=0;_<cur.files.length;++_)f.fileCancel(_);cur.allcont.innerHTML="",utilsNode.removeChild(cur.allcont),cur.allcont=!1},chooseFlash(){if(browser.flash<10)return animate(Object(i.J)("photo_flash_needed"),{backgroundColor:"#FFEFE8",borderBottomColor:"#E89B88",borderLeftColor:"#E89B88",borderRightColor:"#E89B88",borderTopColor:"#E89B88"},100,()=>{animate(Object(i.J)("photo_flash_needed"),{backgroundColor:"#FFFFFF",borderBottomColor:"#CCCCCC",borderLeftColor:"#CCCCCC",borderRightColor:"#CCCCCC",borderTopColor:"#CCCCCC"},500)});cur.photoCheckFails=0,Object(i.xb)("photo_flash_upload"),Object(i.bb)("photo_default_upload"),Object(i.bb)("photo_upload_unavailable")},chooseDefault(){cur.photoCheckFails=0,Object(i.xb)("photo_default_upload"),Object(i.bb)("photo_flash_upload"),cur.serverChecked?(Object(i.xb)("photo_upload_files"),Object(i.bb)("photo_default_check")):(Object(i.bb)("photo_upload_files"),Object(i.xb)("photo_default_check"),cur.checkUpload())},flashWidth:()=>-1==_ua.indexOf("Mac")||-1==_ua.indexOf("Opera")&&-1==_ua.indexOf("Firefox")?"600":"601",activeTab(_){for(var e=Object(i.C)(Object(i.C)(_)),t=Object(i.x)(e);t;t=Object(i.B)(t))Object(i.mb)(t,"active_link");Object(i.c)(Object(i.C)(_),"active_link")},checkHtml5Uploader(){var _=window.XMLHttpRequest||window.XDomainRequest,e=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;return _&&(window.FormData||window.FileReader&&(window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary||window.ArrayBuffer&&window.Uint8Array&&e))},upload:(_,e)=>e&&(2==e.button||e.ctrlKey)?(f.checkHtml5Uploader()&&(_.href+="&html5=1"),!0):!(void 0!==cur.uplId&&window.Upload&&Upload.checked&&Upload.checked[cur.uplId]&&f.checkHtml5Uploader())||(Object(i.J)("photos_upload_input").click(),!1),uploadLink:(_,e)=>(f.checkHtml5Uploader()&&(_.href+="&html5=1"),nav.go(_,e)),onUploadSelect(_){if(Object(i.J)("photos_upload_area")){window.filesToUpload=_;var e=Object(i.J)("photos_upload_area").innerHTML;Object(i.J)("photos_upload_area").innerHTML='<img src="/images/upload.gif">',nav.go(Object(i.J)("photos_upload_area").href+"&html5=1",!1,{onFail:function(_){return Object(i.J)("photos_upload_area").innerHTML=e,setTimeout(Object(a.d)({title:Object(O.d)("global_error"),dark:1,bodyStyle:"padding: 20px;"},_).hide,3e3),!0}})}},thumbOver(_,e,t){cur.hideTO&&cur.hideTO[e]&&clearTimeout(cur.hideTO[e]);var o=Object(i.L)("description",_),r=Object(i.L)("photo_album_title",_),a=Object(i.S)(o)[1];animate(r,{marginTop:163-(a?a+7:0)},{duration:200,transition:Fx.Transitions.easeOutCirc});var l=Object(i.L)("photo_album_info_back",_),s=Object(i.L)("photo_album_info_cont",_);if(l&&s)if(!l.over||t){var n=t?.6:.5,c=t?1:.8;t&&(l.over=1),animate(l,{opacity:n},{duration:200,transition:Fx.Transitions.easeOutCirc}),animate(s,{opacity:c},{duration:200,transition:Fx.Transitions.easeOutCirc})}else l.over=0},thumbOut(_,e,t){var o=Object(i.L)("photo_album_info_back",_),r=Object(i.L)("photo_album_info_cont",_),a=()=>{if(t){var e=Object(i.L)("photo_album_title",_);animate(e,{marginTop:163},200)}if(o&&r){var a=t?0:.8;animate(o,{opacity:t?0:.5},200),animate(r,{opacity:a},200)}};t?(cur.hideTO=cur.hideTO||{},cur.hideTO[e]=setTimeout(a,150)):a()},openEditor:(_,e)=>(stManager.add([jsc("web/photoview.js"),"photoview.css"],(function(){var e=Object(i.Y)("photos_photo_edit_row",_);cur.onPESave=function(_){curBox().hide(),Object(i.vb)(Object(i.L)("photos_photo_edit_row_thumb",e),"background-image","url('"+_+"')"),cur.onPESave=!1,bodyNode.style.overflow="auto"};var t=e.getAttribute("data-id");Photoview.openEditor(t,cur.savedThumbs?cur.savedThumbs[t]:e.getAttribute("data-thumb"))})),cancelEvent(e)),addToAlbum(){cur.isPhotoUpload=!0,f.movePhotosBox(cur.savedPhotos||[],!1)},movePhotosBox(_,e,t,o){var r=[],a=!1;isArray(_)?r=_:(""===_&&e&&(_=Object(i.Y)("photos_photo_edit_row",e).getAttribute("data-id")),_?r.push(_):each(Object(i.K)("photos_edit_selected"),(function(){r.push(this.getAttribute("data-id"))})),a=intval(f._editGetSelectedCount()>r.length));var l=cur.album?cur.album.split("_"):[vk.id];return showBox("/al_photos.php",{act:"a_move_to_album_box",photo_ids:a?"":r.join(","),owner_id:l[0],from_album_id:l[1],all:a},{onDone:t}),cancelEvent(o)},cancelMove(_,e,t,o,r,a,l){var s=Object(i.Y)("photos_photo_edit_row",e);Object(i.kb)(Object(i.L)("photos_cancel_move",s)),f._showProgressPanel(s),ajax.post("al_photos.php",{act:"move_photos",photos:t,to_album_id:o,from_album_id:r,hash:l,owner_id:a},{onDone:function(){f._hideProgressPanel(s),cur.count++,f._editUpdateSelectedCounter()}}),cancelEvent(_)},doMovePhotos(_,e,t){var o=Object(i.q)("_photos_album",e),r=Object(i.v)(o,"aid"),a=Object(i.v)(o,"from-aid"),l=Object(i.v)(o,"owner-id"),s=Object(i.v)(o,"move-hash"),n=Object(i.v)(o,"from"),c=Object(i.L)("photos_album_counter",e),d=Object(i.L)("photos_album_thumb",e),b=Object(i.J)("pv_move_to_album_progress");d.insertBefore(b,d.children[0]),Object(i.xb)(b),Object(i.c)(e,"photos_in_progress"),Object(i.c)(Object(i.Y)("photos_container_albums",e),"photos_inactive"),f.doEditBatchProcess({act:"move_photos",to_album_id:r,from_album_id:a,owner_id:l,hash:s,from:n},cur.editPhotosArray,Object(i.J)("pv_move_to_album_progress"),"photos_move_in_progress_title",(function(_,e,o,s,n,d){cur.count=Math.max(cur.count-_,0),Object(i.Cb)(c,+Object(i.Cb)(c)+_),each(o,(function(_,e){var o=Object(i.J)("photo_edit_row_"+e);if(!cur.isPhotoUpload)if(o&&!t){var s="return photos.cancelMove(event, this, '"+e+"', "+a+", "+r+", "+l+", '"+d+"')",n=Object(i.rb)('<div class="photos_cancel_move"><a href="" onclick="'+s+'">'+Object(O.d)("global_cancel")+"</a></div>");o.appendChild(n)}else Object(i.kb)(o);cur.count=Math.max(cur.count,0)})),f._editUpdateSelectedCounter()}),(function(_,e){var o=curBox();o&&o.hide();var r=langNumeric(_,cur.lang.photos_x_photos_moved_no_cancel);(r=r.replace("{album}",e),showDoneBox(r),cur.pvShown&&cur.pvCurPhoto&&(cur.pvCurPhoto.album=e,Object(i.L)("pv_album_name").innerHTML=e),t||cur.isPhotoUpload)&&(0==cur.count?nav.reload():Object(i.K)("photos_photo_edit_row").length<40&&f.load())})),_&&cancelEvent(_)},publishPhotos(_){if(cur.savedPhotos){cur.savingPhotos=!0;var e={act:"post",type:"photos_upload",to_id:vk.id,attach1_type:"photos_list",attach1:(cur.savedPhotos||[]).join(","),hash:cur.post_hash};ajax.post("/al_wall.php",e,{showProgress:r.o.pbind(_),onDone:function(){delete cur._back,nav.go("/al_profile.php"),showBackLink()}})}return!1},registerDragZone(_){addEvent(document,"dragenter dragover",(function(e){if(f.checkHtml5Uploader())return setTimeout((function(){clearTimeout(cur.dragTimer),delete cur.dragTimer}),0),_.on(e),cancelEvent(e)})),addEvent(document,"dragleave",(function(e){cur.dragTimer&&(clearTimeout(cur.dragTimer),delete cur.dragTimer),cur.dragTimer=setTimeout((function(){_.un(e)}),100),cancelEvent(e)})),addEvent(document,"drop",(function(e){return _.un(e,!0),_.drop(e.dataTransfer.files),cancelEvent(e)})),cur.destroy.push((function(){removeEvent(document,"dragenter dragover"),removeEvent(document,"dragleave"),removeEvent(document,"drop")}))},initTagBlock(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=document.querySelector(".PhotoTagBlock");if(e)try{var t=new g(e,_);window.cur.destroy.push(()=>t.destroy())}catch(_){console.error(_),Object(d.c)(_)}}}},294:function(_,e,t){_.exports=t("TkEv")},"2vnv":function(_,e,t){"use strict";t.d(e,"b",(function(){return h})),t.d(e,"i",(function(){return w})),t.d(e,"g",(function(){return m})),t.d(e,"e",(function(){return P})),t.d(e,"d",(function(){return D})),t.d(e,"c",(function(){return M})),t.d(e,"h",(function(){return g})),t.d(e,"f",(function(){return T})),t.d(e,"a",(function(){return C}));var o,i=t("zxIV"),r=t("Egk5"),a=t("EasH"),l=t("v+DW"),s=t("Xrg9"),n=t("t7n3"),c=t("D1OX"),d=t("3oLO"),b=t("4+be"),p=t("kcIO"),u=t("jE6c");!function(_){_[_.DELETED_USER=-5]="DELETED_USER",_[_.BLACKLISTED=-4]="BLACKLISTED",_[_.FRIENDS_COUNT_EXCEEDED=-3]="FRIENDS_COUNT_EXCEEDED",_[_.FLOOD_CONTROL=-2]="FLOOD_CONTROL",_[_.SERVER_ERROR=-1]="SERVER_ERROR",_[_.NOT_FRIENDS=0]="NOT_FRIENDS",_[_.REQUEST_FROM_USER=1]="REQUEST_FROM_USER",_[_.REQUEST_TO_USER=2]="REQUEST_TO_USER",_[_.ARE_FRIENDS=3]="ARE_FRIENDS"}(o||(o={}));var E=t("Ieup"),O=function(){var _;return"feed"===window.cur.module&&window.Feed?null===(_=window.Feed)||void 0===_?void 0:_.getModuleRef():window.cur.module};function h(_,e){if(void 0===e&&(e={}),_){var t=Object(i.v)(_,"from")||"user_rec",o=Object(i.v)(_,"code"),r={scrollY:!1,onViewItem:function(_,o){var i;(null===(i=null==e?void 0:e.checkViewItem)||void 0===i?void 0:i.call(e,_))||w(_,o,t)}};Object(i.v)(_,"next")&&(r.onLoadMore=function(){d.a.post("al_friends.php",{act:"a_recomm_friends_gallery",next:Object(i.v)(_,"next"),track_code:o,friend_id:e.friendId||0,ref:O()},{onDone:function(e,t){var o,r=[];e&&(r=Object(i.p)(Object(i.g)("div",{innerHTML:e}))),null===(o=Object(c.b)(_))||void 0===o||o.addMore(r,!t),Object(i.v)(_,"next",t||null)}})}),new c.a(_,r)}}function w(_,e,t){if(!_.viewed&&Object(i.ab)(_,"ui_gallery_item")){var o=+Object(i.v)(_,"uid"),r=O(),a=v(_);m(["show_user_rec",o,Date.now(),e,r,t,a]),_.viewed=!0}}function v(_){var e,t=Object(i.v)(_,"code");return t||(e=Object(i.Y)("ui_gallery",_),t=Object(i.v)(e,"code")),t||""}function m(_,e){void 0===e&&(e=!1);var t=P();t.push(_),s.a.set("friends_recomm",t),g(e)}function P(_,e,t){void 0===_&&(_=!1),void 0===t&&(t=!1);var o=s.a.get("friends_recomm"),i=Array.isArray(o)?o:[];return e&&(i=i.filter((function(_){return(t?_[1]!==e:_[1]===e)&&Object(n.o)(_[0],["show_user_rec","open_user"])}))),_&&(i=i.map((function(_){return _.join("|")}))),i}function D(_){if(_){var e=P(!1,_,!0);e.length?s.a.set("friends_recomm",e):s.a.remove("friends_recomm")}else s.a.remove("friends_recomm");!function(_){if(_){var e=s.a.get("friends_recomm_visited")||{};delete e[_],s.a.set("friends_recomm_visited",e)}else s.a.remove("friends_recomm_visited")}(_)}function M(_){return(s.a.get("friends_recomm_visited")||{})[_]}function g(_){var e,t;void 0===_&&(_=!1),!(null===(e=window.cur)||void 0===e?void 0:e.friendsRecommLogIdle)&&(null===(t=null===window||void 0===window?void 0:window.curNotifier)||void 0===t?void 0:t.idle_manager)&&(Array.isArray(window.cur.onIdle)||(window.cur.onIdle=[]),Array.isArray(window.cur.onUnidle)||(window.cur.onUnidle=[]),window.cur.friendsRecommLogIdle=function(){clearTimeout(window.cur.friendsRecommLog)},window.cur.onIdle.push(window.cur.friendsRecommLogIdle),window.cur.onUnidle.push(g)),clearTimeout(window.cur.friendsRecommLog),_?f():window.cur.friendsRecommLog=window.setTimeout(f,1e4)}function f(){if(!window.cur.friendsRecommProcess){var _=P(!0);_.length&&(window.cur.friendsRecommProcess=!0,D(),d.a.post("al_friends.php",{act:"a_recomm_logs",logs:_},{onDone:function(){delete window.cur.friendsRecommProcess},onFail:function(){return T(_),delete window.cur.friendsRecommProcess,!0}}))}}function T(_){var e=P();e=_.map((function(_){return _.split("|")})).concat(e),s.a.set("friends_recomm",e)}var C={toggleRecommFriend:function(_,e,t){var s=Object(i.Y)("friend_recomm_card",_),n=s&&+Object(i.v)(s,"uid");if(n){var c={act:"add",mid:n,hash:t,from:"user_rec",ref:O(),track_code:v(s),ts:Date.now()},h=P(!0,n);return h.length&&(D(n),c.logs=h),d.a.post("al_friends.php",c,{onDone:function(e,t){if(Object(i.Cb)(_,e),Object(i.c)(_,"secondary"),Object(l.f)(_,!0),Object(i.c)(s,"friend_recomm_card_accepted"),Object(i.kb)(Object(i.L)("wall_card_text_special",s)),function(_){if(Object(u.l)(_)){var e=_;return(null==e?void 0:e.result_code)===o.REQUEST_FROM_USER}return!1}(t)&&t.friend_request_add_sent_message_nudge){var a=e;Object(p.g)("",{},{tooltipHandler:(n=t.friend_request_entrypoint,function(_,e){var t=e.hide;Object(r.b)(_.querySelector('[data-section-ref="friend_request_notification_send_message"]'),"click",(function(_){var e;if(_.currentTarget instanceof HTMLElement){var o=parseInt(null!==(e=_.currentTarget.getAttribute("data-message-user-id"))&&void 0!==e?e:"");if(!o||Object(r.d)(_))return!0;t(),Object(E.h)(_,o,{params:{box_custom_entrypoint:n}})}}))}),text:t.friend_request_add_sent_message_nudge,title:a})}var n},onFail:function(_){if(h&&T(h),_)return Object(a.d)(Object(b.d)("global_error"),_),!0},showProgress:function(){return Object(l.o)(_)},hideProgress:function(){return Object(l.w)(_)}}),Object(r.c)(e),!1}},hideRecommFriend:function(_,e,t){var o=Object(i.Y)("friend_recomm_card",_),s=o&&+Object(i.v)(o,"uid");if(s){var n=Object(i.Y)("ui_gallery",_),p=O(),u=Object(i.v)(o,"code")||Object(i.v)(n,"code")||"";return d.a.post("al_friends.php",{act:"hide_possible",mid:s,ref:p,track_code:u,hash:t},{onDone:function(){var e=Object(c.b)(Object(i.Y)("ui_gallery",_));if(e){var t=Object(i.Y)("ui_gallery_item",_);e.removeItem(t)}},onFail:function(_){if(_)return Object(a.d)(Object(b.d)("global_error"),_),!0},showProgress:function(){return Object(l.o)(_)},hideProgress:function(){return Object(l.w)(_)}}),Object(r.c)(e),!1}},onClickRecommFriend:function(_){if(Object(i.ab)(_,"ui_gallery_item")||(_=Object(i.Y)("ui_gallery_item",_)),_){var e=+Object(i.v)(_,"uid"),t=O(),o=v(_);!function(_,e,t){var o=s.a.get("friends_recomm_visited")||{};o[_]={ref:e,trackCode:t},s.a.set("friends_recomm_visited",o)}(e,t,o),m(["open_user",e,Date.now(),t,o])}}}},"34p4":function(_,e,t){"use strict";t.d(e,"a",(function(){return o}));var o=function(_){var e=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/);if(e)return{type:e[3]||"wall",id:e[1]+"_"+e[4]}}},"3EzW":function(_,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return a}));var o,i=t("DM2o"),r=t("W9Tc");function a(_){var e={event_type:_,nav_screen:window.cur.module};Object(r.b)("best_friends_analytics_log")&&console.log(e),Object(i.a)("best_friends_product_analytic",e)}!function(_){_.addFriendsFromChat="add_friends_from_chat",_.clear="clear",_.moreChats="more_chats",_.selectFriendFromSearch="select_friend_from_search",_.selectChatFromSearch="select_chat_from_search",_.saveBestFriendsList="save_best_friends_list",_.updatePopupSave="update_popup_save",_.updatePopupCancel="update_popup_cancel",_.createPostFromPopupBest="create_post_from_popup_best",_.createPostFromPopupFriends="create_post_from_popup_friends",_.clickToLockFriends="click_to_lock_friends",_.clickToLockBestFriends="click_to_lock_best_friends",_.editBestFriendsFromPopup="edit_best_friends_from_popup",_.editBestFriends="edit_best_friends",_.selectBestFriends="select_best_friends",_.clickToBestFriendsEntrypoint="click_to_best_friends_entrypoint"}(o||(o={}))},"7lz1":function(_,e,t){"use strict";t.d(e,"a",(function(){return a}));var o=t("t7n3"),i=t("HLtZ"),r=t("kHqu");function a(_){void 0===_&&(_=1);try{var e=function(){var _=document.getElementById("l_ph");if(!_)throw new Error("There is not photo left menu item");var e=_.querySelector(".left_count");return e?Object(o.r)(e.textContent):0}();Object(r.b)("ph",Math.max(e-_,0))}catch(_){console.error(_),Object(i.c)(_)}}},"9xR5":function(_,e,t){"use strict";t.d(e,"a",(function(){return i})),t.d(e,"b",(function(){return r})),t.d(e,"c",(function(){return a})),t.d(e,"d",(function(){return l})),t.d(e,"e",(function(){return s})),t.d(e,"f",(function(){return n}));var o=t("q1tI"),i=function(_,e){var t={};return Object.entries(_).forEach((function(_){var o,i,r,a=_[0],l=_[1],s=a,n=null!==(r=null===(i=null===(o=null==e?void 0:e.itemsById)||void 0===o?void 0:o[s])||void 0===i?void 0:i.score)&&void 0!==r?r:1;t[s]=n*(l||0)})),t},r=function(_){return Object.values(_).reduce((function(_,e){return _+(e||0)}),0)},a=function(_){return r(_)},l=function(){var _,e,t;return"function"==typeof(null===(_=window.cur)||void 0===_?void 0:_.viewAsBox)?(window.cur.viewAsBox(),!1):!(window.vk.widget&&!window.vk.id)||(null===(t=null===(e=window.Widgets)||void 0===e?void 0:e.oauth)||void 0===t||t.call(e),!1)},s=function(_){return new Promise((function(e,t){var o=new Image;o.src=_,o.onload=function(){return e()},o.onerror=function(){return t()}}))},n=function(_){var e=o.useRef(_);return o.useEffect((function(){e.current=_})),e.current}},DN6O:function(_,e,t){"use strict";t.d(e,"a",(function(){return s}));var o=t("Jph1"),i=t("xqyG"),r=t("qYuU"),a=Object(r.a)("reactions-animations-storage",(function(){return{animationItemsData:new Map}})),l=function(){return a().animationItemsData},s=Object(i.a)({animationItemGet:function(_){var e=_.animationId;return l().get(e)},animationItemSet:function(_){var e=_.animationId,t=_.loadedAnimationData;l().set(e,t)},loadAnimation:Object(i.b)(o.a)})},DfBR:function(_,e,t){"use strict";t.d(e,"a",(function(){return i})),t.d(e,"b",(function(){return r}));var o=t("zxIV"),i=function(_){var e=document.querySelector("#wall_tabs");return e?Array.from(e.querySelectorAll(".ui_tab")).filter((function(e){var t=e.parentNode;return null!==t&&t!==_&&!Object(o.ab)(t,"unshown")&&!Object(o.ib)(t,'[data-ui-tab="no_posts"]')})):[]},r=function(){var _=document.querySelector("#wall_tabs"),e=null==_?void 0:_.querySelector(".page_wall_no_posts");null==e||e.remove(),Object(o.mb)(document.querySelector("#wall_tabs"),"page_tabs_hidden")}},DzCs:function(_,e,t){"use strict";var o=t("2vnv");t.d(e,"a",(function(){return o.a}))},F5gA:function(_,e,t){"use strict";t.d(e,"a",(function(){return l}));var o=t("zxIV"),i=t("lXE5"),r=function(_){window.cur.wallLayer?window.wkLayerWrap&&(window.wkLayerWrap.scrollTop=_):Object(i.g)(_,0,!1,!0)},a=function(_){var e,t;r((window.cur.wallLayer?null!==(t=null===(e=window.wkLayerWrap)||void 0===e?void 0:e.scrollTop)&&void 0!==t?t:0:Object(i.e)())+_)},l=function(_,e){if(_ instanceof HTMLElement&&e instanceof HTMLElement){var t="fixed"===Object(o.T)(e,"position"),i=void 0!==window.cur.wallLayer;if(t){var l=_.getBoundingClientRect(),s=20-(e.getBoundingClientRect().top-l.bottom);s>0&&a(s)}else{if(i)return;var n=e.closest(".replies_wrap");n&&function(_){var e=Object(o.j)();if(_.getBoundingClientRect().bottom>e){var t=Object(o.V)(_)[1]+Object(o.Q)(_)-e;r(t)}}(n)}}}},J1I5:function(_,e,t){"use strict";t.d(e,"a",(function(){return a}));t("rGqo"),t("Btvt");var o=t("yTQ2"),i=t("dBLD"),r=t("Nk8j"),a={startTag(){if(!cur.pvTagger&&cur.pvPhoto.firstChild&&(!cur.pvTaggerTooltip&&window.layer?cur.pvTaggerTooltip=new o.a(layer,{closeOnClick:!1,resetDropdownOnShow:!1,onUserSelected:a.addTag,onEscapePressed:a.stopTag}):cur.pvTaggerTooltip.resetFriendsDropdown(),cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),Photoview.toggleTopInfoPanel(getLang("photos_select_tag_area"),`<button class="flat_button" onclick="Phototag.stopTag()">${getLang("global_done")}</button>`),Photoview.toggleNavControls(""),Photoview.toggleOnPhotoControls(!1),layerWrap.scrollTop=0,cur.pvTagger="loading",cur.pvTagger)){var _={minw:30,minh:30,onStart(){cur.pvPhotoTags&&cur.pvPhotoTags.pauseTooltips(),cur.pvTaggerTooltip.hide()},onFinish:a.showFriends};Photoview.updatePhotoDimensions(),cur.pvTagger=window.photoTagger(cur.pvPhoto.firstChild,extend(_,{zstart:50})),cur.pvPhotoTags&&cur.pvPhotoTags.hideAllSuggestedAreas()}},stopTag(){cur.pvTagger&&"loading"!=cur.pvTagger?(Object(r.d)("suggestedTagsInfo")?Photoview.showSuggestedInfoTopPanel(cur.pvCurPhoto):Photoview.toggleTopInfoPanel(!1),hide(cur.pvFriends),cur.pvTaggerTooltip&&cur.pvTaggerTooltip.hide(),cur.pvListId&&cur.pvData[cur.pvListId].length>1&&Photoview.toggleNavControls("left close right"),Photoview.toggleOnPhotoControls(!0),cur.pvTagger.destroy(),cur.pvTagger=!1,Photoview.updatePhotoDimensions(),cur.pvPhotoTags&&cur.pvPhotoTags.reload()):cur.pvTagger=!1},addTag(_,e){if(!cur.pvTagger||"loading"==cur.pvTagger)return!1;var t=cur.pvTagger.result();if(!_&&!e||!t[2])return!1;var o=Object(r.d)("id"),l=Object(r.d)("suggested_tags"),s=cur.pvListId,n=cur.pvIndex,c=cur.pvData[s][n],d=getSize(cur.pvPhoto.firstChild),b=t[0]/d[0]*100,p=t[1]/d[1]*100,u=(t[0]+t[2])/d[0]*100,E=(t[1]+t[3])/d[1]*100;return ajax.post("al_photos.php",{act:"add_tag",mid:_,photo:c.id,name:e,hash:c.hash,x:b,y:p,x2:u,y2:E},{onDone(_,e,t,r,d){if(cur.pvPhotoTags.updatePhotoViewTags(_,e,t,c),r&&d&&cur.pvPhotoTags.updatePhotoViewSuggestedTags(r,d,c),l){var b=Object.keys(l),p=r?b.filter(_=>!r[_]):b;cur.pvPhotoTags.dispatchEvent(i.a.DELETE_TAG,{tagIds:p.map(Number),photoRawId:o})}cur.pvListId==s&&cur.pvIndex==n&&(re(Photoview.actionInfo()),(!c.taginfo&&c.actions.tag&&_[0]<cur.pvMaxTags?show:hide)(cur.pvTagLink),cur.pvTaggerTooltip.hide(),cur.pvTagger.reset(),cur.pvPhotoTags.renderTagAreas(),cur.pvTaggerTooltip.resetFriendsDropdown(),l&&d&&a.stopTag())},onFail:cur.pvPhotoTags.handleTagRequestFail}),!1},showFriends(){if(cur.pvTagger&&"loading"!=cur.pvTagger){var _=cur.pvTagger.result(),e=_[0],t=_[1],o=_[2],i=_[3],r=getXYRect(cur.pvPhoto.firstChild,!0),a=r.left+e,l=r.top+t,s=r.left+e+o,n=r.top+t+i;cur.pvTaggerTooltip.hide(),cur.pvPhotoTags&&cur.pvPhotoTags.resumeTooltips(),cur.pvTaggerTooltip.show({left:a,top:l,right:s,bottom:n},{},!0)}}}},Kl2g:function(_,e,t){"use strict";t.d(e,"a",(function(){return a})),t.d(e,"c",(function(){return n})),t.d(e,"b",(function(){return c}));var o=t("uQjJ"),i=t("qYuU"),r=function(){return(r=Object.assign||function(_){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(_[i]=e[i]);return _}).apply(this,arguments)},a={post_reactions_counts_update:"wall/post_reactions_counts_update",reply_reactions_counts_update:"wall/reply_reactions_counts_update"},l=Object(i.a)("wall-data",(function(){return{emitter:new o.a,keyedListeners:Object.create(null)}})),s=function(_,e,t){var o,i,a=l(),s=null===(i=null===(o=a.keyedListeners)||void 0===o?void 0:o[_])||void 0===i?void 0:i[e];return s&&a.emitter.removeListener(_,s),function(_,e,t){var o,i=l();i.emitter.addListener(_,t),i.keyedListeners[_]=r(r({},i.keyedListeners[_]),((o={})[e]=t,o));return function(){var o,r;i.emitter.removeListener(_,t),(null===(o=i.keyedListeners[_])||void 0===o?void 0:o[e])===t&&(null===(r=i.keyedListeners[_])||void 0===r||delete r[e])}}(_,e,t)},n=function(_,e,t){return s(e,_,t)},c=function(_,e){l().emitter.emit(_,e)}},QxcO:function(_,e,t){"use strict";t.d(e,"a",(function(){return c})),t.d(e,"b",(function(){return d})),t.d(e,"c",(function(){return u}));var o=t("W9Tc"),i=t("zxIV"),r=t("pruO"),a=t("crIy"),l=t("fBgk"),s=function(_,e){var t,r=null===(t=function(_){try{var e=JSON.parse(_);if(null!==e&&"object"!=typeof e)return;return e}catch(_){return}}(_))||void 0===t?void 0:t.set_id,s="string"==typeof r?r:void 0;if(Object(o.b)("reactions_enabled")&&e&&s){var n=Object(a.b)(s);if(n)return{likeClassName:"like_btn--hidden",template:Object(i.qb)(e,{reactions_button_title:Object(l.b)(n)||"",reactions_set_id:s})}}},n=function(_,e){return e.length>_},c=function(_,e){var t,o=null===(t=null==e?void 0:e.wallTpl)||void 0===t?void 0:t.post_likes_reactions,i=n(14,_)?_[14]:void 0;if("string"==typeof i)return s(i,o)},d=function(_,e){var t,i=null===(t=null==e?void 0:e.wallTpl)||void 0===t?void 0:t.reply_likes_reactions;if(Object(o.b)("reactions_enabled_post_replies")){var r=n(14,_)?_[14]:void 0;if("string"==typeof r)return s(r,i)}},b=function(_){var e=JSON.parse(_);if(null===e||"object"==typeof e||Array.isArray(e)){var t;if(Array.isArray(e))e=(t=e,Object.assign(Object.create(null),t));return e}},p=function(_){if(Object(o.b)("reactions_enabled")){var e=n(5,_)?_[5]:void 0;if("string"==typeof e){var t=function(_){var e=_.indexOf(";"),t=_.substr(0,e),o=_.substr(e+1);if("1"===t)return b(o)}(e);if(t)return{counts:t}}}},u=function(_){var e,t=p(_);return(e={})[r.a]=null==t?void 0:t.counts,e}},Rafy:function(_,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return i}));var o=!!t("Xrg9").a.get("reactions.debug_enabled"),i=!1},TkEv:function(_,e,t){"use strict";t.r(e);var o=t("iX+u");window.Photoview=o.a;try{stManager.done(jsc("web/photoview.js"))}catch(_){}},ToGb:function(_,e,t){"use strict";t.d(e,"a",(function(){return w}));var o=t("zxIV"),i=t("ha24"),r=t("Rafy"),a=t("p4k+"),l=t("WQ5g"),s=function(_,e){var t,o;return null!==(o=null!==(t=function(_){var e;if("string"==typeof _)return null!==(e=document.querySelector("#post"+_))&&void 0!==e?e:void 0}(_))&&void 0!==t?t:null==e?void 0:e.closest("._post, .wl_post"))&&void 0!==o?o:void 0},n=t("Kl2g"),c=t("ZD4m"),d=function(_){var e=!1;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(!e)return e=!0,_.apply(this,t)}};function b(_,e){var t=(void 0===e?{}:e).scrollByImpl,o=void 0===t?window.scrollBy:t,i=_;return{start:d((function(_){_&&(i=_);var e=Object(c.a)(i);return d((function(_){if(_&&(i=_),i.isConnected){var t=Object(c.a)(i);o(0,t.top-e.top)}}))}))}}var p=function(_,e){var t,i,r=null===(i=null===(t=window.cur)||void 0===t?void 0:t.wallTpl)||void 0===i?void 0:i[_];if(r)return function(_){return _.replace(/%[-\w]+%/g,"")}(Object(o.qb)(r,e));console.warn("renderTemplate: missing template '"+_+"'")},u=function(_){for(var e=_.isUserAction,t=void 0!==e&&e,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];t?console.error.apply(console,o):r.a&&console.warn.apply(console,o)},E=function(_,e,t){var i=t.isActionStatusBarVisible,r=t.isReactionsPreviewVisible,a=t.positionTrackingEnd,n=function(_,e){var t=Object(l.c)(_);if(t){var i=s(e,t),r=null==i?void 0:i.querySelector('[data-section-ref="post-action-status-bar"]');if(r)return{actionStatusBar:r};var a=Object(o.rb)(p("post_action_status_bar",{class:"PostActionStatusBar--hidden"}));if(a)return Object(o.z)(a,t),{actionStatusBar:a}}}(_,e.postFullId);if(n){var c=n.actionStatusBar;if(c.classList.toggle("PostActionStatusBar--hidden",!i),i&&(Object(l.d)(_)||c.prepend(Object(o.rb)(p("post_reactions_preview",{class:r?"":"ReactionsPreview--empty",object_raw:_})))),a){var d=Object(l.b)(_);null==a||a(d)}}else u({},"Unable to init ActionStatusBar in post",e)},O=function(_){var e=Object(i.b)(_.postFullId),t=s(_.postFullId,Object(l.c)(e));t||u(_,"Missing post element for reactions preview update",{payload:_,likeWrap:Object(l.c)(e)});var o=Object(l.b)(e);if(!!_.isQueueUpdate&&o&&function(_){var e=Object(a.a)(_);if(!e)return!1;var t=e+1e4;return Date.now()<t}(o))r.a&&console.log("Ignoring reactions update from queue",_);else{var n;_.isPrimaryLikeButtonClick&&!_.isFromWkLayer&&o&&(n=b(o).start());var c=Object(a.d)(_.counts),d=c;null==t||t.classList.toggle("post--withActionStatusBar",d),E(e,_,{isActionStatusBarVisible:d,isReactionsPreviewVisible:c,positionTrackingEnd:n}),c&&Object(a.g)(e,{counts:_.counts}),Object(a.f)(e,{counts:_.counts})}},h=function(_){if(!r.b)return!1;var e=Object(i.c)(_.replyFullId);Object(a.g)(e,{counts:_.counts}),Object(a.f)(e,{counts:_.counts})},w=function(){var _=[Object(n.c)("wall-post-action-status-bar",n.a.post_reactions_counts_update,O),Object(n.c)("wall-reply-reactions-counts",n.a.reply_reactions_counts_update,h)];return{onDestroy:function(){_.forEach((function(_){_()})),_=[]}}}},WQ5g:function(_,e,t){"use strict";t.d(e,"b",(function(){return o})),t.d(e,"a",(function(){return i})),t.d(e,"c",(function(){return r})),t.d(e,"d",(function(){return a}));var o=function(_){var e;return null!==(e=document.querySelector('[data-section-ref="reactions-button"][data-reaction-target-object="'+_+'"]'))&&void 0!==e?e:void 0},i=function(_){var e;return null!==(e=_.closest('[data-section-ref="reactions-button"]'))&&void 0!==e?e:void 0},r=function(_){var e,t=o(_);if(t)return null!==(e=t.closest(".like_wrap"))&&void 0!==e?e:void 0},a=function(_){return document.querySelector('[data-section-ref="reactions-preview-items"][data-reaction-target-object="'+_+'"]')}},WX8S:function(_,e,t){"use strict";t.d(e,"a",(function(){return i}));t("SRfc");var o=t("zxIV"),i={init(){if(cur.pvCanvas&&!cur.pvFSControls){var _=positive(getCookie("remixfsss")),e=Math.min(positive(getCookie("remixfsdt"))||5,15);cur.pvFSControls=cur.pvCanvas.appendChild(Object(o.g)("div",{id:"pv_fs_controls",innerHTML:`\n<div id="pv_fs_topright" class="pv_fs_controls">\n  <table cellspacing="0" cellpadding="0">\n    <tr>\n      <td>\n        <div id="pv_fs_num"></div>\n      </td>\n      <td>\n        <div id="pv_fs_close" onclick="Photoview.fullscreenStop()">\n          <div id="pv_fs_close_btn"></div>\n        </div>\n      </td>\n    </tr>\n  </table>\n</div>\n\n<div id="pv_fs_bottomleft" class="pv_fs_controls">\n  <table cellspacing="0" cellpadding="0">\n    <tr>\n      <td>\n        <div id="pv_fs_slide_check" onclick="FullscreenPV.startSlide()">\n          <div class="pv_fs_slide_check_icon"></div>${getLang("photos_slideshow")}\n        </div>\n      </td>\n      <td>\n        <div id="pv_fs_slide_speed_wrap">\n          <div id="pv_fs_slide_about"></div>\n          <div id="pv_fs_slide_speed" onmousedown="FullscreenPV.startSlideEdit(event)">\n            <div id="pv_fs_slide_speed_back"></div>\n            <div id="pv_fs_slide_speed_line">\n              <div id="pv_fs_slide_speed_ctrl"></div>\n            </div>\n          </div>\n        </div>\n      </td>\n    </tr>\n  </table>\n</div>\n\n<div id="pv_fs_left_wrap" class="pv_fs_controls">\n  <div id="pv_fs_left"></div>\n</div>\n\n<div id="pv_fs_right_wrap" class="pv_fs_controls">\n  <div id="pv_fs_right"></div>\n</div>\n`,onmouseover:i.over,onmouseout:i.out})),extend(cur,{pvFSInfo:Object(o.J)("pv_fs_num"),pvFSSlideCheck:Object(o.J)("pv_fs_slide_check"),pvFSSlideSpeedWrap:Object(o.J)("pv_fs_slide_speed_wrap"),pvFSSlideLine:Object(o.J)("pv_fs_slide_speed_line"),pvFSSlideAbout:Object(o.J)("pv_fs_slide_about"),pvFSSlideCont:Object(o.J)("pv_fs_bottomleft"),pvFSSlideDelta:e,pvFSLeft:Object(o.J)("pv_fs_left"),pvFSRight:Object(o.J)("pv_fs_right")}),cur.pvFSSlideLine.style.width=Math.floor(100*(e-1)/14)+"%",Object(o.Cb)(cur.pvFSSlideAbout,getLang("photos_seconds",e)),_&&Object(o.c)(cur.pvFSSlideCont,"pv_fs_slide_on"),i.slide(),addEvent(cur.pvCanvas,"mousemove",i.showControls),addEvent(cur.pvCanvas,"mousedown",i.onClick),addEvent(cur.pvCanvas,"mouseup",i.endSlideEdit),i.showControls(!0),cur.pvPhoto.blur(),i.updateInfo()}},over(_){var e=_||window.event,t=e.target||e.srcElement||document;cur.pvFSOver=!t.id.match(/^pv_fs_(left|right)(_wrap)?$/)},out(){cur.pvFSOver=!1},onClick:_=>(__afterFocus||_&&(2==_.button||3==_.which)||Object(o.ab)(cur.pvCanvas,"pv_fs_one")||(cur.pvFSLeftShown?Photoview.show(cur.pvListId,cur.pvIndex-1):cur.pvFSRightShown&&Photoview.show(cur.pvListId,cur.pvIndex+1)),!!_&&cancelEvent(_)),showControls(_){var e,t,r=cur.pvFSrX=_.pageX,a=cur.pvFSrY=_.pageY;cur.pvFSSlideEdit&&i.updateSlide(),void 0!==cur.pvFSX&&void 0!==cur.pvFSY&&Math.abs(r-cur.pvFSX)+Math.abs(a-cur.pvFSY)<4||(cur.pvFSControlsTimer||(Object(o.mb)(cur.pvCanvas,"pv_fs_nocursor"),clearTimeout(cur.pvFSHideControlsTimer),Object(o.xb)(cur.pvFSControls),Object(o.c)(cur.pvFSControls,"pv_fs_shown")),clearTimeout(cur.pvFSControlsTimer),cur.pvFSOver||cur.pvFSSlideEdit||(cur.pvFSControlsTimer=setTimeout(i.hideControls,3e3)),(e=!cur.pvFSOver&&(r<100||cur.pvFSWidth&&r<(cur.pvScrWidth-cur.pvFSWidth)/2))&&!cur.pvFSLeftShown?Object(o.c)(cur.pvFSLeft,"pv_fs_over"):!e&&cur.pvFSLeftShown&&Object(o.mb)(cur.pvFSLeft,"pv_fs_over"),cur.pvFSLeftShown=e,(t=!cur.pvFSOver&&!e)&&!cur.pvFSRightShown?Object(o.c)(cur.pvFSRight,"pv_fs_over"):!t&&cur.pvFSRightShown&&Object(o.mb)(cur.pvFSRight,"pv_fs_over"),cur.pvFSRightShown=t,cur.pvFSX=r,cur.pvFSY=a)},hideControls(){Object(o.c)(cur.pvCanvas,"pv_fs_nocursor"),Object(o.mb)(cur.pvFSControls,"pv_fs_shown"),clearTimeout(cur.pvFSHideControlsTimer),cur.pvFSHideControlsTimer=setTimeout(o.bb.pbind(cur.pvFSControls),300),cur.pvFSControlsTimer=!1},startSlide(){Object(o.ab)(cur.pvFSSlideCont,"pv_fs_slide_on")?(clearTimeout(cur.pvFSTimer),Object(o.mb)(cur.pvFSSlideCont,"pv_fs_slide_on"),setCookie("remixfsss",0)):(Object(o.c)(cur.pvFSSlideCont,"pv_fs_slide_on"),i.slide(),setCookie("remixfsss",1),clearTimeout(cur.hideAboutTO),cur.hideAboutTO=setTimeout((function(){Object(o.mb)(cur.pvFSSlideAbout,"highlighted")}),3e3),Object(o.c)(cur.pvFSSlideAbout,"highlighted"))},updateSlide(){var _=Math.floor(15*Math.max(Math.min((vk.rtl?cur.pvFSrLeft+cur.pvFSrWidth-cur.pvFSrX:cur.pvFSrX-cur.pvFSrLeft)/cur.pvFSrWidth,.99),0))+1;cur.pvFSSlideDelta!=_&&(setCookie("remixfsdt",cur.pvFSSlideDelta=_),cur.pvFSSlideLine.style.width=Math.floor(100*(_-1)/14)+"%",Object(o.Cb)(cur.pvFSSlideAbout,getLang("photos_seconds",_)))},startSlideEdit(_){if(cur.pvFSrX&&cur.pvFSrY)return extend(cur,{pvFSSlideEdit:!0,pvFSrLeft:Object(o.V)(Object(o.C)(cur.pvFSSlideLine))[0],pvFSrWidth:Object(o.S)(Object(o.C)(cur.pvFSSlideLine))[0]}),Object(o.c)(cur.pvFSSlideCont,"pv_fs_slide_edit"),i.updateSlide(),clearTimeout(cur.pvFSTimer),cancelEvent(_||window.event)},endSlideEdit(){cur.pvFSSlideEdit&&(cur.pvFSSlideEdit=!1,Object(o.mb)(cur.pvFSSlideCont,"pv_fs_slide_edit"),i.slide(),cur.pvFSOver||(clearTimeout(cur.pvFSControlsTimer),cur.pvFSControlsTimer=setTimeout(i.hideControls,3e3)))},slide(){clearTimeout(cur.pvFSTimer),!Object(o.ab)(cur.pvFSSlideCont,"pv_fs_slide_on")||cur.pvFSSlideEdit||Object(o.ab)(cur.pvCanvas,"pv_fs_one")||(cur.pvFSTimer=setTimeout((function(){cur.pvSlideNeedAnimation=!0,Photoview.show(cur.pvListId,cur.pvIndex+1)}),1e3*cur.pvFSSlideDelta))},updateInfo(){var _=((cur.pvData||{})[cur.pvListId]||[]).length,e=cur.pvIndex+1;Object(o.Cb)(cur.pvFSInfo,e+" / "+_),Object(o.yb)(cur.pvFSInfo,_>1),(_>1?o.mb:o.c)(cur.pvCanvas,"pv_fs_one")}};window.FullscreenPV=i},YIAi:function(_,e,t){"use strict";t.d(e,"a",(function(){return o}));var o={PUBLIC:0,ONLY_FRIENDS:1,ONLY_BEST_FRIENDS:2}},YoAk:function(_,e,t){"use strict";var o;t.d(e,"a",(function(){return d})),function(_){_[_.Initial=0]="Initial",_[_.Confirmed=1]="Confirmed",_[_.Declined=2]="Declined"}(o||(o={}));var i=function(){function _(_,e){this.tagEl=_,this.tagArea=e;var t=_.getAttribute("data-item");if(!t)throw new Error("Tag: incorrect json data");var i=JSON.parse(t);this.id=Number(i.id),this.userId=i.userId,this.name=i.name,this.nameGenitive=i.nameGenitive,this.ownerNameGenitive=i.ownerNameGenitive,this.placerNameGenitive=i.placerNameGenitive,this.nameAccusative=i.nameAccusative,this.isSuggested=Boolean(i.isSuggested),this.sex=Number(i.sex),this.styles={top:i.top,left:i.left,width:i.width,height:i.height};var r=o.Initial;_.classList.contains("PhotoTag--confirm")?r=o.Confirmed:_.classList.contains("PhotoTag--decline")&&(r=o.Declined),this.state=r;var a="tag_cutout"+e.getPhotoRawId()+"_"+i.userId,l=document.getElementById(a);if(!l)throw new Error("Tag: incorrect data");this.cutoutEl=l}return _.prototype.decline=function(){this.tagEl.classList.remove("PhotoTag--confirm"),this.tagEl.classList.add("PhotoTag--decline"),this.cutoutEl.classList.remove("PhotoTagCutout--transparency"),this.state=o.Declined},_.prototype.confirm=function(){this.tagEl.classList.remove("PhotoTag--decline"),this.tagEl.classList.add("PhotoTag--confirm"),this.cutoutEl.classList.add("PhotoTagCutout--transparency"),this.state=o.Confirmed},_.prototype.reset=function(){this.tagEl.classList.remove("PhotoTag--decline"),this.tagEl.classList.remove("PhotoTag--confirm"),this.cutoutEl.classList.remove("PhotoTagCutout--transparency"),this.state=o.Initial},_.prototype.getFullRawId=function(){return this.tagArea.getPhotoRawId()+"_"+this.getId()},_.prototype.getId=function(){return this.id},_.prototype.getUserId=function(){return this.userId},_.prototype.getUserName=function(){return this.name},_.prototype.getUserNameGenitive=function(){return this.nameGenitive},_.prototype.getUserNameAccusative=function(){return this.nameAccusative},_.prototype.getOwnerNameGenitive=function(){return this.ownerNameGenitive},_.prototype.getPlacerNameGenitive=function(){return this.placerNameGenitive},_.prototype.isConfirmed=function(){return this.state===o.Confirmed},_.prototype.getSex=function(){return this.sex},_}(),r=t("v+DW"),a=t("W9Tc"),l=t("kcIO"),s=t("4+be"),n=t("EasH"),c=t("7lz1"),d=function(){function _(_,e,t){var o=this;this.confirmTag=function(_,e,t){t&&Object(r.o)(t);var i=!Object(a.b)("recognize_mock_turn_off");return new Promise((function(a,n){window.ajax.post("al_photos.php",{act:"confirm_tag",photo:e.getPhotoRawId(),tag:_.getId(),hash:o.tagHash},{onDone:function(){o.setConfirmedTags([_]),o.decrementLeftMenuCounterIfNeeded([_]),a()},onFail:function(){return i?(o.setConfirmedTags([_]),a(),!0):(Object(l.f)(Object(s.d)("global_unknown_error")),n(),!0)},hideProgress:function(){t&&Object(r.w)(t)}})}))},this.declineTag=function(_,e,t){return new Promise((function(i,n){t&&Object(r.o)(t);var c=!Object(a.b)("recognize_mock_turn_off");window.ajax.post("al_photos.php",{act:"delete_tag",photo:e.getPhotoRawId(),tag:_.getId(),hash:o.tagHash},{onDone:function(){o.setDeclinedTags([_]),o.decrementLeftMenuCounterIfNeeded([_]),i()},onFail:function(){return c?(o.setDeclinedTags([_]),i(),!0):(Object(l.f)(Object(s.d)("global_unknown_error")),n(),!0)},hideProgress:function(){t&&Object(r.w)(t)}})}))},this.confirmSuggestedTags=function(_,e,t){return o.showConfirmAlertBoxIfNeeded(_).then((function(){t&&Object(r.o)(t);var e=!Object(a.b)("recognize_mock_turn_off");return new Promise((function(i,a){window.ajax.post("al_photos.php",{act:"confirm_suggested_tags",tag_raw_ids:o.getFullRawTagIdsStr(_),track_code:o.trackCode,hash:o.tagHash},{onDone:function(){o.setConfirmedTags(_),o.decrementLeftMenuCounterIfNeeded(_),i()},onFail:function(){return e?(o.setConfirmedTags(_),i(),!0):(Object(l.f)(Object(s.d)("global_unknown_error")),a(),!0)},hideProgress:function(){t&&Object(r.w)(t)}})}))}))},this.declineSuggestedTags=function(_,e,t){return new Promise((function(e,i){t&&Object(r.o)(t);var n=!Object(a.b)("recognize_mock_turn_off");window.ajax.post("al_photos.php",{act:"decline_suggested_tags",tag_raw_ids:o.getFullRawTagIdsStr(_),track_code:o.trackCode,hash:o.tagHash},{onDone:function(){o.setDeclinedTags(_),o.decrementLeftMenuCounterIfNeeded(_),e()},onFail:function(){return n?(o.setDeclinedTags(_),e(),!0):(Object(l.f)(Object(s.d)("global_unknown_error")),i(),!0)},hideProgress:function(){t&&Object(r.w)(t)}})}))};var n=_.getEl().querySelector(".PhotoTagArea");if(!n)throw new Error("error: there is not tag area el");if(!e)throw new Error("error: there is not tag hash");var c=Array.from(_.getEl().querySelectorAll(".PhotoTag"));this.trackCode=t,this.tagArea=n,this.tagHash=e,this.photoEntity=_,this.tags=c.map((function(_){return new i(_,o)})),this.tagsMap=this.tags.reduce((function(_,e){return _[e.getId()]=e,_}),{})}return _.prototype.showConfirmAlertBoxIfNeeded=function(_){var e=this,t=_[0];return new Promise((function(_,o){if(window.cur.pvNeedShowAlertForOneSuggest&&t.getUserId()!==window.vk.id)var i=Object(s.d)("photo_recognition_one_tag_alert"),r=Object(s.k)(t.getSex(),Object(s.d)("photo_recognition_one_tag_alert_text","raw")).replace("{name}",t.getUserName()),a=Object(n.d)(i,r,Object(s.d)("photo_recognition_one_friend_submit_btn"),(function(){e.hideHint(),a.hide(),_()}),Object(s.d)("global_cancel"),(function(){a.hide(),o()}));else _()}))},_.prototype.hideHint=function(){window.cur.pvNeedShowAlertForOneSuggest=!1;var _=window.cur.pvOneSuggestHintId,e=window.cur.pvOneSuggestHintHash;_&&e&&window.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:_,hash:e},{onDone:function(){},onFail:function(){return console.error("something wrong with help hint"),!0}})},_.prototype.decrementLeftMenuCounterIfNeeded=function(_){_.forEach((function(_){_.getUserId()===window.vk.id&&Object(c.a)()}))},_.prototype.getFullRawTagIdsStr=function(_){return void 0===_&&(_=this.tags),_.reduce((function(_,e,t){return _+(0===t?"":",")+e.getFullRawId()}),"")},_.prototype.setConfirmedTagsByIds=function(_){var e=this,t=_.reduce((function(_,t){return e.tagsMap[t]&&_.push(e.tagsMap[t]),_}),[]);return!!t.length&&(this.setConfirmedTags(t),!0)},_.prototype.setConfirmedTags=function(_){var e=this;(_=_.filter((function(_){return e.tagsMap[_.getId()]}))).length&&(_.forEach((function(_){return _.confirm()})),this.tagArea.classList.add("PhotoTagArea--fade"))},_.prototype.setDeclinedTags=function(_){_.forEach((function(_){return _.decline()}))},_.prototype.setDeclinedTagsByIds=function(_){var e=this,t=_.reduce((function(_,t){return e.tagsMap[t]&&_.push(e.tagsMap[t]),_}),[]);return!!t.length&&(this.setDeclinedTags(t),!0)},_.prototype.reset=function(){this.tagArea.classList.remove("PhotoTagArea--fade"),this.tags.forEach((function(_){return _.reset()}))},_.prototype.getPhotoRawId=function(){return this.photoEntity.getPhotoRawId()},_.prototype.getTags=function(){return this.tags},_.prototype.getConfirmedTags=function(){return this.tags.filter((function(_){return _.isConfirmed()}))},_.prototype.setSizes=function(_,e){this.tagArea.style.width=_+"px",this.tagArea.style.height=e+"px"},_.prototype.show=function(){this.tagArea.classList.remove("PhotoTagArea--hide")},_.calculateTagAreaSizes=function(_,e,t){var o,i,r=_.offsetWidth,a=_.offsetHeight,l=e/t,s=!0;return r/a>l&&(s=!1),s?(o=Math.round(Math.min(e,r)),i=Math.round(o/l)):(i=Math.round(Math.min(t,a)),o=Math.round(i*l)),[o,i]},_}()},bWc2:function(_,e,t){"use strict";t.d(e,"a",(function(){return o}));var o=function(){var _,e;return window.cur.wallLayer?null!==(_=document.getElementById("wl_reply_form"))&&void 0!==_?_:void 0:"full"===window.cur.wallType&&null!==(e=document.querySelector("#reply_box_wrap"+window.cur.oid+"_"+window.cur.pid+" .reply_box_inner_wrap"))&&void 0!==e?e:void 0}},crIy:function(_,e,t){"use strict";t.d(e,"c",(function(){return b})),t.d(e,"b",(function(){return p})),t.d(e,"d",(function(){return u})),t.d(e,"a",(function(){return E}));var o=t("HLtZ"),i=t("fBgk"),r=t("Rafy"),a=t("qYuU"),l=t("pruO"),s=t("vkmG"),n=function(){return(n=Object.assign||function(_){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(_[i]=e[i]);return _}).apply(this,arguments)},c=Object(a.a)("reactions-storage",(function(){return new Map})),d=Object(a.a)("reactions-config",(function(){return{config:void 0}})),b=function(_){r.a&&console.log(_),Object.entries(_).forEach((function(_){var e=_[0],t=_[1],r=Object(i.i)(t,e);if(r)Object(o.c)(r.error);else{var a=t.map((function(_){return n(n({},_),{title:Object(s.a)(_.title)})}));c().set(e,Object(i.h)(e,a,{imageMenuSize:l.b,imagePreviewSize:l.c}))}}))},p=function(_){var e=c().get(_);if(!e){var t=new Error("Reaction set not found: "+_);return Object(o.c)(t,{environment:"reactions"}),void console.error(t)}return e},u=function(_){r.a&&console.log(_);var e=Object(i.g)(_);e?d().config=e:console.warn("Reactions: invalid menu config passed",_)},E=function(){var _;return null===(_=d())||void 0===_?void 0:_.config}},dBLD:function(_,e,t){"use strict";var o;t.d(e,"a",(function(){return o})),function(_){_.CONFIRM_SUGGESTED_TAGS="CONFIRM_SUGGESTED_TAGS",_.DECLINE_SUGGESTED_TAGS="DECLINE_SUGGESTED_TAGS",_.DECLINE_USER_TAG="DECLINE_USER_TAG",_.CONFIRM_USER_TAG="CONFIRM_USER_TAG",_.DELETE_TAG="DELETE_TAG"}(o||(o={}))},fBgk:function(_,e,t){"use strict";t.d(e,"a",(function(){return i})),t.d(e,"b",(function(){return r})),t.d(e,"h",(function(){return l})),t.d(e,"c",(function(){return s})),t.d(e,"d",(function(){return n})),t.d(e,"e",(function(){return c})),t.d(e,"f",(function(){return d})),t.d(e,"i",(function(){return b})),t.d(e,"g",(function(){return p}));var o=t("/bCM"),i=function(_){return _.itemsById[o.a]},r=function(_){var e;return null===(e=i(_))||void 0===e?void 0:e.title},a=function(_,e){return 0===_.length?"":(t=_,o=function(_){return Math.pow(e.width-_.width,2)+Math.pow(e.height-_.height,2)},i=!1,void 0===i&&(i=!0),t.reduce((function(_,e){var t=o(e),r=o(_);return r===t?i?_:e:r<t?_:e}))).url;var t,o,i},l=function(_,e,t){var o=t.imageMenuSize,i=t.imagePreviewSize,r=e.map((function(_){var e=_.asset,t=_.id,r=_.score,l=_.title,s=_.title_color;return{animationURL:e.animation_url||void 0,id:t,imageMenuURL:a(e.images,o),imagePreviewURL:a(e.images,i),score:r,title:l,titleColor:s}})),l={};return r.forEach((function(_){l[_.id]=_})),{id:_,items:r,itemsById:l}},s=function(_){return _===o.d},n=function(_){return Number.isInteger(_)&&_>=o.c&&_<=o.b},c=function(_){var e=parseInt(_,10);return n(e)?{isValid:!0,value:e}:{isValid:!1}},d=function(_){var e=c(_);return e.isValid?e.value:o.d},b=function(_,e){if(_.length<o.e)return{error:new Error("Invalid reactions items count in set '"+e+"': "+_.length)}},p=function(_){var e;if(null!==(e=_)&&"object"==typeof e&&("number"==typeof _.menuShowDelay||void 0===_.menuShowDelay))return{menuShowDelay:_.menuShowDelay}}},"g/In":function(_,e,t){"use strict";t("HEwt"),t("a1Th"),t("rE2o"),t("ioFf"),t("KKXr"),t("pIFo"),t("rGqo"),t("Btvt");var o=t("zxIV"),i=t("EasH"),r=t("4+be"),a=t("yTQ2"),l=t("Nk8j"),s=t("dBLD"),n=t("W9Tc"),c=t("7lz1");function d(_,e){return function(_){if(Array.isArray(_))return _}(_)||function(_,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(_)))return;var t=[],o=!0,i=!1,r=void 0;try{for(var a,l=_[Symbol.iterator]();!(o=(a=l.next()).done)&&(t.push(a.value),!e||t.length!==e);o=!0);}catch(_){i=!0,r=_}finally{try{o||null==l.return||l.return()}finally{if(i)throw r}}return t}(_,e)||function(_,e){if(!_)return;if("string"==typeof _)return b(_,e);var t=Object.prototype.toString.call(_).slice(8,-1);"Object"===t&&_.constructor&&(t=_.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return b(_,e)}(_,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(_,e){(null==e||e>_.length)&&(e=_.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=_[t];return o}e.a=class{constructor(_,e){this.imageNode=_,this.containerNode=e,this.activeAreaId=null,this.tagAreaFound=!1,this.areasHidden=!1,this.tooltipsPaused=!1,this._handleImageMouseMove=this._handleImageMouseMove.bind(this),this._handleAreaClick=this._handleAreaClick.bind(this),this._removeActiveAreaAfterTimeout=this._removeActiveAreaAfterTimeout.bind(this),this._queueCheckUpdates=this._queueCheckUpdates.bind(this),this._queueReceiveUpdates=this._queueReceiveUpdates.bind(this),this._userSelectedCallback=this._userSelectedCallback.bind(this),this._handleSuggestionDeclined=this._handleSuggestionDeclined.bind(this),this.updatePhotoViewTags=this.updatePhotoViewTags.bind(this),this.deleteTag=this.deleteTag.bind(this),this._init(),this._queueCheckUpdates()}_init(){var _=Object(n.b)("photo_recognition_web");this.photoTooltip=new a.a(window.layer,{onMouseLeave:this._removeActiveAreaAfterTimeout,onUserSelected:this._userSelectedCallback,onDeleteClicked:this.deleteTag,onEscapePressed:this._removeActiveAreaAfterTimeout,onSuggestionDeclined:this._handleSuggestionDeclined,hideAfterDecline:_}),this.photoView=window.Photoview,this.areasContainer=ce("div",{className:"photo_tags_suggested_areas_list"}),this.containerNode.innerHTML="",this.containerNode.appendChild(this.areasContainer),addEvent(this.imageNode,"mousemove",this._handleImageMouseMove),addEvent(this.imageNode,"mouseleave",this._removeActiveAreaAfterTimeout),addEvent(this.imageNode,"mouseenter",this.showAllSuggestedAreas.bind(this)),addEvent(this.areasContainer,"mouseleave",this._removeActiveAreaAfterTimeout),addEvent(this.areasContainer,"click",this._handleAreaClick),this.renderTagAreas()}_handleImageMouseMove(_){if(!this.areasHidden){var e=getXY(_.target),t=Math.round(100*(_.pageX-e[0])/_.target.offsetWidth),o=Math.round(100*(_.pageY-e[1])/_.target.offsetHeight);for(var i in clearTimeout(this.areasTimeOut),this.areasTimeOut=setTimeout(()=>{this.photoTooltip.isActive||this.activeAreaId||this.hideAllSuggestedAreas()},700),this.showAllSuggestedAreas(),this.areas)if(this.areas.hasOwnProperty(i)){var r=this.areas[i],a=r.x,l=r.y,s=r.x2,n=r.y2;if(t>parseInt(a)&&t<parseInt(s)&&o>parseInt(l)&&o<parseInt(n)){if(i===this.activeAreaId)return void(this.tagAreaFound=!0);if(this.tagAreaFound=this.showTagArea(i),this.tagAreaFound)return}}this.tagAreaFound=!1,this._removeActiveAreaAfterTimeout()}}_handleAreaClick(_){cancelEvent(_),this.photoTooltip.showAndFocusFriendsList(_)}showTagArea(_){var e=this.areas[_];return!(!e||e.isDeleted)&&(null!==this.activeAreaId&&this.areas[this.activeAreaId]&&Object(o.mb)(this.areas[this.activeAreaId].ele,"active"),this.activeAreaId=_,Object(o.c)(this.areas[_].ele,"active"),this.showTooltip(_),this.showAllSuggestedAreas(),!0)}hideTagArea(){clearTimeout(this.waitTimeout),null!==this.activeAreaId&&this.areas[this.activeAreaId]&&Object(o.mb)(this.areas[this.activeAreaId].ele,"active"),this.activeAreaId=null,this.photoTooltip.hide(),this.hideAllSuggestedAreas()}_removeActiveAreaAfterTimeout(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.activeAreaId&&!this.waitToRemove&&(this.waitToRemove=!0,clearTimeout(this.waitTimeout),this.waitTimeout=setTimeout(()=>{!this.photoTooltip.isActive&&!this.tagAreaFound&&!this.photoTooltip.interaction&&this.hideTagArea(),this.waitToRemove=!1},_))}showTooltip(_){if(!this.tooltipsPaused){var e=this.areas[_].ele,t=this._getTooltipOptions(_);if(e){var i=Object(o.W)(e,!0),r=i.top,a=i.right,l=i.bottom,s=i.left;this.photoTooltip.show({top:r,right:a,bottom:l,left:s},t)}}}showAllSuggestedAreas(){Object(o.c)(this.areasContainer,"visible_all"),Object(o.mb)(this.areasContainer,"area_hover"),this.activeAreaId&&Object(o.c)(this.areasContainer,"area_hover")}hideAllSuggestedAreas(){Object(o.mb)(this.areasContainer,"visible_all")}pauseTooltips(){this.hideTagArea(),this.tooltipsPaused=!0}resumeTooltips(){this.tooltipsPaused=!1}_createTagElement(_,e,t,o){var i=cur.pvPhWidth,r=cur.pvPhHeight/i,a=t-_,l=o-e,s=ce("div",{className:"photo_tags_suggested_area"},{left:_+"%",marginTop:r*e+"%",width:a+"%"}),n=ce("div",{},{paddingBottom:100*r*(l/a)+"%"});return s.appendChild(n),s}renderTagAreas(){this.areas={},this.areasContainer.innerHTML="";var _=Object(l.d)("tags"),e=Object(l.d)("suggested_tags"),t=Object(n.b)("photo_recognition_web");for(var o in!t&&cur.postTo&&cur.postTo<0&&(e=[]),_)if("0"!==o&&_.hasOwnProperty(o)){var i=d(_[o],7),r=i[0],a=i[1],s=i[2],c=i[3],b=i[4],p=i[5],u=i[6],E=this._createTagElement(r,a,s,c);this.areas[o]={ele:E,x:r,y:a,x2:s,y2:c,userName:b,userHref:p,canDeleteTag:Boolean(u),confirmedTag:!1},this.areasContainer.appendChild(E)}for(var O in e)if(O&&e.hasOwnProperty(O)){var h=d(e[O],7),w=h[0],v=h[1],m=h[2],P=h[3],D=h[4],M=h[5],g=h[6],f=this._createTagElement(w,v,m,P),T=void 0;D&&(T="/id"+D),this.areas[O]={ele:f,x:w,y:v,x2:m,y2:P,userHref:T,suggestedUserId:D,suggestedUserName:M,usersList:g,confirmedTag:!1},this.areasContainer.appendChild(f)}}_userSelectedCallback(_,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(l.d)("tags"),i=Object(l.d)("suggested_tags"),r=Object(n.b)("photo_recognition_web"),a=this.activeAreaId,s=this.areas[a],c=s.x,d=s.y,b=s.x2,p=s.y2,u="/id"+_,E=cur.pvAskForAutoTag&&t,O=clean(e),h={suggestedUserId:!1,suggestedUserName:!1,usersList:[],userId:_,userName:O,userHref:u,canDeleteTag:!0},w=this.activeAreaId;r?this.confirmSuggestedTags([a],()=>{this.activeAreaId=w,this.photoTooltip.updateState(h),this.showTagArea(w),this._removeActiveAreaAfterTimeout(1e3)}):(o[a]=[c,d,b,p,O,u,!0],delete i[a],this._confirmSuggestedTag(a,_,e,r,()=>{this.activeAreaId=w,this.areas[w]=extend(s,h),this.photoTooltip.updateState(h),this.showTagArea(w),this._removeActiveAreaAfterTimeout(1e3),E&&(cur.pvAskForAutoTag=!1,this.showSettingsBox())}))}showSettingsBox(){showBox("/al_photos.php",{act:"show_autotag_settings"},{params:{containerClass:"autotag_settings_box",grey:!0,width:450}})}confirmAlert(){var _=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=cur.pvOneSuggestHintId,t=cur.pvOneSuggestHintHash;_?(e=cur.pvSomeSuggestsHintId,t=cur.pvSomeSuggestsHintHash,cur.pvNeedShowAlertForSomeSuggests=!1):cur.pvNeedShowAlertForOneSuggest=!1,window.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:e,hash:t},{onDone:()=>{},onFail:()=>(console.error("something wrong with help hint"),!0)})}deleteTag(_){_||(_=this.activeAreaId,this.photoView.deleteTag(_)),this.hideTagArea();var e=this.areas[_];_&&e&&(e=extend(e,{isDeleted:!0}),Object(o.c)(e.ele,"deleted"))}_getTooltipOptions(_){var e=this.areas[_],t=e.suggestedUserId,o=e.suggestedUserName;return{suggestedUserId:t,userName:e.userName,userHref:e.userHref,suggestedUserName:o,usersList:e.usersList,canDeleteTag:e.canDeleteTag}}_handleSuggestionDeclined(){var _=this.activeAreaId,e=this.areas[_];if(e){var t=Object(l.d)("suggested_tags"),o=Object(n.b)("photo_recognition_web");this.areas[_]=extend(e,{suggestedUserId:!1,suggestedUserName:!1,userHref:null}),t&&t[_]&&(t[_][4]=0),o?this.declineSuggestedTags([_]):(this.showTagArea(_),this._declineSuggestedTag(_))}}declineSuggestedTags(_,e,t){var i=Object(l.d)("id"),a=Object(l.d)("hash"),n=cur.pvListId,c=cur.pvIndex,d=cur.pvData[n][c],b=Object(l.d)("tags"),p=_.map(_=>`${i}_${_}`).join(",");ajax.post("al_photos.php",{act:"decline_suggested_tags",tag_raw_ids:p,hash:a,extended:1},{onDone:(t,a,l)=>{this.decrementLeftMenuCounterIfNeeded(_),this.updatePhotoViewSuggestedTags(t,a,d),this.dispatchEvent(s.a.DECLINE_SUGGESTED_TAGS,{tagIds:_.map(Number),photoRawId:i}),n===cur.pvListId&&c===cur.pvIndex&&(!d.taginfo&&d.actions.tag&&b[0]<cur.pvMaxTags?Object(o.xb)(cur.pvTagLink):Object(o.bb)(cur.pvTagLink),t||a||this.photoView.toggleTopInfoPanel(Object(r.d)("photos_tag_deleted"),l)),e&&e()},onFail:_=>(_||(_=Object(r.d)("global_unknown_error")),t&&t(),this.handleTagRequestFail(_))})}confirmSuggestedTags(_,e,t){var a=cur.pvListId,n=cur.pvIndex,c=cur.pvData[a][n],d=Object(l.d)("id"),b=Object(l.d)("hash"),p=Object(l.d)("suggested_tags"),u=_.length>1,E=_[0],O=p[E][4],h=()=>{var i=_.map(_=>`${d}_${_}`).join(",");ajax.post("al_photos.php",{act:"confirm_suggested_tags",tag_raw_ids:i,hash:b,extended:1},{onDone:(t,i,r,l,b)=>{this.decrementLeftMenuCounterIfNeeded(_),this.updatePhotoViewTags(t,i,r,c),this.updatePhotoViewSuggestedTags(l,b,c),this.dispatchEvent(s.a.CONFIRM_SUGGESTED_TAGS,{tagIds:_.map(Number),photoRawId:d}),a===cur.pvListId&&n===cur.pvIndex&&(!c.taginfo&&c.actions.tag&&t[0]<cur.pvMaxTags?Object(o.xb)(cur.pvTagLink):Object(o.bb)(cur.pvTagLink)),e&&e()},onFail:_=>(_||(_=Object(r.d)("global_unknown_error")),t&&t(),this.handleTagRequestFail(_))})};if(cur.pvNeedShowAlertForOneSuggest&&!u&&O!==window.vk.id||cur.pvNeedShowAlertForSomeSuggests&&u){var w="",v="",m="";if(u){var P=_.reduce((_,e)=>{var t=p[e],o=t&&t[4];return o&&o!==window.vk.id&&(_[o]=!0),_},{}),D=Object.keys(P).length;v=Object(r.d)("photo_recognition_some_tag_alert",D),w=Object(r.d)("photo_recognition_some_friends_alert_text",D),m=Object(r.d)("photo_recognition_some_friends_submit_btn")}else{var M=p[E][5],g=p[E][7];v=Object(r.d)("photo_recognition_one_tag_alert"),w=Object(r.k)(g,Object(r.d)("photo_recognition_one_tag_alert_text","raw")).replace("{name}",M),m=Object(r.d)("photo_recognition_one_friend_submit_btn")}var f=Object(i.d)(v,w,m,()=>{f.hide(),h(),this.confirmAlert(u)},Object(r.d)("global_cancel"),()=>{f.hide(),t&&t()})}else h()}decrementLeftMenuCounterIfNeeded(_){var e=Object(l.d)("suggested_tags");_.forEach(_=>{var t=e[_],o=t&&t[4];o&&o===window.vk.id&&Object(c.a)()})}_confirmSuggestedTag(_,e,t,o,i){var r=Object(l.d)("id"),a=Object(l.d)("hash");ajax.post("al_photos.php",{act:"confirm_suggested_tag",tag:_,tagged_id:e,name:t,photo:r,hash:a},{onDone:(_,e,t)=>{this.updatePhotoViewTags(_,e,t),i()},onFail:this.handleTagRequestFail})}_declineSuggestedTag(_){var e=Object(l.d)("id"),t=Object(l.d)("hash");ajax.post("al_photos.php",{act:"decline_suggested_tag",tag:_,photo:e,hash:t},{onFail:this.handleTagRequestFail})}dispatchEvent(_,e){this.areasContainer.dispatchEvent(new CustomEvent(_,{detail:e,bubbles:!0}))}handleTagRequestFail(_){var e=Object(r.d)("global_error");return setTimeout(Object(i.d)(e,_).hide,3e3),!0}unMount(){removeEvent(this.imageNode,"mousemove",this._handleImageMouseMove),removeEvent(this.areasContainer,"click",this._handleAreaClick),this.containerNode.innerHTML=""}hideAreas(){this.areasHidden=!0,Object(o.bb)(this.areasContainer),this.photoTooltip.hide()}showAreas(){this.areasHidden=!1,Object(o.xb)(this.areasContainer),removeEvent(this.imageNode,"mousemove",this._handleImageMouseMove),addEvent(this.imageNode,"mousemove",this._handleImageMouseMove)}reload(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.hideTagArea(),this.resumeTooltips(),this.renderTagAreas(),_&&(this.imageNode=_),this.activeAreaId=null,this.waitToRemove=null,this.tagAreaFound=!1,this.areasHidden=!1,this.tooltipsPaused=!1,this.showAreas()}_queueCheckUpdates(){cur.pvTagsQueueParams&&window.Notifier&&Notifier.addKey(cur.pvTagsQueueParams,this._queueReceiveUpdates)}updatePhotoViewTags(_,e,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(o=o||Object(l.b)())&&(o.tags=_,o.tagged=e,o.tagshtml=t,this.photoView.setTags(t))}updatePhotoViewSuggestedTags(_,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(t=t||Object(l.b)())&&(_&&Object.keys(_).length?t.suggested_tags=_:delete t.suggested_tags,e?(t.suggestedTagsInfo=e,this.photoView.showSuggestedInfoTopPanel(cur.pvCurPhoto)):(delete t.suggestedTagsInfo,this.photoView.toggleTopInfoPanel(!1)),this.reload())}_queueReceiveUpdates(_,e){e.events&&e.events.forEach(_=>{var e=_.split("<!>"),t=e[1],o=e[2],i=JSON.parse(o),r=JSON.parse(e[3]),a=JSON.parse(e[4]),s=e[5];if(Object(l.d)("id")===t)Object(l.g)("suggested_tags",i),this.updatePhotoViewTags(r,a,s),this.renderTagAreas();else if(cur.pvData){var n=function(_){if(cur.pvData.hasOwnProperty(_)){var e=cur.pvData[_];e.length&&e.forEach((e,o)=>{if(e.id&&e.id===t){var l=cur.pvData[_][o];l.suggested_tags=i,l.tags=r,l.tagged=a,l.tagshtml=s}})}};for(var c in cur.pvData)n(c)}})}}},ha24:function(_,e,t){"use strict";function o(_){var e=_.match(/^([a-z_]+)([0-9\-_]+)$/);return e?{objectType:e[1],objectId:e[2]}:null}t.d(e,"d",(function(){return o})),t.d(e,"b",(function(){return i})),t.d(e,"c",(function(){return r})),t.d(e,"a",(function(){return a}));var i=function(_){return"wall"+_},r=function(_){return"wall_reply"+_},a=function(_){var e;return null!==(e=_.querySelector(".like_button_count"))&&void 0!==e?e:void 0}},hzb7:function(_,e,t){"use strict";t.d(e,"a",(function(){return O})),t.d(e,"d",(function(){return w})),t.d(e,"e",(function(){return h})),t.d(e,"f",(function(){return E})),t.d(e,"b",(function(){return M})),t.d(e,"c",(function(){return g}));var o,i=t("k487"),r=t("zxIV"),a=t("Egk5"),l=t("t7n3");!function(_){_.topicId="topic_id"}(o||(o={}));var s=function(){return(s=Object.assign||function(_){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(_[i]=e[i]);return _}).apply(this,arguments)},n=new Map,c=function(_,e){return function(_,e){return n.set(_,e)}(_,{actionParams:void 0,selector:e})},d=function(_,e){!function(_,e){var t=n.get(_);void 0!==t&&n.set(_,e(t))}(_,(function(_){return s(s({},_),{actionParams:e})}))},b=function(_,e){var t;d(_,((t={})[o.topicId]=e,t))},p=function(_){return"post_discover_category_btn"+_},u=function(_,e){var t,o,i=(t={link_id:String(e)},(o=Object(l.n)("postCategorySelect",t))?Object(r.rb)(o):null);if(_ instanceof HTMLElement&&i instanceof HTMLElement)return _.appendChild(i),i},E=function(_){var e,t;null===(t=null===(e=function(_){return n.get(_)}(_))||void 0===e?void 0:e.selector)||void 0===t||t.tooltipHide()},O=function(_){var e,t,i=null===(t=function(_){var e;return null===(e=n.get(_))||void 0===e?void 0:e.actionParams}(_))||void 0===t?void 0:t[o.topicId];return void 0!==i&&-1!==i?((e={})[o.topicId]=i,e):void 0},h=function(_){return!0===(null==_?void 0:_.wallPostTopicSettingEnabled)},w=function(_){return void 0!==_.topic_options},v=t("jE6c"),m=t("ZD4m"),P=function(){function _(_,e,t,o){var l=this;this.btnEl=_,this.containerEl=e,this.options=t,this.selectorContentEl=o,this.onOptionClickWrapper=function(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];l.tooltip.hide();var t=_[0].currentTarget;if(t instanceof HTMLElement){var o=Object(m.c)(t,"data-click-params");o&&l.selectTopicId(o.value)}},this.linkId=this.options.linkId,this.radioBtnId=p(this.options.linkId),window.radioBtns[this.radioBtnId]={val:!1,els:o.children},this.tooltip=new i.a(_,{appendTo:e,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-12*(window.vk.rtl?-1:1),7],content:o,align:"left",onFirstTimeShow:function(){Object(r.xb)(o)}}),Object(r.E)('[data-onclick="togglePostTopic"]',e).forEach((function(_){Object(a.b)(_,"click",l.onOptionClickWrapper)}))}return _.create=function(e,t){var o=u(e,t.linkId);if(o){var i=this.getSelectorContentEl(o),a=Object(r.F)(".post_action_btn_layout",o);if(i&&a)return new _(a,o,t,i)}},_.getSelectorContentEl=function(_){return Object(r.F)(".post_action_tt_content",_)},_.prototype.destroy=function(){this.tooltip.destroy(),delete window.radioBtns[this.radioBtnId]},_.prototype.tooltipHide=function(){this.tooltip.hide()},_.prototype.selectTopicId=function(_){this.options.selectTopicId(this.linkId,_),this.updateViewForSelectedTopic({isTopicSelected:-1!==_,topicId:_})},_.prototype.clearSelection=function(){this.selectTopicId(-1)},_.prototype.updateViewForSelectedTopic=function(e){var t=e.isTopicSelected,o=e.topicId,i=_.getSelectOptionEl(this.containerEl,o),a=i&&Object(m.c)(i,"data-click-params"),l=Object(r.F)(".post_action_btn_text",this.containerEl);if(i&&a&&l){var s=a.label;window.radiobtn(i,void 0,p(this.options.linkId));var n=l.getAttribute("data-empty")||"",c=t?s:n;l.innerHTML=c,l.setAttribute("aria-label",Object(v.q)(c)),Object(r.zb)(this.containerEl,"on",t)}},_.getSelectOptionEl=function(_,e){return Object(r.F)('[data-value="'+e+'"]',_)},_}(),D=function(_,e,t){var i=P.create(e,{linkId:_,selectTopicId:b});if(i)return c(_,i),i.selectTopicId(t[o.topicId]),{clearSelection:function(){i.clearSelection()},onDestroy:function(){i.destroy()}}},M=function(_,e){var t;return D(_,e,((t={})[o.topicId]=-1,t))},g=function(_,e,t){var i,r;return D(_,e,((i={})[o.topicId]=null!==(r=t[o.topicId])&&void 0!==r?r:-1,i))}},"iX+u":function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Photoview}));var core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("HEwt"),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("rE2o"),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("ioFf"),core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("91GP"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("a1Th"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("rGqo"),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("Btvt"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("SRfc"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("KKXr"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("pIFo"),_web_photos_photos__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("1OKH"),_web_photos_fullscreen_pv__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("WX8S"),_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("J1I5"),_photo_tags__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("g/In"),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("98sY"),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("/PiP"),_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("zxIV"),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("Egk5"),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("t7n3"),_web_legacy_ui_ui_scroll_box__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("zmTt"),_web_page_wall__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("qwyz"),_internal_nospam_common__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("FThC"),_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("v+DW"),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("EasH"),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("FWc3"),_web_lib_fx__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("7jxN"),_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("aong"),_photoview_utils__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("Nk8j"),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("W9Tc"),_web_photos_types__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("dBLD"),_web_photos_photo_tag_utils__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("7lz1");function _slicedToArray(_,e){return _arrayWithHoles(_)||_iterableToArrayLimit(_,e)||_unsupportedIterableToArray(_,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(_,e){if(_){if("string"==typeof _)return _arrayLikeToArray(_,e);var t=Object.prototype.toString.call(_).slice(8,-1);return"Object"===t&&_.constructor&&(t=_.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(_,e):void 0}}function _arrayLikeToArray(_,e){(null==e||e>_.length)&&(e=_.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=_[t];return o}function _iterableToArrayLimit(_,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(_)){var t=[],o=!0,i=!1,r=void 0;try{for(var a,l=_[Symbol.iterator]();!(o=(a=l.next()).done)&&(t.push(a.value),!e||t.length!==e);o=!0);}catch(_){i=!0,r=_}finally{try{o||null==l.return||l.return()}finally{if(i)throw r}}return t}}function _arrayWithHoles(_){if(Array.isArray(_))return _}var Photoview={MIN_WIDTH:600,MIN_HEIGHT:450,PE_MIN_WIDTH:750,PE_MIN_HEIGHT:500,SIDE_COLUMN_WIDTH:310,SIDE_MIN_GAP:40,VERTICAL_MIN_GAP:15,BOTTOM_BAR_HEIGHT:52,SIDE_NAV_PANELS_MAX_WIDTH:120,SIDE_NAV_PANELS_MIN_WIDTH:25,LEFT_RIGHT_NAV_RATIO:.25,blank:"/images/blank.gif",blankf:()=>{},cacheSize:3,allSizes:["x","y","z","w"],PE_V1:1,PE_V2:2,PE_V3:4,_getViewedPhotoFullId(){var _=cur.pvListId,e=cur.pvIndex;return cur.pvData[_][e].id},changeThumbs(_,e,t){if(_){var o=[ge("photo_row"+cur.filterPhoto),ge("photos_add_thumb"+cur.filterPhoto)],i=geByClass("page_post_thumb_wrap");for(var r in i.push.apply(i,geByClass("page_preview_photo")),i.push.apply(i,geByClass("im_preview_photo")),i.push.apply(i,geByClass("photo")),i.push.apply(i,geByClass("page_square_photo")),i.push.apply(i,geByClass("photos_row")),i)if(i.hasOwnProperty(r)){var a=i[r].getAttribute("onclick");if(!a){var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(i[r]);a=!!l&&l.getAttribute("onclick")}a&&-1!=a.indexOf(`'${cur.filterPhoto}'`)&&o.push(i[r])}for(var s in o)if(o[s]){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.ab)(o[s],"page_square_photo")||o[s].style.backgroundImage){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(o[s],{backgroundImage:`url('${_}')`});continue}var n=geByTag1("img",o[s]);n&&(n.src=_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(n,{height:"auto"}))}if(cur.pvNoTemp||(cur.pvNoTemp={}),cur.pvNoTemp[cur.filterPhoto]=!0,window.ThumbsEdit&&e){var c=ThumbsEdit.cache();for(var d in c)if(c.hasOwnProperty(d)){var b=c[d].previews||[],p=!1;for(var u in b)b.hasOwnProperty(u)&&"photo"==b[u].type&&b[u].photo.id=="photo"+t&&(b[u].photo.sizes=e,delete b[u].photo.restrictionBlur,p=!0);p&&ThumbsEdit.refresh(d)}}}},openStickersEditor(_){cur.pvEditorMode||(_||(_=cur.pvCurPhoto),Photoview.stopTagger(),cur.pvPhotoTags&&cur.pvPhotoTags.hideAreas(),Photoview.toggleNavControls(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvLikeFSWrap),Photoview.hideTag(!0),cur.pvEditorMode=!0,cur.pvEditorSaved=!1,Photoview.updatePhotoDimensions(),stManager.add([jsc("web/spe.js"),"photo_editor.css"],()=>{SPE.init(_,(e,t,o,i)=>{var r=document.querySelector(`.photos_photo_edit_row[data-id="${e.id}"] .photos_photo_edit_row_thumb`);r&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(r,"background-image",`url(${t})`);var a=e.id!=_.id;if(cur.pvEditorSaved=!0,cur.pvPhotoTags&&cur.pvPhotoTags.reload(),_.closeOnPEEdit){if(e&&t&&window.ThumbsEdit&&o){var l=ThumbsEdit.cache();for(var s in l)if(l.hasOwnProperty(s)){var n=s.replace("thumbs_edit",""),c=cur.addMedia[n],d=l[s].previews||[],b=!1;for(var p in d)if(d.hasOwnProperty(p)&&"photo"==d[p].type&&d[p].photo.id=="photo"+_.id){var u=d[p].photo;if(a){u.id="photo"+e.id,u.pid=e.id.split("_")[1];var E=c.getMedias();each(E,(function(){if("photo"==this[0]&&this[1]==_.id)return this[1]=e.id,!1}))}d[p].click=c.showPhoto.pbind(e.id,e.list,parseJSON(i)),d[p].itemId=u.pid,u.sizes=o,b=!0}b&&(ThumbsEdit.refresh(s),c.onChange&&c.onChange())}}return Photoview.changeThumbs(t,o,e.id),Photoview.hide(0)}if(cur.pvListId){var O=cur.pvListId,h=cur.pvData[O],w=cur.pvIndex;if(!h)return nav.reload();var v=h[w];if(a){var m=extend({},e);w=++cur.pvIndex,h.splice(w,0,m),v=m,cur.pvCommsLikes[v.id]=[v.comments,0,vkNow(),!1],delete v.comments,delete v.likes}var P=cur.pvShown&&O==cur.pvListId&&w==cur.pvIndex;e&&t&&!a&&(Photoview.changeThumbs(t,o,_.id),delete v.x_,delete v.x_src,delete v.y_,delete v.y_src,delete v.z_,delete v.z_src,extend(v,e)),v.peType=Photoview.PE_V3,P&&(cur.pvCurData=Photoview.genData(v,Photoview.getPhotoSize()),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvPhoto).src=Photoview.blank,setTimeout(Photoview.show.pbind(cur.pvListId,cur.pvIndex),0))}},()=>{if(delete cur.pvEditorMode,delete cur.pvEditorModeDimensionsUpdated,cur.pvPhotoTags&&cur.pvPhotoTags.reload(),_.closeOnPEEdit)return Photoview.hide(0);show(cur.pvLikeFSWrap),Photoview.toggleNavControls(["left","right","close"]),setTimeout(Photoview.updatePhotoDimensions,1)})}))},genUrl:(_,e)=>e?(e.match(/\.[a-z]{3}(?:\?|$)/i)||(e+=".jpg"),e.match(/https?:\/\//i)?e:(_||"").replace(/\/[a-z0-9_:\.]*$/i,"")+"/"+e):"",genData(_,e){for(var t,o,i="x"==e?3:"y"==e?2:"z"==e?1:0,r=["w","z","y","x"].slice(i),a=0;a<4-i;++a){var l=r[a];if(t=_[l+"_"])break;if(o=_[l+"_src"])break}return t||(t=[o]),{src:Photoview.genUrl(_.base,t[0]),width:t[2]&&t[1],height:t[1]&&t[2],restrictionBlur:_.restrictionBlur,restrictionGeo:_.restrictionGeo,restrictionTitle:_.restrictionTitle,restrictionText:_.restrictionText,photoRaw:_.photoRaw,unblurHash:_.unblurHash}},actionInfo:()=>ge("pv_action_info")||domPN(cur.pvTags).insertBefore(ce("div",{id:"pv_action_info",className:"pv_right_block"}),cur.pvTags),locNav(_,e,t,o){if(cur.pvListId=="newtag"+vk.id+(t.rev?"/rev":"")&&t[0]=="albums"+vk.id&&"added"==t.act)return Photoview.hide(o.hist),!1;if((t=nav.toStr(t)).replace("?rev=1","/rev")==cur.pvListId&&cur.pvShown)return Photoview.hide(o.hist),!1;var i=t.match(/^photo(-?\d+_\d+)\??((all=1|newtag=\d+)(&rev=1)?|(rev=1&)?tag=\d+|rev=1)?$/);if(i){var r=cur.pvListId;r&&cur.pvShown||(r="added"==nav.objLoc.act?"newtag"+vk.id+(nav.objLoc.rev?"/rev":""):nav.strLoc.replace("?rev=1","/rev"));var a=cur.pvData[r];if(a)for(var l=0,s=a.length;l<s;++l)if(a[l]&&a[l].id==i[1])return Photoview.show(r,l,!1,cur.pvRoot),!1}},updateLocNav(){if(cur.pvRoot){for(var _=0,e=cur.nav.length;_<e;++_)if(cur.nav[_]==Photoview.locNav)return;cur.nav.push(Photoview.locNav)}else for(var t=0,o=cur.nav.length;t<o;++t)cur.nav[t]==Photoview.locNav&&(cur.nav.splice(t,1),--t,--o)},toggleOnPhotoControls(_){_=!!_,toggle(cur.pvFSWrap,_)},checkLayerVisibility(){if(cur.pvShown)return!0;debugLog("layerqueue.hide from photoview"),layerQueue.hide(),addEvent(window,"resize",Photoview.onResize),addEvent(document,"keydown",Photoview.onKeyDown),addEvent(layerWrap,"click",Photoview.onLayerClick),boxQueue.hideAll(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(layerBG,{opacity:""}),layers.show(),layers.fullhide=Photoview.hide},emojiShowTT:(_,e)=>void 0!==cur.pvEmoji&&Emoji.ttShow(cur.pvEmoji,_,e),emojiHideTT:(_,e)=>void 0!==cur.pvEmoji&&Emoji.ttHide(cur.pvEmoji,_,e),onImageWrapMouseDown(_){if(2!=_.button&&!cur.pvEditorMode){if(_.target.closest(".pv_attach_product_badge"))return!1;if(cur.pvAttachedProducts.isProcess)return Photoview.attachProductPoint(_),!1;if(!cur.pvTagger&&!1===Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_17__.d)(_)){var e=cur.pvIndex;return Photoview.updateNavBtnsLeftThreshold(),_.pageX<cur.pvLeftBtnAmount?e-=1:e+=1,cur.pvPointerPosition=[_.pageX,_.pageY],Photoview.show(!1,e,_)}}},onImageWrapMouseLeave(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(cur.pvNavBtnLeft,"pv_nav_btn_show"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(cur.pvNavBtnRight,"pv_nav_btn_show"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(cur.pvImageAreaWrap,"pv_init_hover"),Photoview.updateNavBtnsLeftThreshold(!0)},onImageWrapMouseMove(_){Photoview.updateNavBtnsLeftThreshold(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvNavBtnLeft,"pv_nav_btn_show",_.pageX<cur.pvLeftBtnAmount),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvNavBtnRight,"pv_nav_btn_show",_.pageX>cur.pvLeftBtnAmount)},toggleLightModeClass(_){_=!!_&&cur.pvIsLightMode,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvBox,"pv_light_mode",!!_),_=!!_&&cur.pvShowBottomActions,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvBox,"pv_show_bottom_actions",!!_)},isPhotosList:()=>!!(cur.pvVideoTagsShown||cur.pvAlbumsShown||cur.pvAlbumShown||cur.pvPhotoTagShown),createLayer(){cur.pvLayerCreated=!0,delete cur.pvLeftBtnAmount,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(layerWrap,"pv_layer_wrap"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(layerBG,"pv_layer");var _=Photoview.isPhotosList(),e=nav.objLoc[0].match(/^faq(\d)+$/),t=nav.objLoc[0].match(/^bug(\d)+$/),o=cur.translationBoxOpened;cur.pvIsLightMode=t||0==nav.objLoc[0].indexOf("blog/")||e||inArray(nav.objLoc[0],["blog","about","support","helpdesk","tutorial","market","bugs","translation","restore2"])||o||cur.pvOptions&&cur.pvOptions.isLightMode,cur.pvShowBottomActions=!cur.pvIsLightMode||e||inArray(nav.objLoc[0],["helpdesk","support"]);var i=cur.pvAlbumsShown?cur.pvAlbumsData[cur.pvAlbumsShown].html:"",r=cur.pvVideoTagsShown?cur.pvVideoTagsData.html:"",a=_?"display: none":"",l=_?"":"display: none",s=cur.pvAlbumsShown?"":"display: none",n=cur.pvVideoTagsShown?"":"display: none",c=cur.pvAlbumShown?cur.pvAlbumData[cur.pvAlbumShown].html:"",d=cur.pvAlbumShown?"":"display: none";cur.pvPhotoTagShown&&(c=cur.pvPhotoTagData[cur.pvPhotoTagShown].html,d=""),ge("pv_comments")&&(cur.pvBackupComments=ge("pv_comments"),domPN(ge("pv_comments")).removeChild(ge("pv_comments")));var b=`\n    <div style="${l}" class="box_title_wrap box_grey">\n      <div class="box_x_button" onclick="Photoview.hide(0)"></div>\n      <div class="box_title_controls"></div>\n      <div class="box_title"></div>\n    </div>\n    `,p=cur.pvIsLightMode?"":'\n      <div class="pv_fs_wrap">\n        <div class="pv_fs_btn" onmousedown="return Photoview.fullscreen(event);"><div></div></div>\n      </div>\n    ',u=`\n      <div class="pv_bottom_info clear_fix">\n        <div>\n          <div class="pv_bottom_info_left">\n            <span class="pv_album_name" onmouseover="setTitle(this)"></span>\n            <span class="pv_counter"></span></div>\n            ${cur.pvShowBottomActions?'<div class="pv_bottom_actions"></div>':""}\n        </div>\n      </div>`,E=cur.pvIsLightMode?"":'\n      <div class="pv_narrow_column_wrap">\n        <div class="pv_narrow_column_cont wall_module">\n          <div class="narrow_column" id="pv_narrow"></div>\n        </div>\n      </div>',O=getProgressHtml("pv_image_progress");layer.innerHTML=`\n    <div class="pv_cont">\n      <div id="pv_box" class="_scroll_node pv_box" tabindex="0" onclick="cur.pvClicked = true;" onmouseenter="removeClass(layerWrap, 'pv_mouse_out_layer')" onmouseleave="addClass(layerWrap, 'pv_mouse_out_layer')">\n        ${b}\n        <div class="clear_fix pv_photo_wrap" style="${a}">\n          <div class="pv_close_btn" onclick="Photoview.hide(0)"></div>\n          <div class="no_select pv_left_wrap">\n            <div class="no_select pv_image_wrap">\n              <div id="pv_tag_info" class="PhotoViewTopPanel">\n                <div class="pv_tag_info_text"></div>\n                <div class="pv_tag_info_buttons_wrap"></div>\n              </div>\n              <div id="pv_tag_frame"></div>\n              <div id="pv_tag_faded"></div>\n              <div id="pv_tag_person" onmouseout="Photoview.hideTag()"></div>\n              <div class="pv_photo_tags" id="pv_photo_tags"></div>\n              <div class="pv_img_area_wrap pv_init_hover" onmouseleave="return Photoview.onImageWrapMouseLeave(event)" onmousedown="return Photoview.onImageWrapMouseDown(event)" onmousemove="Photoview.onImageWrapMouseMove(event)">\n                <div class="pv_img_progress_wrap">${O}</div>\n                <div id="pv_photo"></div>\n                \n      <div class="pv_nav_btn" id="pv_nav_btn_left" onmousedown="cur.pvClicked = true; Photoview.show(false, cur.pvIndex - 1, event);">\n        <div class="pv_nav_btn_icon"></div>\n      </div>\n      <div class="pv_nav_btn" id="pv_nav_btn_right" onmousedown="cur.pvClicked = true; Photoview.show(false, cur.pvIndex + 1, event);"><div class="pv_nav_btn_icon"></div></div>\n    \n                <div class="pv_like_fs_wrap">\n                ${p}\n                </div>\n              </div>\n            </div>\n            ${u}\n          </div>\n          ${E}\n        </div>\n        <div id="pv_albums_wrap" class="pv_white_bg photos_container_albums" style="${s}">${i}</div>\n        <div id="pv_album_wrap" class="pv_white_bg" style="${d}">${c}</div>\n        <div id="pv_vtagged_wrap" class="pv_white_bg" style="${n}">${r}</div>\n      </div>\n    </div>`,cur.pvYourComment&&domPN(ge("pv_your_comment")).replaceChild(cur.pvYourComment,ge("pv_your_comment")),extend(cur,{pvCont:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(layer),pvBox:ge("pv_box"),pvImageAreaWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_img_area_wrap"),pvLeftWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_left_wrap"),pvTitle:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("box_title_wrap"),pvTitleText:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("box_title"),pvImageWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_image_wrap"),pvNavBtnLeft:ge("pv_nav_btn_left"),pvNavBtnRight:ge("pv_nav_btn_right"),pvNavBtnClose:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_close_btn"),pvNarrowColumnWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_narrow_column_wrap"),pvNarrowColumn:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_narrow_column_cont"),pvPhotoWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_photo_wrap"),pvAlbumWrap:ge("pv_album_wrap"),pvAlbumsWrap:ge("pv_albums_wrap"),pvVTagsWrap:ge("pv_vtagged_wrap"),pvPhotoTagsContainer:ge("pv_photo_tags"),pvTagInfo:ge("pv_tag_info"),pvTagFrame:ge("pv_tag_frame"),pvTagFaded:ge("pv_tag_faded"),pvTagPerson:ge("pv_tag_person"),pvPhoto:ge("pv_photo"),pvTagInfoText:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_tag_info_text"),pvTagInfoButtons:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_tag_info_buttons_wrap"),pvBottomInfo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_bottom_info"),pvAlbumName:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_album_name"),pvCounter:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_counter"),pvBottomActions:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_bottom_actions"),pvBottomLeft:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_bottom_info_left"),pvNarrow:ge("pv_narrow"),pvWide:ge("pv_wide"),pvImgProgress:ge("pv_image_progress"),pvLikeFSWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_like_fs_wrap"),pvFSWrap:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_fs_wrap"),pvFS:ge("pv_fs"),pvFSFg:ge("pv_fs_fg"),pvActions:ge("pvs_actions"),pvYourComment:ge("pv_your_comment"),pvAddMedia:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(ge("pv_add_media")),pvMediaPreview:ge("pv_media_preview"),pvCommentSend:ge("pv_comment_send"),pvComment:ge("pv_comment")}),addEvent(layerWrap,"scroll",Photoview.scrollResize),addEvent(layerWrap,"mousemove",Photoview.onLayerMouseMove),Photoview.updateSize(),_&&_web_legacy_ui_ui_scroll_box__WEBPACK_IMPORTED_MODULE_19__.a.init(!1,{parent:layerWrap});var h=layerWrap.scrollTop;elfocus(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("_scroll_node",cur.pvCont)),layerWrap.scrollTop=h},doShowAlbums(_,e){if(_=intval(_),!e||2!=e.button&&3!=e.which){if(clearTimeout(window.__pvhideTimer),__afterFocus)return!!e&&cancelEvent(e);if(cur.pvTagger&&(_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag(),!1!==e))return!!e&&cancelEvent(e);var t=(cur.pvAlbumsData||{})[_];if(t){Photoview.checkLayerVisibility(),cur.pvRoot=!1,Photoview.updateLocNav(),Photoview.toggleLightModeClass(!1),e&&e.pageX&&e.pageY&&extend(cur,{pvOldX:e.pageX,pvOldY:e.pageY,pvOldT:vkNow()}),cur.pvShown=!0,cur.pvAlbumsShown=_,val("pva_owner")!=_&&extend(cur,{pvaOffset:t.opts.offset,pvaCount:t.opts.count,pvaPhotosOffset:t.opts.photos_offset,pvaPhotosCount:t.opts.photos_count,pvShowAllAlbums:!1}),cur.pvLayerCreated?(val("pva_owner")!=_&&val(cur.pvAlbumsWrap,t.html),isVisible(cur.pvAlbumsWrap)||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvPhotoWrap,cur.pvAlbumWrap,cur.pvVTagsWrap),show(cur.pvAlbumsWrap),Photoview.updateSize(),layerWrap.scrollTop=val("pva_scroll"))):Photoview.createLayer(!0),_web_legacy_ui_ui_scroll_box__WEBPACK_IMPORTED_MODULE_19__.a.show(),show(cur.pvTitle),show(cur.pvAlbumsWrap),cur.pvTitleText.innerHTML=t.opts.summary,cur.pvListId&&"temp"!=cur.pvListId?extend(cur,{pvOldListId:cur.pvListId,pvOldIndex:cur.pvIndex}):(!browser.msie||browser.version>8)&&(cur.pvClicked=!1),Photoview.toggleNavControls(),cur.pvListId=!1;var o=extend(nav.objLoc,{z:"albums"+cur.pvAlbumsShown});return nav.strLoc!=nav.toStr(o)&&(cur.pvNoHistory||++cur.pvHistoryLength,nav.setLoc(o)),Photoview.updatePeriods(),!!e&&cancelEvent(e)}}},jumpToAlbums(_){"temp"!=cur.pvListId||(cur.pvCancelLoad(),cur.pvJumpTo.z!="albums"+val("pva_owner")||cur.pvJumpTo.z!=nav.objLoc.z)?(_&&(cur.pvListId=!1),extend(cur,{pvJumpFrom:!1,pvJumpSteps:0}),nav.change(cur.pvJumpTo)):Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_15__.y)(val("pva_owner"),{noHistory:!0})},jumpToAlbum(_){"temp"!=cur.pvListId||(cur.pvCancelLoad(),cur.pvJumpTo.z!="album"+val("pvsa_album")||cur.pvJumpTo.z!=nav.objLoc.z)?(_&&(cur.pvListId=!1),extend(cur,{pvJumpFrom:!1,pvJumpSteps:0}),nav.change(cur.pvJumpTo)):Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_15__.x)(val("pvsa_album"),{noHistory:!0})},jumpToTagged(_){"temp"!=cur.pvListId||(cur.pvCancelLoad(),cur.pvJumpTo.z!="tag"+val("pvsa_tag")||cur.pvJumpTo.z!=nav.objLoc.z)?(cur.pvJumpTo.z=="tag"+val("pvsa_tag")&&(cur.pvJumpTo.z="photo_"+cur.pvJumpTo.z),_&&(cur.pvListId=!1),extend(cur,{pvJumpFrom:!1,pvJumpSteps:0}),nav.change(cur.pvJumpTo)):Photoview.showTagged(val("pvsa_tag"),{noHistory:!0})},doShowAlbum(_,e){if(!e||2!=e.button&&3!=e.which){if(clearTimeout(window.__pvhideTimer),__afterFocus)return!!e&&cancelEvent(e);if(cur.pvTagger&&(_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag(),!1!==e))return!!e&&cancelEvent(e);var t=(cur.pvAlbumData||{})[_];if(t){Photoview.checkLayerVisibility(),cur.pvRoot=!1,Photoview.updateLocNav(),Photoview.toggleLightModeClass(!1),e&&e.pageX&&e.pageY&&extend(cur,{pvOldX:e.pageX,pvOldY:e.pageY,pvOldT:vkNow()}),cur.pvShown||cur.pvAlbumShown||cur.pvAlbumsShown||layerQueue.push(),_web_legacy_ui_ui_scroll_box__WEBPACK_IMPORTED_MODULE_19__.a.show(),cur.pvShown=!0,cur.pvAlbumShown=_,cur.pvLayerCreated&&val("pvsa_album")==_||extend(cur,{pvsaOffset:t.opts.offset,pvsaCount:t.opts.count}),cur.pvLayerCreated?(val("pvsa_album")!=_&&val(cur.pvAlbumWrap,t.html),isVisible(cur.pvAlbumWrap)||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvPhotoWrap,cur.pvAlbumsWrap,cur.pvVTagsWrap),show(cur.pvAlbumWrap),Photoview.updateSize(),layerWrap.scrollTop=val("pvsa_scroll"))):Photoview.createLayer(),show(cur.pvTitle),show(cur.pvAlbumWrap);var o=t.opts.author||"";if(cur.pvTitleText.innerHTML=(o?o+'<span class="divider"></span> ':"")+t.opts.summary,cur.pvListId&&"temp"!=cur.pvListId){extend(cur,{pvOldListId:cur.pvListId,pvOldIndex:cur.pvIndex});var i=(cur.pvListId||"").split("/");i[0]&&Photoview.showRepeat(ge(i[0]))}else(!browser.msie||browser.version>8)&&(cur.pvClicked=!1);Photoview.toggleNavControls(),cur.pvListId=!1;var r=extend(nav.objLoc,{z:"album"+cur.pvAlbumShown});return nav.strLoc!=nav.toStr(r)&&(cur.pvNoHistory||++cur.pvHistoryLength,nav.setLoc(r)),!!e&&cancelEvent(e)}}},doShowTagged(_,e){if(_=intval(_),!e||2!=e.button&&3!=e.which){if(clearTimeout(window.__pvhideTimer),__afterFocus)return!!e&&cancelEvent(e);if(cur.pvTagger&&(_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag(),!1!==e))return!!e&&cancelEvent(e);var t=(cur.pvPhotoTagData||{})[_];if(t){if(Photoview.checkLayerVisibility(),cur.pvRoot=!1,Photoview.updateLocNav(),Photoview.toggleLightModeClass(!1),e&&e.pageX&&e.pageY&&extend(cur,{pvOldX:e.pageX,pvOldY:e.pageY,pvOldT:vkNow()}),cur.pvShown=!0,cur.pvPhotoTagShown=_,cur.pvLayerCreated&&val("pvsa_tag")==_||extend(cur,{pvsaOffset:t.opts.offset,pvsaCount:t.opts.count}),cur.pvLayerCreated?(val("pvsa_tag")!=_&&val(cur.pvAlbumWrap,t.html),isVisible(cur.pvAlbumWrap)||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvPhotoWrap,cur.pvAlbumsWrap,cur.pvVTagsWrap),show(cur.pvAlbumWrap),Photoview.updateSize(),layerWrap.scrollTop=val("pvsa_scroll"))):Photoview.createLayer(),show(cur.pvTitle),show(cur.pvAlbumWrap),cur.pvTitleText.innerHTML=t.opts.summary,cur.pvListId&&"temp"!=cur.pvListId){extend(cur,{pvOldListId:cur.pvListId,pvOldIndex:cur.pvIndex});var o=(cur.pvListId||"").split("/");o[0]&&Photoview.showRepeat(ge(o[0]))}else(!browser.msie||browser.version>8)&&(cur.pvClicked=!1);Photoview.toggleNavControls(),cur.pvListId=!1;var i=extend(nav.objLoc,{z:"photo_tag"+cur.pvPhotoTagShown});return nav.strLoc!=nav.toStr(i)&&(cur.pvNoHistory||++cur.pvHistoryLength,nav.setLoc(i)),!!e&&cancelEvent(e)}}},toggleNavControls(_){each([cur.pvNavBtnRight,cur.pvNavBtnLeft,cur.pvNavBtnClose],(function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(this)})),isString(_)&&(_=_.split(" ")),each(_||[],(function(_,e){switch(e){case"close":show(cur.pvNavBtnClose);break;case"left":show(cur.pvNavBtnLeft);break;case"right":show(cur.pvNavBtnRight)}}))},getPhotoSize(){var _;switch(cur.pvVeryBig){case 3:_="w";break;case 2:case 1:_="z";break;default:_="y"}return _},show(_,e,t,o){if(!cur.pvEditorMode&&(cur.pvAttachedProducts=cur.pvAttachedProducts||{},cur.pvAttachedProducts.badges&&cur.pvAttachedProducts.badges.forEach(_=>_.remove()),!t||2!=t.button&&3!=t.which))if(cur.cancelClick)delete cur.cancelClick;else{if(Photoview.destroyPeriod(),clearTimeout(window.__pvhideTimer),"temp"==_&&cur.pvShown){if(cur.pvListId&&"temp"!=cur.pvListId)return;cur.pvWasShown=!0}else cur.pvWasShown=!1;if(__afterFocus)return!!t&&cancelEvent(t);if(cur.pvTagger&&(_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag(),!1!==t))return!!t&&cancelEvent(t);if(!1===_){if(cur.pvAlbumsShown||cur.pvAlbumShown||cur.pvPhotoTagShown){if(cur.pvOldListId)return extend(cur,{pvJumpTo:cur.pvOldJumpTo,pvJumpFrom:cur.pvOldJumpFrom,pvJumpSteps:cur.pvOldJumpSteps}),e==cur.pvOldIndex+1&&++cur.pvOldIndex,Photoview.show(cur.pvOldListId,cur.pvOldIndex,t,o);Photoview.toggleNavControls()}_=cur.pvListId}var i=((cur.pvData||{})[_]||{}).length,r=_!=cur.pvListId;if(i){t&&t.pageX&&t.pageY&&extend(cur,{pvOldX:t.pageX,pvOldY:t.pageY,pvOldT:vkNow()}),(cur.pvOptions||{}).queue&&(layerQueue.push(),cur.pvOptions.queue=!1,cur.pvHistoryLength=0),Photoview.checkLayerVisibility()||(r=!0);var a=e+(e<0?i:e>=i?-i:0),l=r?1:cur.pvIndex>e?-1:1;if(!r&&!cur.pvCanvas){if(cur.pvJumpTo){if(cur.pvJumpSteps+=e-cur.pvIndex,a===cur.pvJumpFrom&&cur.pvJumpSteps>=i)return extend(cur,{pvOldJumpFrom:cur.pvJumpFrom,pvOldJumpSteps:cur.pvJumpSteps-(e-cur.pvIndex),pvOldJumpTo:cur.pvJumpTo}),Photoview.jumpToAlbums(cur.pvJumpSteps<0);if(l>0&&(a<cur.pvJumpFrom&&a+4>cur.pvJumpFrom||a<cur.pvJumpFrom+i&&a+4>cur.pvJumpFrom+i)){vkImage().src=stManager._srcPrefix(".css")+"/images/icons/post_hh"+(window.devicePixelRatio>=2?"_2x":"")+".png?3";var s=cur.pvJumpTo.z.match(/^albums(-?\d+)$/);s&&(cur.pvAlbumsData||(cur.pvAlbumsData={}),cur.pvAlbumsData[s[1]]||(cur.pvAlbumsData[s[1]]="loading",ajax.post("al_photos.php",{act:"show_albums",owner:s[1],other:1},{onDone:Photoview.loadedAlbums})))}cur.pvJumpSteps<=-i&&(cur.pvJumpSteps+=i)}if(1==i&&e!=cur.pvIndex&&("temp"!=_||cur.pvOptions.temp_final))return Photoview.hide(),!!t&&cancelEvent(t)}r&&"temp"!=_&&(!1===cur.pvJumpFrom&&(cur.pvJumpFrom=a),cur.pvRoot=o,Photoview.updateLocNav()),e=a;var n=cur.pvData[_][e];if(n&&(n.x_||n.x_src)){cur.pvIndex=e,cur.pvShown=!0,cur.pvAlbumsShowing=cur.pvAlbumsShown=!1,cur.pvAlbumShowing=cur.pvAlbumShown=!1,cur.pvPhotoTagShowing=cur.pvPhotoTagShown=!1,cur.pvVideoTagShowing=cur.pvVideoTagsShown=!1,cur.pvListId=_,Photoview.calculateVeryBig();var c=Photoview.getPhotoSize();return cur.pvCurData=Photoview.genData(n,c),cur.pvLayerCreated||Photoview.createLayer(),cur.pvCurrent&&(cur.pvCurrent.onload=Photoview.blankf,cur.pvCurrent.src=Photoview.blank),delete cur.pvCurrent,cur.pvCurrent=vkImage(),cur.pvCurrent.onload=Photoview.preload.pbind(e,l),cur.pvCurrent.src=cur.pvCurData.src,r&&Photoview.toggleNavControls(i>1?"left right close":"close"),hideProgress(cur.pvCounter),"temp"!=_||cur.pvOptions.temp_final?"temp"==_&&cur.pvOptions.temp_final&&cur.pvOptions.temp_summary||(cur.pvCounter.innerHTML=i>1?getLang("photos_photo_counter_num_of_N").replace("%s",cur.pvIndex+1).replace(/%s|{count}/,i):""):((Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(cur.pvCurData)||cur.pvCurData.restrictionGeo)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvImgProgress),showProgress(cur.pvCounter,"","pr_baw")),cur.pvCurPhoto=n,cur.pvCurData.width&&cur.pvCurData.height?Photoview.doShow():(cur.pvCurData=cur.pvCurrent,cur.pvTimerPassed=0,clearTimeout(cur.pvTimer),cur.pvTimer=setTimeout(Photoview.doShow,0)),cur.pvBox&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvBox,"photos_is_albums_view",!!cur.pvAlbumsShown),!!t&&cancelEvent(t)}}}},_checkWebGL:()=>navigator.userAgent.indexOf("Windows NT 5.1")>=0?-1:function(){try{var _=document.createElement("canvas");_.width=_.height=100;var e={preserveDrawingBuffer:!0,premultipliedAlpha:!1};return!!window.WebGLRenderingContext&&(_.getContext("webgl",e)||_.getContext("experimental-webgl",e))}catch(_){return!1}}()?1:browser.safari?(debugLog("photo editor: webgl enable needed"),-2):(debugLog("photo editor: webgl not suported"),-1),openEditor(_,e){function t(t){return t||debugLog("photo editor: CORS not available ("+e+")"),showBox("al_photos.php",{act:"edit_photo",photo:_||cur.pvData[cur.pvListId][cur.pvIndex].id,webgl:Photoview._checkWebGL(),cors:t},{dark:1,stat:["ui_controls.css","ui_controls.js"]})}e=e||cur.pvCurData.src;var o=vkImage();o.onerror=()=>t(0),o.onload=()=>t(1),o.crossOrigin="",o.src=e},showSpamActions(){show(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_more_acts_hidden")),cur.pvMoreActionsTooltip.updatePosition()},doShow(){var _=cur.pvCurData;if(Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(_)||show(cur.pvImgProgress),(!_.width||!_.height)&&cur.pvTimerPassed<5e3)return clearTimeout(cur.pvTimer),cur.pvTimerPassed+=100,void(cur.pvTimer=setTimeout(Photoview.doShow,100));if(cur.pvShown)if(cur.pvCanvas)Photoview.pvCanvasSet();else{Photoview.toggleLightModeClass(!0),isVisible(cur.pvAlbumsWrap)&&(val("pva_scroll",layerWrap.scrollTop),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvAlbumsWrap),show(cur.pvPhotoWrap),Photoview.updateSize()),isVisible(cur.pvAlbumWrap)&&(val("pvsa_scroll",layerWrap.scrollTop),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvAlbumWrap),show(cur.pvPhotoWrap),Photoview.updateSize()),_web_legacy_ui_ui_scroll_box__WEBPACK_IMPORTED_MODULE_19__.a.hide(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvTitle),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvPhoto,"ZPhotosRestriction--geo",!!_.restrictionGeo),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvPhoto,"ZPhotosRestriction--blur",Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(_));var e=cur.pvPhoto&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvPhoto);if(e&&e.src){var t=/https?:\/\/[a-z0-9\.\-]+/;(e.src.replace(t,"")!=_.src.replace(t,"")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.ab)(e,"ZPhotosRestriction")||_.restrictionGeo||_.restrictionBlur)&&z(_)}else z(_);if(addEvent(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvPhoto),"load",()=>Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvImgProgress)),Photoview.updatePhotoDimensions(),window.tooltips&&tooltips.destroyAll(cur.pvBox),"temp"==cur.pvListId)return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvCommentsData),Photoview.toggleOnPhotoControls(!1),void Photoview.updateVerticalPosition();Photoview.toggleOnPhotoControls(!0);var o=cur.pvCurPhoto;if(o.peData)return o.closeOnPEEdit=!0,void Photoview.openStickersEditor(o);var i=!(o.commshown>=0)&&-o.commshown;cur.pvTagger&&_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag(),Photoview.hideTag(!0),(_.width<200||_.height<200)&&(o.actions.prof=!1,o.actions.dialog=!1);var r="";("NA"!=o.album&&2!=i||o.graffiti)&&(r=o.album);var a=!o.album||!o.author;if(!cur.pvIsLightMode&&!a){var l="";l+='<div class="pv_author_block clear_fix">';var s="";"NA"!=o.author&&(s=o.author),s&&(o.author_href&&(l+=`<a class="pv_author_img fl_l" href="${o.author_href}">`),l+=`<div class="ow_ava ow_ava_comm" style="background-image: url('${o.author_photo}');"></div>`,o.author_href&&(l+="</a>")),l+=`\n        <div class="pv_author_info">\n          <div id="pv_author_name">${s}</div>\n          <div class="pv_date_info_wrap">\n            <span id="pv_date_info">${o.date}</span>\n          </div>\n        </div>\n      </div>`,l+=getProgressHtml("pv_progress");var n=cur.pvCommsLikes[o.id],c=n[0],d=n[1];l+=Likes.makeTemplate(o.likes_tpl,{object_raw:o.id,likes_count:d||"",liked:o.liked,share_count:o.shares||"",share_opts:{list:cur.pvListId,to:"mail"}});var b=1&o.actions.edit||o.desc,p="";if(b){var u=o.desc||`<span class="pv_desc_edit">${getLang("photos_edit_desc")}</span>`,E="";1&o.actions.edit?(E+='class="pv_can_edit pv_desc_cont"',E+='onclick="Photoview.editInline(event)"'):E+='class="pv_desc_cont"',p=`<div ${E}>${u}</div>`}1==o.was_edited?l+=`<div id="pv_edit_info" class="pv_right_block">${getLang("photos_was_edited")}</div>`:o.was_edited&&(l+=`\n          <div id="pv_edit_info" class="pv_right_block" onmouseover="showTooltip(this, {\n            text: '${o.was_edited}',\n            black: 1\n          });">${getLang("photos_was_edited")}</div>`),l+='<div id="pv_desc" class="pv_right_block" style="'+(b?"":"display: none")+'">'+p+"</div>",l+='<div id="pv_attached_products_list"></div>',l+='<div id="pv_microdata">'+(o.microdata_html?o.microdata_html:"")+(o.microdata_preview_button?o.microdata_preview_button:"")+"</div>",o.microdata_html&&shortCurrency(),l+='<div id="pv_tags"'+(o.tagshtml?"":' style="display: none"')+' class="pv_right_block">'+getLang("photos_onthisphoto")+": "+o.tagshtml+"</div>",l+='<div id="pv_place" class="pv_right_block">'+(o.place?'<span class="pv_place_label"></span> <a class="pv_place_a" id="pv_place_a" onclick="Photoview.showPlace()">'+o.place+"</a>":"")+"</div>",l+=c.tagName?'<div id="pv_comments_place"></div>':trim(c),cur.pvReplyForm&&re(cur.pvReplyForm),cur.pvReplyForm=null,l+='<div id="pv_rotate"><form method="POST" target="pv_rotate_frame" name="pv_rotate_form" id="pv_rotate_form"></form></div></div>',cur.pvNarrow.innerHTML="",Photoview.updateRightBlock(),cur.pvNarrow.innerHTML=l;var O=_slicedToArray(Photoview.generateMarketList(o.attached_tags.tags),2),h=O[0],w=O[1];o.attached_tags.tags&&o.attached_tags.tags.length&&document.getElementById("pv_attached_products_list").appendChild(h),cur.pvImageAreaWrap.appendChild(w);var v=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_closed_commments_placeholder"),m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_no_commments_placeholder");if(i||!o.actions.comm?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(v,"unshown"),i&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(m,"unshown")):o.reply_form&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(v,"unshown"),o.replyFormEl=cur.pvReplyForm=o.replyFormEl||se(o.reply_form),cur.pvNarrowColumn.appendChild(cur.pvReplyForm),cur.onReplyFormSizeUpdate=cur.onMediaChanged=_=>{cur.pvShown&&Photoview.updateRightBlock()},cur.onReplyFormFocus=()=>{Photoview.updateRightBlock(!0),cur.pvNarrowScrollbar.scrollBottom(0,!0)}),c.tagName){each(geByClass("page_gif_loading",c),()=>{Page.hideGif(this,!1)});var P=ge("pv_comments_place");domPN(P).replaceChild(c,P)}if(cur.pvNarrowScrollbar=new uiScroll(cur.pvNarrow,{global:!0}),o.reply_form){var D=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("reply_field",cur.pvNarrowColumn);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.l)(D,"send",Photoview.sendComment),placeholderInit(D,{editable:1}),cur.pvOptions.commentFocusInit){delete cur.pvOptions.commentFocusInit;var M=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("submit_post_field",cur.pvReplyForm);M&&M.focus()}}cur.editing=!1,Photoview.updateRightBlock()}var g=[];if(r=r||"",cur.pvAlbumName.innerHTML=r,toggle(cur.pvBottomInfo,!cur.pvIsLightMode||cur.pvShowBottomActions||r),vk.id&&o.actions.share&&g.push(`<a id="pv_share" onclick="Photoview.sendPhoto()">${getLang("photos_share_from_view")}</a>`),!o.taginfo&&o.actions.tag&&o.tags[0]<cur.pvMaxTags&&!Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(o)&&g.push(`\n          <a id="pv_tag_link" onclick="stManager.add([jsc('web/photo_tagger_mode.js'), 'tagger.css', jsc('web/tagger.js')], () => {\n            Phototag.startTag();\n          })">${getLang("photos_tagperson")}</a>`),o.actions.del&&g.push(`<a id="pv_delete" onclick="Photoview.deletePhoto()">${getLang("photos_pv_act_delete")}</a>`),o.actions.save&&g.push(`<a id="pv_save_to_me" onclick="Photoview.savePhoto()">${getLang("photos_pv_act_save")}</a>`),cur.pvShowBottomActions&&!a){var f=[],T=[];if(o.actions.spam&&(f.push(["spam",getLang("photos_report"),"","Photoview.showSpamActions()"]),f.push("sep"),T=cur.pvReasons),o.actions.forbid){var C=Photoview._getViewedPhotoFullId().split("_"),L=C[0],A=C[1];f.push(["atfr",getLang("reports_atfr"),"sfof("+L+", "+A+", 1)"])}if(o.actions.blur){var j=Photoview._getViewedPhotoFullId().split("_"),I=j[0],W=j[1];f.push(["b",getLang("reports_b"),"scblf('photo', "+I+", "+W+")"])}if(o.actions.geoBlock){var R=Photoview._getViewedPhotoFullId().split("_"),B=R[0],U=R[1];f.push(["gb",getLang("reports_gb"),"scgbf('photo', "+B+", "+U+")"])}if(o.actions.edit&&(o.peType&Photoview.PE_V1||o.peType&Photoview.PE_V2)&&f.push(["pe",getLang("photos_pv_act_photoeditor"),"Photoview.openEditor()"]),vk.id&&o.actions.pe&&o.peType&Photoview.PE_V3&&Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_15__.q)()&&!inArray(nav.objLoc[0],["support","helpdesk"])&&!o.restrictionGeo&&!Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(o)){var K=Object(_shared_user_user_env__WEBPACK_IMPORTED_MODULE_28__.b)("web_photo_editor_hide_entrypoint")?getLang("photos_pv_act_photoeditor"):getLang("global_pe_edit");f.push(["spe",K,"Photoview.openStickersEditor()"])}if(o.actions.rot&&(f.push(["rotate_ccw",getLang("photos_pv_act_rotate_ccw"),"Photoview.rotatePhoto(-1)"]),f.push(["rotate_cw",getLang("photos_pv_act_rotate_cw"),"Photoview.rotatePhoto(1)"]),f.push("sep")),o.actions.place&&f.push(["place",getLang("photos_edit_add_place"),"Photoview.editPlace()"]),o.attached_tags&&o.attached_tags.hash&&f.push(["market",getLang("photos_edit_add_market"),"Photoview.selectProductInBox()"]),o.actions.prof&&o.profile_data){var y=JSON.stringify(o.profile_data);f.push(["to_profile",getLang("photos_pv_act_to_avatar"),"","",`data-task-click='Page/owner_set_exist_photo' data-options='${y}'`])}if(o.actions.dialog&&f.push(["to_dialog",getLang("photos_load_to_dialog"),`showBox('al_page.php', {act: 'owner_photo_edit', photo: '${o.id}', oid: ${o.actions.dialog}, list: '${cur.pvListId}'}, {stat: ['owner_photo.css', jsc('web/owner_photo.js'), 'tagger.css', jsc('web/tagger.js')]});`]),o.actions.move){var k=o.id.split("_")[0];f.push(["move_to",getLang("photos_pv_act_move_to_album"),`\n            showBox('al_photos.php', {act: 'a_move_to_album_box', photo_id: '${o.id}', owner_id: ${k}}, {stat: ['page.js', 'page.css', 'wide_dd.js', 'wide_dd.css']})\n          `]),o.actions.cover&&f.push(["as_title",getLang("photos_album_to_cover"),`\n              ajax.post('al_photos.php', {act: 'a_set_as_album_title', photo: '${o.id}', hash: '${o.hash}'}, {onDone: showDoneBox})\n            `])}var S="";each(T,(_,e)=>{var t="Photoview.report('"+o.hash+"', '"+e[0]+"')";S+=`<div onclick="${t}" class="pv_more_act_item pv_more_spam_act_item" id="pv_more_spam_act_${e[0]}">${e[1]}</div>`}),S=S?'<div class="pv_more_acts_hidden">'+S+"</div>":"";var x="";each(f,(_,e)=>{"sep"===e?0!==_&&_!==f.length-1&&(x+='<div class="pv_more_act_item_sep"></div>'):x+=`\n              <div class="pv_more_act_item" onmouseover="${e[3]||""}" onclick="${e[2]||""}" id="pv_more_act_${e[0]}" ${e[4]||""}>\n                ${e[1]}\n              </div>\n            `}),o.restrictionGeo||Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(o)||(x+=`<a\n          class="pv_more_act_item"\n          id="pv_more_act_download"\n          target="_blank"\n          rel="noopener"\n          href="${Photoview.genData(o,"w").src}\n        ">\n            ${getLang("photos_pv_act_open_original")}\n        </a>`),x=`<div class="pv_more_acts">${x}</div>`,f.length?(f=(f=JSON.stringify(f)).replace(/\"/g,"&quot;"),g.push(`<a class="pv_actions_more" data-items="${f}">${getLang("photos_actions_more")}</a>`)):inArray(nav.objLoc[0],["support","helpdesk"])&&g.push(`\n            <a id="pv_more_act_download" target="_blank" rel="noopener" href="${Photoview.genData(o,"w").src}">\n              ${getLang("photos_pv_act_open_original")}\n            </a>\n          `),g=g.join('<span class="divider"></span>'),cur.pvIsLightMode&&(g+='<div id="pv_rotate" style="display:none;"><form method="POST" target="pv_rotate_frame" name="pv_rotate_form" id="pv_rotate_form"></form></div></div>'),cur.pvBottomActions.innerHTML=g;var F=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_actions_more");F&&(cur.pvMoreActionsTooltip=new ElementTooltip(F,{id:"pv_more_acts_tt",forceSide:"top",elClassWhenShown:"pv_more_shown",content:S+x,offset:[0,-5],autoShow:!0,noHideOnClick:!0}))}if(Photoview.updatePhotoDimensions(),extend(cur,{pvTagLink:ge("pv_tag_link"),pvLikeIcon:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_like_icon"),pvLikeLink:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_like_link"),pvDesc:ge("pv_desc"),pvTags:ge("pv_tags"),pvEditing:!1,pvProgress:ge("pv_progress")}),o.deleted||!o.author)cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),isArray(o.deleted)&&Photoview.toggleTopInfoPanel(o.deleted[0],o.deleted[1]),a||Photoview.toggleDeletedState(!0);else if(o.taginfo){cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags");var N=getLang("photos_confirm_tag"),H=getLang("photos_delete_tag"),J=`\n        <button class="flat_button" id="pv_confirm_tag" onclick="Photoview.confirmTag(${o.tagid}, this)">\n          ${N}\n        </button>\n        <button class="flat_button secondary black" id="pv_delete_tag" onclick="Photoview.deleteTag(${o.tagid}, this)">\n          ${H}\n        </button>\n      </div>\n      `;Photoview.toggleTopInfoPanel(o.taginfo,J),show(cur.pvCommentsData)}else o.suggestedTagsInfo?Photoview.showSuggestedInfoTopPanel(o):(Photoview.toggleTopInfoPanel(!1),Photoview.toggleDeletedState(!1));(cur.pvOptions||{}).scroll&&cur.pvNarrowScrollbar&&cur.pvNarrowScrollbar.scrollTop(cur.pvOptions.scroll),cur.pvBodyScrollTop=bodyNode.scrollTop,setTimeout((function(){void 0!==cur.pvBodyScrollTop&&(bodyNode.scrollTop=cur.pvBodyScrollTop,delete cur.pvBodyScrollTop)}),0),Photoview.updateVerticalPosition();var V=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvPhoto);cur.pvPhotoTags?cur.pvPhotoTags.reload(V):vk.id&&(cur.pvPhotoTags=new _photo_tags__WEBPACK_IMPORTED_MODULE_13__.a(V,cur.pvPhotoTagsContainer)),setTimeout(Photoview.afterShow,2)}function z(_){var e="";if(Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(_)){var t=`event.stopPropagation(); Page.unblurPhoto('${_.photoRaw}', '${_.unblurHash}', this);`;e=`<div class="ZPhotosRestriction__title">${_.restrictionTitle||" "}</div><div class="ZPhotosRestriction__text">${_.restrictionText}</div><button class="ZPhotosRestriction__button" onmousedown="${t}">${getLang("photos_restriction_button_watch")}</button>`}_.restrictionGeo&&(e=`<div class="ZPhotosRestriction__title">${_.restrictionText||" "}</div>`),cur.pvPhoto.innerHTML='<img src="'+(_.src||"/images/blank.gif")+'" />'+e}},toggleTopInfoPanel(_,e){var t=!!isString(_)||!!_;void 0!==_&&(cur.pvTagInfoText.innerHTML=_),void 0!==e&&(cur.pvTagInfoButtons.innerHTML=e),cur.pvTagInfo.classList.toggle("PhotoViewTopPanel--show",t),Photoview.updatePhotoTagsContainerDimensions(),Photoview.updatePhotoDimensions()},toggleDeletedState(_){_=!!_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvCont,"pv_deleted_state",_),Photoview.updateRightBlock()},showSuggestedInfoTopPanel(_){if(Object(_shared_user_user_env__WEBPACK_IMPORTED_MODULE_28__.b)("photo_recognition_web")&&_.suggestedTagsInfo){cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags");var e=Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.d)("suggested_tags");if(e){var t=Object.keys(e);if(t.length){var o="",i="";if(t.length>1)o=getLang("photo_tag_confirm_all"),i=getLang("photo_recognition_decline_all");else e[t[0]][4]===vk.id?(o=getLang("photo_recognition_item_confirm_me"),i=getLang("photo_recognition_item_decline_me")):(o=getLang("photos_confirm_tag"),i=getLang("photos_delete_tag"));var r=`\n        <button class="flat_button" id="pv_confirm_suggested_tags" onclick="Photoview.confirmAllSuggestedTags(this)">\n          ${o}\n        </button>\n        <button class="flat_button secondary black" id="pv_decline_suggested_tags" onclick="Photoview.declineAllSuggestedTags(this)">\n          ${i}\n        </button>\n      </div>\n      `;Photoview.toggleTopInfoPanel(_.suggestedTagsInfo,r)}}}},updatePhotoTagsContainerDimensions(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvPhoto);if(e){_||(_=e.offsetWidth);var t=e.offsetLeft,o=e.offsetTop;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvPhotoTagsContainer,{top:o+"px",left:t+"px",width:_+"px"})}},updateTagFrameDimensions(_,e,t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvPhoto);if(o){var i=o.offsetLeft,r=o.offsetTop;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvTagFaded,{width:cur.pvPhWidth+"px",height:cur.pvPhHeight+"px",left:i+"px",top:r+"px"}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvTagFrame,{left:i+"px",top:r+"px"}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvTagPerson,{left:i+"px",top:r+"px"}),_&&e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvTagFrame),{width:_,height:e,marginTop:intval(t)})}},afterShow(){cur.pvPhoto.href="/photo"+cur.pvCurPhoto.id,cur.pvPhoto.focus(),4&cur.pvCurPhoto.actions.edit&&1&cur.pvCurPhoto.actions.edit&&!cur.pvCurPhoto.desc&&Photoview.editInline(),cur.pvTagFrame.innerHTML='<img src="'+(cur.pvCurData.src||"/images/blank.gif")+'" />',Photoview.updateTagFrameDimensions(),(cur.pvOptions||{}).scroll&&(layerWrap.scrollTop=cur.pvOptions.scroll,cur.pvOptions.scroll=0),Photoview.updateLoc(),Photoview.updatePhotoDimensions()},pvCanvasUpdate(_){var e=cur.pvCurData;if(cur.pvCanvas&&e&&e.width&&e.height){cur.pvScrWidth=cur.pvCanvas.offsetWidth,cur.pvScrHeight=cur.pvCanvas.offsetHeight;var t,o=e.width||604,i=e.height||453,r=cur.pvScrWidth/o,a=ge("pv_fs_img_fade")||ge("pv_fs_img_wrap"),l=a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(a);i*r>cur.pvScrHeight&&(r=cur.pvScrHeight/i),r>1.25&&(r=1.25),o=Math.floor(o*r),i=Math.floor(i*r),t=Math.floor((cur.pvScrHeight-i)/2),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(l,"ZPhotosRestriction--geo",!!e.restrictionGeo),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(l,"ZPhotosRestriction--blur",Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(e));var s="";s=e.restrictionGeo?`<div class="ZPhotosRestriction__title">${e.restrictionText||" "}</div>`:Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.e)(e)?`<div class="ZPhotosRestriction__title">${e.restrictionTitle||" "}</div>`:"",l.innerHTML!==s&&(l.innerHTML=s),(cur.pvFSWidth!=o||cur.pvFSHeight!=i||cur.pvFSTop!=t||_)&&(cur.pvFSWidth=o,cur.pvFSHeight=i,cur.pvFSTop=t,l&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(l,{marginTop:t,width:o,height:i}),l.style.backgroundImage=`url('${e.src}')`))}},pvCanvasSet(){var _=cur.pvCurData;if(cur.pvCanvas&&_){var e,t=vkImage(),o=()=>{ge("pv_fs_img_fade")&&(re("pv_fs_img_wrap"),ge("pv_fs_img_fade").id="pv_fs_img_wrap")};o(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(ge("pv_fs_img_wrap"))&&cur.pvSlideNeedAnimation?(cur.pvSlideNeedAnimation=!1,cur.pvCanvas.insertBefore(se(`<div id="pv_fs_img_fade"><div style="background-image: url('${_.src}')" /></div>`),ge("pv_fs_img_wrap")),e=()=>{cssAnim(ge("pv_fs_img_wrap"),{opacity:0},{duration:1e3},()=>{o(),Photoview.fullscreenOnLoad()}),cssAnim(ge("pv_fs_img_fade"),{opacity:1},{duration:1e3})}):(val(ge("pv_fs_img_wrap"),`<div style="background-image: url('${_.src}')" /></div>`),e=Photoview.fullscreenOnLoad),Photoview.pvCanvasUpdate(!0),t.onload=e,t.src=_.src,_web_photos_fullscreen_pv__WEBPACK_IMPORTED_MODULE_11__.a.updateInfo()}},updateLoc(){var _,e=cur.pvListId;cur.pvRoot?(_={0:"photo"+cur.pvCurPhoto.id},"photos"==e.substr(0,6)?_.all=1:"tag"==e.substr(0,3)?_.tag=intval(e.substr(3)):"newtag"==e.substr(0,6)&&(_.newtag=intval(e.substr(6))),-1!=e.indexOf("/rev")&&(_.rev=1),Object(_internal_nospam_common__WEBPACK_IMPORTED_MODULE_21__.isClaimContent)()&&(_.claim=window.nav.objLoc.claim,_.dmcah=window.nav.objLoc.dmcah)):_=extend(nav.objLoc,{z:"photo"+cur.pvCurPhoto.id+"/"+(cur.pvCurPhoto.list_override||e)}),nav.strLoc!=nav.toStr(_)&&(cur.pvNoHistory||++cur.pvHistoryLength,nav.setLoc(_),(cur.pvOptions||{}).fromQueue&&(cur.pvNoHistory=!0,cur.pvHistoryLength=0)),cur.pvOptions&&(cur.pvOptions.fromQueue=!1)},canFullscreen(){var _=browser,e=floatval(browser.version);return!_.mobile&&(document.fullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||_.safari&&e>5)},fullscreenOnLoad(){_web_photos_fullscreen_pv__WEBPACK_IMPORTED_MODULE_11__.a.slide()},fullscreenEnd(_){var e=cur.pvCanvas;e&&(cleanElems(e),re(e),clearTimeout(cur.pvFSTimer),clearTimeout(cur.pvFSControlsTimer),cur.pvCanvas=cur.pvFSControls=cur.pvFSTimer=cur.pvFSControlsTimer=!1,removeEvent(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange webkitfullscreenerror mozfullscreenerror fullscreenerror"),show(pageNode),cur.pvCanvasUpdateTO&&clearInterval(cur.pvCanvasUpdateTO),void 0!==cur.pvScrWasY&&(scrollToY(cur.pvScrWasY,0),delete cur.pvScrWasY),!0!==_&&(Photoview.updateSize(),Photoview.show(cur.pvListId,cur.pvIndex)))},fullscreen(_){if(!cur.pvCanvas&&!cur.pe){var e=cur.pvCanvas=bodyNode.appendChild(ce("div",{className:"fixed",id:"pv_fullscreen",innerHTML:'<div id="pv_fs_img_wrap"></div>'})),t=e.requestFullscreen||e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen;cur.pvFinishing=!1,_web_photos_fullscreen_pv__WEBPACK_IMPORTED_MODULE_11__.a.init(),addEvent(document,"webkitfullscreenchange mozfullscreenchange MSFullscreenChange fullscreenchange",Photoview.onFullscreen),addEvent(document,"webkitfullscreenerror mozfullscreenerror MSFullscreenError fullscreenerror",Photoview.fullscreenEnd.pbind(!0));try{t.call(e)}catch(_){cur.pvPartScreen=!0,Photoview.onFullscreen()}return cancelEvent(_)}},fullscreenStop(_){cur.pvFinishing=!0===_,cur.pvPartScreen=!1;var e=document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitCancelFullScreen;try{e.call(document)}catch(_){Photoview.onFullscreen()}setTimeout(Photoview.fullscreenEnd,30)},onFullscreen(){Object(_web_lib_utils__WEBPACK_IMPORTED_MODULE_26__.h)()?(cur.pvTagger&&_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag(),cur.pvScrWidth=cur.pvCanvas.offsetWidth,cur.pvScrHeight=cur.pvCanvas.offsetHeight,cur.pvScrWasY=scrollGetY(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(pageNode),cur.pvCanvasUpdateTO=setInterval(Photoview.pvCanvasUpdate.pbind(!1),100),cur.pvFinishing||(Photoview.updateSize(),Photoview.show(cur.pvListId,cur.pvIndex))):Photoview.fullscreenEnd(cur.pvFinishing)},showDD(_,e){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.ab)(_,"pv_report_blocked")&&e&&(clearTimeout(cur.hideShareTimer),_.blur(),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.ab)(e,"pv_dd_hiding"))){if(isVisible(e))return fadeIn(e,0);cur.ddShown&&Photoview.hideDD(0),cur.ddShown=e,setTimeout(addEvent.pbind(document,"click",Photoview.hideDD),1),show(e)}},hideDD(_){if(_>0)cur.hideShareTimer=setTimeout(Photoview.hideDD.pbind(0),_);else{var e=cur.ddShown;e&&(-1==_?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(e):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(e,"pv_dd_hiding"),fadeOut(e,200,()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(e,"pv_dd_hiding")})),removeEvent(document,"click",Photoview.hideDD),cur.ddShown=!1)}},createDD:(_,e)=>`\n      <div onmouseover="Photoview.showDD(this.previousSibling, this);" onmouseout="Photoview.hideDD(500)" onclick="Photoview.hideDD(-1)" class="pvs_dd fixed">\n        <table cellspacing="0" cellpadding="0">\n          <tr>\n            <td class="pvs_side_sh">\n              <div class="pvs_side_sh_el"></div>\n            </td>\n            <td>\n              <div class="pvs_header_wrap">\n                <div class="pvs_header">\n                  <span class="pvs_header_text">${e}</span>\n                </div>\n              </div>\n              <div class="pvs_acts">${_}</div>\n              <div class="pvs_sh1"></div>\n              <div class="pvs_sh2"></div>\n            </td>\n            <td class="pvs_side_sh">\n              <div class="pvs_side_sh_el"></div>\n            </td>\n          </tr>\n        </table>\n       </div>\n    `,report(_,e){var t=cur.pvCurPhoto.id.split("_"),o=()=>{var _=ge("pv_more_act_spam");val(_,getLang("global_report_sent")),re(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_more_acts_hidden")),cur.pvMoreActionsTooltip.updatePosition(),cur.pvMoreActionsTooltip.show()};stManager.add([jsc("web/reports.js"),"reports.css"],()=>{window.showReportReasonDescriptionPopup("photo",parseInt(t[0]),parseInt(t[1]),parseInt(e),_,o)})},showShare(){clearTimeout(cur.hideShareTimer);var _=ge("pvs_dd");if(ge("pv_share").blur(),isVisible(_))return fadeIn(_,0);setTimeout(addEvent.pbind(document,"click",Photoview.hideShare),1),show(_)},hideShare(_){if(_>0)cur.hideShareTimer=setTimeout(Photoview.hideShare.pbind(0),_);else{var e=ge("pvs_dd");e&&(-1==_?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(e):fadeOut(e,200),removeEvent(document,"click",Photoview.hideShare))}},savePhoto(){var _=cur.pvListId,e=cur.pvData[_][cur.pvIndex];ajax.post("al_photos.php",{act:"save_me",photo:e.id,list:_,hash:e.hash},{onDone:()=>{var _=document.getElementById("pv_save_to_me");domPN(_).replaceChild(ce("div",{className:"pv_save_to_me_saved",innerHTML:getLang("photos_pv_act_save_saved")}),_),e.actions.save=0},onFail:_=>(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_23__.d)(getLang("global_error"),_),!0)})},sendPhoto(){var _=cur.pvListId,e=cur.pvIndex,t=cur.pvData[_][e];showBox("like.php",{act:"publish_box",object:"photo"+t.id,list:_,to:"mail"},{stat:["page.js","page.css","wide_dd.js","wide_dd.css",jsc("web/sharebox.js")]})},moveToAlbumBox:(_,e,t)=>!showBox("al_photos.php",{act:"a_move_to_album_box",photo_id:_+"_"+e,owner_id:_,from:t},{stat:["page.js","page.css","wide_dd.js","wide_dd.css"]}),moveToAlbum(_,e,t){ajax.post("al_photos.php",{act:"a_move_photo",photo:_,album_id:e,hash:t},{onDone:_=>{curBox().hide();var e=ge("pv_album_name");e&&(e.innerHTML=_),cur.pvCurPhoto.album=_,showDoneBox('<div class="pv_done_box">'+getLang("photos_move_to_album_success").replace("{album}",_)+"</div>")}})},setTags(_){Photoview.hideTag(),_?(show(cur.pvTags),window.tooltips&&each(geByClass("delete",cur.pvTags),()=>{tooltips.destroy(this)}),cur.pvTags.innerHTML=getLang("photos_onthisphoto")+": "+_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvTags)},preload(_,e){window.updateWndVScroll&&updateWndVScroll();var t=cur.pvListId,o=((cur.pvData||{})[t]||{}).length;if(o){var i=cur.pvVeryBig>2?"w":cur.pvVeryBig?"z":"y",r=cur.pvVeryBig>1||cur.pvVeryBig?"z":"y",a=cur.pvVeryBig>1?"z":cur.pvVeryBig?"y":"x",l=cur.pvVeryBig>1?"y":cur.pvVeryBig?"x":0;cur.pvLastFrom=_,cur.pvLastDirection=e;for(var s=Photoview.allSizes,n=0;n<Math.min(Photoview.cacheSize,o-Photoview.cacheSize);++n){for(var c=_+(n+1)*-e;c>=o;)c-=o;for(;c<0;)c+=o;var d=cur.pvData[t][c];if(d)for(var b=0,p=s.length;b<p;++b){var u=s[b];d[u]&&d[u].src&&(d[u].src=Photoview.blank,delete d[u])}}var E=function(s){for(var n=_+(s+1)*e;n>=o;)n-=o;for(;n<0;)n+=o;var c=cur.pvData[t][n];return c&&c.id?c[i]?"continue":c[i+"_src"]?(c[i]=vkImage(),c[i].src=c[i+"_src"],"continue"):(c[i]=1,c[r]?"continue":c[r+"_src"]?(c[r]=vkImage(),c[r].src=c[r+"_src"],"continue"):(c[r]=1,c[a]?"continue":c[a+"_src"]?(c[a]=vkImage(),c[a].src=c[a+"_src"],"continue"):(c[a]=1,c[l]?"continue":c[l+"_src"]?(c[l]=vkImage(),c[l].src=c[l+"_src"],"continue"):(c[l]=1,c.x?"continue":(c.x=vkImage(),void(c.x.src=c.x_src)))))):((!c||vkNow()-c>3e3)&&(cur.pvData[t][n]=vkNow(),setTimeout(()=>{ajax.post("al_photos.php",{act:"show",gid:cur.gid,list:t,offset:Photoview.realOffset(t,n,-1),direction:e},{onDone:Photoview.loaded})},10)),"break")};_:for(var O=0;O<Photoview.cacheSize;++O){switch(E(O)){case"break":break _;case"continue":continue}}}},hide(_,e){if(Photoview.hideTag(!0),cur.pvShown&&(!__afterFocus||!0===e)){if(cur.pvCanvas&&Photoview.fullscreenStop(!0),cur.prevPhotoWidth=cur.prevPhotoHeight=0,(cur.pvJumpTo||{}).z=="albums"+val("pva_owner")&&!cur.pvAlbumsShown&&0===_)return Photoview.jumpToAlbums(!0);if((cur.pvJumpTo||{}).z=="album"+val("pvsa_album")&&!cur.pvAlbumShown&&0===_)return Photoview.jumpToAlbum(!0);if((cur.pvJumpTo||{}).z=="tag"+val("pvsa_tag")&&!cur.pvPhotoTagShown&&0===_)return Photoview.jumpToTagged(!0);if("temp"==cur.pvListId)cur.pvCancelLoad();else if(!cur.pvNoHistory&&!_&&cur.pvHistoryLength>0&&cur.pvHistoryLength<10)return cur.pvNoHistory=!0,__adsUpdate("very_lazy"),cur.pvBodyScrollTop=bodyNode.scrollTop,history.go(-cur.pvHistoryLength);var t;if(!0!==_&&!layerQueue.count())cur.pvRoot?("newtag"==cur.pvListId.substr(0,6)?(t="albums"+vk.id+"?act=added",-1!=cur.pvListId.indexOf("/rev")&&(t+="&rev=1")):t=cur.pvListId.replace(/^photos/,"albums").replace("/rev","?rev=1"),nav.setLoc(t)):delete(t=clone(nav.objLoc)).z,nav.strLoc!=nav.toStr(t)&&nav.setLoc(t),__adsUpdate("very_lazy");window.__pvhideTimer=setTimeout(Photoview.doHide.pbind(cur),0),__adsUpdate(),cur.pvAlbumsShowing=cur.pvAlbumsShown=!1,cur.pvAlbumShowing=cur.pvAlbumShown=!1,cur.pvPhotoTagShowing=cur.pvPhotoTagShown=!1,cur.pvVideoTagShowing=cur.pvVideoTagsShown=!1}},doHide(_){void 0!==cur.pvBodyScrollTop&&(bodyNode.scrollTop=cur.pvBodyScrollTop,delete cur.pvBodyScrollTop),cur.pvTaggerTooltip&&(cur.pvTaggerTooltip.unMount(),delete cur.pvTaggerTooltip),_.pvHistoryLength=0,cur.pvTagger&&_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag(),cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),_.pvFriends&&(cleanElems("pv_add_tag","pv_cancel_tag",_.pvFriends.firstChild.firstChild,_.pvFriends),re(_.pvFriends),_.pvFriends=_.pvFriendName=!1),_web_page_wall__WEBPACK_IMPORTED_MODULE_20__.a.cancelEdit(!0);var e=Photoview.allSizes,t=_.pvListId,o=((_.pvData||{})[t]||{}).length;if(_.pvLastDirection&&o){for(var i=0;i<Photoview.cacheSize;++i){for(var r=_.pvLastFrom+(i+1)*_.pvLastDirection;r>=o;)r-=o;for(;r<0;)r+=o;var a=_.pvData[t][r];if(a)for(var l=0,s=e.length;l<s;++l){var n=e[l];a[n]&&a[n].src&&(a[n].src=Photoview.blank,delete a[n])}}_.pvLastDirection=_.pvLastFrom=!1}if(cur.pvYourComment=re(cur.pvYourComment),layers.hide(),layers.fullhide=!1,delete cur.pvLayerCreated,window.tooltips&&tooltips.destroyAll(cur.pvBox),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(layerWrap,"pv_layer_wrap"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(layerBG,"pv_layer"),layerBG.style.opacity="",_.pvShown=_.pvListId=_.pvClicked=!1,removeEvent(window,"resize",Photoview.onResize),removeEvent(document,"keydown",Photoview.onKeyDown),removeEvent(layerWrap,"click",Photoview.onLayerClick),removeEvent(layerWrap,"scroll",Photoview.scrollResize),removeEvent(layerWrap,"mousemove",Photoview.onLayerMouseMove),cur.pvOptions){var c=cur.pvOptions.onHide;cur.pvOptions.onHide=!1,c&&c()}if(layerQueue.pop(),Photoview.destroyPeriod(),_.pvPreloaded&&_===cur){for(var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("photos_container"),b=ce("div",{innerHTML:_.pvPreloaded});b.firstChild;)d.appendChild(b.firstChild);d.qsorter&&setTimeout(qsorter.added.pbind(d),0),_.pvPreloaded=!1}_web_legacy_ui_ui_scroll_box__WEBPACK_IMPORTED_MODULE_19__.a.hide(),Photoview.toggleFastChats(!0),delete cur.pvEditorMode,delete cur.pvEditorModeDimensionsUpdated,cur.pvPhotoTags&&(cur.pvPhotoTags.unMount(),delete cur.pvPhotoTags)},editPhoto(){},descTT:_=>Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_24__.c)(_,{text:getLang("photos_edit_desc"),black:1,shift:[-160,13,0],showdt:0,appendParentCls:"narrow_column"}),editInline(_){if("A"!=((_||window.event||{}).target||{}).tagName&&!cur.pvEditing){window.tooltips&&window.tooltips.hideAll();var e=cur.pvListId,t=cur.pvIndex,o=cur.pvData[e][t],i=_=>{if(cur.pvShown&&cur.pvListId==e&&cur.pvIndex==t&&!cur.pvEditing){cur.pvEditing=[e,t];var o=ge("pv_caption_warn"),i=getLang("photos_edit_desc_intro"),r=cur.pvDesc.appendChild(ce("div",{innerHTML:`\n          <textarea\n            class="dark"\n            id="pv_edit_text"\n            onkeydown="onCtrlEnter(event, Photoview.saveInline)"\n            onkeyup="checkTextLength(cur.pvCaptionLimit, this, ${o});"\n            placeholder="${i}"\n          >${_}</textarea>\n          <div id="pv_caption_warn"><div>`},{display:"none"})),a=ge("pv_edit_text");autosizeSetup(a,{minHeight:21,maxHeight:350}),setTimeout(()=>{show(r),elfocus(a),addEvent(a,"blur",Photoview.saveInline),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvDesc.firstChild),cur.pvNarrowScrollbar.scrollTop(0)},1)}};!o.desc?i(""):ajax.post("al_photos.php",{act:"edit_desc",photo:o.id},{onDone:i,progress:cur.pvProgress})}},cancelInline(){cur.pvEditing=!1,removeEvent(ge("pv_edit_text"),"blur"),show(cur.pvDesc.firstChild),re(cur.pvDesc.firstChild.nextSibling)},saveInline(){if(cur.pvEditing){removeEvent(ge("pv_edit_text"),"blur");var _=cur.pvEditing[0],e=cur.pvEditing[1],t=cur.pvData[_][e],o=trim(val("pv_edit_text"));if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_desc_edit",cur.pvDesc)&&!o)return Photoview.cancelInline();ajax.post("al_photos.php",{act:"save_desc",photo:t.id,hash:t.hash,text:o},{onDone:o=>{if(t.desc=o,cur.pvShown&&_==cur.pvListId&&e==cur.pvIndex){cur.pvEditing=!1;var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvDesc);val(i,o||'<span class="pv_desc_edit">'+getLang("photos_edit_desc")+"</span>"),i.onmouseover=o?Photoview.descTT.pbind(i):()=>{},show(i),re(domNS(i))}},progress:cur.pvProgress})}},cmp(_,e){var t=_.length,o=e.length;return t<o?-1:t>o?1:_<e?-1:_>e?1:0},receiveComms(_,e,t,o,i,r){if(_==cur.pvListId&&e==cur.pvIndex){for(var a=ce("div",{innerHTML:t}),l=ge("pv_comments_list"),s=domLC(l),n=getXY(d,!0)[1],c=cur.pvData[_][e],d=s,b=domLC(a);b;b=domLC(a)){for(c.actions.comm&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(b,"reply_replieable");d&&Photoview.cmp(d.id,b.id)>0;)d=domPS(d);d&&!Photoview.cmp(d.id,b.id)?(l.replaceChild(b,d),d=b):(d&&domNS(d)?l.insertBefore(b,domNS(d)):!d&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(l)?!0===i?(--c.commshown,a.removeChild(b)):l.insertBefore(b,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(l)):l.appendChild(b),++c.commshown)}r&&s&&(layerWrap.scrollTop+=getXY(s,!0)[1]-n),cur.pvCommsLikes[c.id][0]=ge("pv_comments"),extend(cur.pvReplyNames,o),Photoview.updateComms()}},commSaved(_){if(cur.pvShown){var e=ge("pv_comments"),t=!!e&&cur.pvData[cur.pvListId][cur.pvIndex],o=_.match(/^(-?\d+)photo(_\d+)/);t&&o&&ge("pv_comment"+o[1]+o[2])&&(cur.pvCommsLikes[t.id][0]=e)}},comments(_){if(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(ge("pv_comments")).id||"";if(!isVisible("pv_comments_header")||Photoview.cmp(e,"pv_comment"+_)<0)return}var t=cur.pvListId,o=cur.pvIndex,i=cur.pvData[t][o],r=ge("pv_comments_header");ajax.post("al_photos.php",{act:"photo_comments",offset:i.commshown,photo:i.id,list_id:cur.pvListId},{onDone:(e,i)=>{Photoview.receiveComms(t,o,e,i,!1,_),_&&ge("pv_comment"+_)&&Photoview.showComment(_)},showProgress:function(_){function e(){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}(()=>{r.innerHTML="",showProgress(r)}),hideProgress:function(_){function e(){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}(()=>{hideProgress(r)})})},updateComms(_){var e=cur.pvData[cur.pvListId][cur.pvIndex],t=ge("pv_comments_header"),o="";e.commcount>e.commshown&&(o=getLang("photos_show_prev_comments",e.commcount-e.commshown)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(ge("pv_comments_list"),"unshown",!_&&0==e.commcount),toggle(t,o),toggle(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_no_commments_placeholder"),0==e.commcount&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("_post_content",cur.pvBox)),t.innerHTML=o},commentChanged(){checkTextLength(cur.pvCommLimit,cur.pvComment),cur.pvCommenting=cur.pvData[cur.pvListId][cur.pvIndex].id},updateRightBlock(_){function e(){var _=getSize(cur.pvLeftWrap)[1]-(cur.pvReplyForm?getSize(cur.pvReplyForm)[1]:0);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvNarrow,"height",_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pv_no_commments_placeholder_wrap");if(e&&(isVisible(e.children[0])||isVisible(e.children[1]))){var t=getSize(e)[1],o=getSize("pv_comments_list")[1],i=_-ge("pv_comments").offsetTop-o;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(e,"margin-top",Math.max(0,i/2-t/2))}}e(),clearTimeout(cur.pvRightBlockUpdateTO),cur.pvRightBlockUpdateTO=setTimeout(e)},getReplyAsGroupEl:()=>ge("pv_reply_as_group"),sendComment(_,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=cur.pvListId,i=cur.pvIndex,r=cur.pvData[o][i],a=ge("reply_field"+_),l=a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.l)(a,"composer"),s=(cur.pvReplyNames[(cur.reply_to||{})[0]]||[])[1],n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("addpost_button",cur.pvReplyForm),c={},d=t.stickerId;if(d)c={message:"",attach1_type:"sticker",attach1:d,sticker_referrer:t.sticker_referrer};else{if((c=l?Composer.getSendParams(l,Photoview.sendComment.pbind(_)):{message:trim(Emoji.editableVal(a))}).delayed)return;if(!c.attach1_type&&(!c.message||s&&!s.indexOf(c.message)))return void Emoji.editableFocus(a,!1,!0)}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)("reply_warn"+_);var b=Photoview.getReplyAsGroupEl();ajax.post("al_photos.php",_web_page_wall__WEBPACK_IMPORTED_MODULE_20__.a.fixPostParams(extend(c,{act:"post_comment",photo:r.id,hash:r.hash,from_group:b&&domData(domClosest("_submit_post_box",ge(b)),"from-oid")<0?1:"",reply_to:(cur.reply_to||{})[1]})),{onDone:(t,s)=>{++r.commcount,Photoview.receiveComms(o,i,t,s,!0),d||(l?Composer.reset(l):Emoji.val(a,"")),a.autosize&&a.autosize.update(),browser.mobile?_web_page_wall__WEBPACK_IMPORTED_MODULE_20__.a.hideEditReply(_):(Emoji.editableFocus(a,!1,!0),_web_page_wall__WEBPACK_IMPORTED_MODULE_20__.a.cancelReplyTo(_,e)),re("reply_link"+_),_web_page_wall__WEBPACK_IMPORTED_MODULE_20__.a.hideEditPostReply(null,!0),cur.pvNarrowScrollbar&&cur.pvNarrowScrollbar.scrollBottom(),Photoview.updateRightBlock()},showProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(n)},hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(n)}})},highlightComment(_){if(_=ge(_)){var e=getXY(_,!0)[1],t=animate.pbind(_,{backgroundColor:"#ECEFF3"},200,()=>{setTimeout(()=>{animate(_,{backgroundColor:"#FFF"},200,()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(_,{backgroundColor:""})})},1e3)});e<0||e>lastWindowHeight-200?animate(layerWrap,{scrollTop:layerWrap.scrollTop+e-50},300,t):t()}},showComment(_){var e=ge("pv_comment"+_);return e?Photoview.highlightComment(e):Photoview.comments(_),!1},commDone(node,text,del,script){if(node){var fc=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(node),msg=domNS(fc),ph=null!=cur.pvListId&&null!=cur.pvIndex&&cur.pvData[cur.pvListId][cur.pvIndex];if(!text)return show(fc),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(msg),void(ph?(++ph.commcount,++ph.commshown,Photoview.updateComms()):window.photos&&cur.offset&&_web_photos_photos__WEBPACK_IMPORTED_MODULE_10__.a.recache(cur.offset,1));if(msg?(msg.innerHTML=text,show(msg)):node.appendChild(ce("div",{innerHTML:text})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(fc),del&&(ph?(--ph.commshown,--ph.commcount,Photoview.updateComms(del)):window.photos&&cur.offset&&_web_photos_photos__WEBPACK_IMPORTED_MODULE_10__.a.recache(cur.offset,-1)),ph&&(cur.pvCommsLikes[ph.id][0]=ge("pv_comments")),script)try{eval(script)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_14__.d)(_,script)}}},commProgress(_,e){var t=ge("pv_actions"+_);if(t){var o=t.firstChild.nextSibling;if(!0!==e)return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(o),void show(t.firstChild);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(t.firstChild),o||(o=t.appendChild(ce("div",{className:"progress"}))),show(o)}},commParams:(_,e)=>({onDone:Photoview.commDone.pbind(_,e),progress:"pv_progress"+_+e,stat:[jsc("web/privacy.js"),"privacy.css"]}),commAction(_,e,t,o){var i=gpeByClass("reply",e),r=gpeByClass("post_actions",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.ab)(i,"post_actions_progress")||ajax.post("al_photos.php",{act:_+"_comment",comment:t,hash:o},{onDone:Photoview.commDone.pbind(i),showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c.pbind(r,"post_actions_progress"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb.pbind(r,"post_actions_progress")})},_isOverLayer:_=>_.target==layer||_.target==cur.pvCont,_isOverLayerLeft(_){if(Photoview._isOverLayer(_)){var e=getXY(cur.pvBox),t=getSize(cur.pvBox);return _.pageX<e[0]&&_.pageY>e[1]&&_.pageY<e[1]+t[1]}},onLayerMouseMove(_){if(Photoview._isOverLayer(_)){var e=Photoview._isOverLayerLeft(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(layerWrap,"pv_left_panel_over",e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvNavBtnLeft,"pv_nav_btn_show",e)}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(layerWrap,"pv_left_panel_over")},onLayerClick(_,e){if(Photoview._isOverLayer(_)&&Photoview._isOverLayerLeft(_))return Photoview.show(!1,cur.pvIndex-1,_);Photoview._doLayerClick(_,e)},_doLayerClick(_,e){if(cur.pvClicked&&!e||__afterFocus||_&&cur.__mdEvent&&_.target!=cur.__mdEvent.target)cur.pvClicked=!1;else if(!_||2!=_.button&&3!=_.which&&!_.pvHandle){_&&(_.pvHandle=!0);var t=_.pageX,o=_.pageY;if(null==t&&null!=_.clientX){var i=document.documentElement,r=bodyNode;t=_.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i.clientLeft||0),o=_.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i.clientTop||0)}var a=Math.abs(t-intval(cur.pvOldX)),l=Math.abs(o-intval(cur.pvOldY));(a>3||l>3)&&vkNow()-intval(cur.pvOldT)>300&&(cur.pvTagger?_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag():cur.pvEditorMode?_.target!=layerWrap&&_.target!=layer||SPE.attemptHide(()=>{Photoview.hide(0)}):Photoview.hide(0))}},onKeyDown(_){if(!1===_.returnValue)return!1;if((!window.SPE||!window.SPE.editor)&&inArray(_.keyCode,[KEY.DOWN,KEY.UP])&&cur.pvNarrowScrollbar&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.ab)(_.target,"reply_field"))return cur.pvNarrowScrollbar.scrollBy(_.keyCode==KEY.DOWN?70:-70),cancelEvent(_);if(_.keyCode==KEY.ESC&&cur.pvEditing)return Photoview.cancelInline(),cancelEvent(_);_.altKey&&_.keyCode==KEY.RETURN&&Photoview.canFullscreen()&&(cur.pvCanvas?Photoview.fullscreenStop():Photoview.fullscreen()),_.keyCode==KEY.SPACE&&cur.pvCanvas&&(_web_photos_fullscreen_pv__WEBPACK_IMPORTED_MODULE_11__.a.startSlide(),_web_photos_fullscreen_pv__WEBPACK_IMPORTED_MODULE_11__.a.showControls(!0));var e=_.target.contentEditable;return!!(window.Emoji&&Emoji.shown||_.target&&("INPUT"==_.target.tagName||"TEXTAREA"==_.target.tagName||"DIV"==_.target.tagName&&e&&"inherit"!=e))||(_.keyCode==KEY.ESC?(cur.pvCanvas?Photoview.fullscreenStop():cur.pvTagger?_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag():_.vkCanceled||curBox()||(cur.pvEditorMode?SPE.attemptHide(()=>{Photoview.hide(0)}):Photoview.hide(0)),cancelEvent(_)):(cur.pvTagger||boxQueue.count()||cur.pvComment&&cur.pvComment.focused||_.ctrlKey||(_.keyCode==KEY.RIGHT?Photoview.show(cur.pvListId,cur.pvIndex+1):_.keyCode==KEY.LEFT&&Photoview.show(cur.pvListId,cur.pvIndex-1)),!cur.pvCanvas&&void 0))},updateVerticalPosition(_){if(cur.pvCont){var e=getSize(cur.pvCont),t=window.clientHeight()/2-e[1]/2-intval(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(layer,"margin-top",Math.round(t))}},calculateVeryBig(){var _=Math.max(document.documentElement.clientWidth,window.innerWidth||0);cur.pvVeryBig=_>1800?3:_>1200?2:_>800&&1,window.devicePixelRatio>1&&(cur.pvVeryBig+=1,cur.pvVeryBig=Math.min(3,cur.pvVeryBig))},updateNavBtnsLeftThreshold(_){var e=getSize(cur.pvImageWrap)[0],t=getXY(cur.pvImageWrap)[0];cur.pvLeftBtnAmount&&!_||(cur.pvLeftBtnAmount=t+Photoview.LEFT_RIGHT_NAV_RATIO*e)},updatePhotoDimensions(_){if(!Photoview.isPhotosList()&&!cur.pvEditorModeDimensionsUpdated){var e=Photoview.MIN_WIDTH,t=Photoview.MIN_HEIGHT;cur.pvEditorMode&&(e=Photoview.PE_MIN_WIDTH,t=Photoview.PE_MIN_HEIGHT,cur.pvEditorModeDimensionsUpdated=!0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(cur.pvBottomInfo,"pv_with_line_break");var o=isVisible(cur.pvTagInfo),i=o?getSize(cur.pvTagInfo)[1]:0,r=Math.max(document.documentElement.clientWidth,window.innerWidth||0),a=Math.max(document.documentElement.clientHeight,window.innerHeight||0),l=getSize(cur.pvBottomInfo)[1],s=Math.max(e,r-Photoview.SIDE_COLUMN_WIDTH-2*Photoview.SIDE_MIN_GAP),n=Math.max(t,a-l-2*Photoview.VERTICAL_MIN_GAP-i);Photoview.calculateVeryBig();var c=clone(cur.pvCurData||{width:e,height:t});c.width=c.width||e,c.height=c.height||t;var d=c.width/c.height,b=Math.min(s,c.width),p=b/d;p=Math.min(n,p),b=Math.ceil(p*d);var u=getXY(cur.pvBottomLeft)[0]+getSize(cur.pvBottomLeft)[0]>getXY(cur.pvBottomActions)[0]-20;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvBottomInfo,"pv_with_line_break",u),_&&(cur.prevPhotoWidth=cur.prevPhotoHeight=0);var E=cur.prevPhotoWidth=Math.max(b,e,cur.prevPhotoWidth||0),O=cur.prevPhotoHeight=Math.max(p,t,(cur.prevPhotoHeight||0)-i),h=Math.max(0,O/2-p/2);if(h>0&&!o){var w=(getSize(cur.pvPhoto)[1]+l)/2-p/2;w>l&&(h=w)}cur.pvAttachedProducts.photoSize={width:b,height:p,top:h},Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvPhoto,{width:E,height:O}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(cur.pvPhoto),{width:b,height:p,marginTop:h}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvTagInfo,{width:E}),cur.pvTagFrame&&Photoview.updateTagFrameDimensions(b,p,h),cur.pvPhotoTagsContainer&&Photoview.updatePhotoTagsContainerDimensions(b),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvImgProgress,"marginTop",h+p/2);var v=(cur.pvIsLightMode?0:Photoview.SIDE_COLUMN_WIDTH)+E;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvCont,{width:v,paddingLeft:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.t)()}),Photoview.updateRightBlock(),Photoview.updateVerticalPosition(),cur.pvPhWidth=b,cur.pvPhHeight=p,Photoview.updateNavBtnsLeftThreshold();var m=getXY(cur.pvCont),P=getSize(cur.pvCont),D=m[1]+P[1],M=r-(m[0]+P[0])<85||a-D<60;Photoview.toggleFastChats(!M)}},toggleFastChats(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)("chat_onl_wrap","hidden",!_),each(geByClass("rb_box_wrap"),()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(this,"hidden",!_)})},onResize(){if(cur.pvCanvas){var _=cur.pvVeryBig,e=cur.pvCanvas.offsetWidth,t=cur.pvCanvas.offsetHeight;return cur.pvVeryBig=e>1280||t>1280?2:(e>807||t>807)&&1,void(_!=cur.pvVeryBig&&setTimeout(Photoview.preload.pbind(cur.pvIndex,cur.pvLastDirection||1),10))}if(cur.pvAlbumsShown||cur.pvAlbumShown||cur.pvPhotoTagShown?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvCont,"width",800):Photoview.updatePhotoDimensions(!0),cur.pvPhoto){if(browser.mozilla&&cur.pvPhoto.firstChild){var o=cur.pvPhoto.firstChild.offsetLeft,i=(lastWindowWidth-cur.pvActualWidth)%2&&(cur.pvActualWidth-cur.pvPhWidth)%2?4:3;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvTagFrame,{left:o-i+"px"})}Photoview.scrollResize(),Photoview.stopTagger()}},stopTagger(){cur.pvTagger&&_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag()},updateSize(){cur.pvBox&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(cur.pvBox,"photos_is_albums_view",!!cur.pvAlbumsShown||!!cur.pvAlbumShown),onBodyResize(),Photoview.onResize()},activate(_){_&&_.timeout?(clearTimeout(_.timeout),removeAttr(_,"timeout")):isVisible(_)&&fadeTo(_,200,vk.pvdark?1:.7)},deactivate(_){_&&isVisible(_)&&!_.timeout&&(_.timeout=setTimeout(()=>{removeAttr(_,"timeout"),fadeTo(_,200,.4)},1))},deletePhoto(_){var e=cur.pvListId,t=cur.pvIndex,o=cur.pvData[e][t],i=curBox();if(cur.deletionProgress=cur.deletionProgress||{},!cur.deletionProgress[o.id])if(cur.deletionProgress[o.id]=!0,cur.pvTagger)Photoview.stopTagger();else{cur.pvPhotoTags&&cur.pvPhotoTags.hideAreas();var r={act:"delete_photo",photo:o.id,hash:o.hash,set_prev:isChecked("pvb_prev_check"),sure:intval(_)};Object(_internal_nospam_common__WEBPACK_IMPORTED_MODULE_21__.isClaimContent)()&&(r._nol=JSON.stringify(window.nav.objLoc)),ajax.post("al_photos.php",r,{onDone:(_,r)=>{if(cur.deletionProgress[o.id]=!1,i)return i.hide(),nav.go("/id0",!1,{nocur:!0});e==cur.pvListId&&t==cur.pvIndex&&(cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),Photoview.toggleTopInfoPanel(r||getLang("photo_deleted"),_),o.deleted=[cur.pvTagInfoText.innerHTML,cur.pvTagInfoButtons.innerHTML],Photoview.toggleDeletedState(!0),Photoview.updatePhotoDimensions())}})}},restorePhoto(_){var e=cur.pvListId,t=cur.pvIndex,o=cur.pvData[e][t];Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.k)(_)||ajax.post("al_photos.php",{act:"restore_photo",photo:o.id,hash:o.hash},{onDone:_=>{o.deleted=!1,e==cur.pvListId&&t==cur.pvIndex&&(cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),Photoview.toggleTopInfoPanel(!1),Photoview.toggleDeletedState(!1),Photoview.updatePhotoDimensions()),cur.pvPhotoTags&&cur.pvPhotoTags.showAreas()},onFail:_=>(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_23__.d)(getLang("global_error"),_),!0),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w.pbind(_)})},spamPhoto(_,e){var t=cur.pvListId,o=cur.pvIndex,i=cur.pvData[t][o];Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.k)(e)||(cur.pvTagger?_web_photos_photo_tagger_mode__WEBPACK_IMPORTED_MODULE_12__.a.stopTag():ajax.post("al_photos.php",{act:"spam_photo",photo:i.id,hash:i.hash,spam_hash:_,pv:1},{onDone:(_,e)=>{e&&(i.deleted=_),t==cur.pvListId&&o==cur.pvIndex&&(cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),Photoview.toggleTopInfoPanel(getLang("photo_marked_as_spam_restore"),""),e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvCommentsData))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w.pbind(e)}))},rotatePhoto(_){var e=ge("pv_rotate_progress");if(!isVisible(e)){Photoview.stopTagger(),show(e),ge("pv_rotate").appendChild(ce("div",{id:"pv_rotate_frame",className:"upload_frame",innerHTML:'<iframe name="pv_rotate_frame"></iframe>'}));var t=cur.pvListId,o=cur.pvIndex,i=cur.pvData[t][o],r=ge("pv_rotate_form");r.innerHTML="",r.action=i.rotate[0];var a=extend({act:"do_rotate",to:_,list_id:t,index:o,fid:i.id},i.rotate);if(_=(_+4)%4,"rotate_photo"==a.act&&(a.angle=(a.angle+_)%4),a["rot"+_])return a.act="done_rotate",a.complete=1,void ajax.post("/al_photos.php",a,{onDone:Photoview.rotateDone,onFail:()=>{Photoview.rotateDone()}});for(var l in a)0!=l&&r.appendChild(ce("input",{type:"hidden",name:l,value:a[l]}));r.submit()}},rotateDone(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)("pv_rotate_progress");var e=ge("pv_rotate_frame");if(e&&(re(e),_)){var t=_.list_id,o=_.index,i=cur.pvData[t][o];extend(i,{x_src:_.x_src,y_src:_.y_src,z_src:_.z_src,w_src:_.w_src,base:_.base,x_:_.x_,y_:_.y_,z_:_.z_,w_:_.w_,x:0,y:0,z:0,w:0,tags:_.tags,tagged:_.tagged,suggested_tags:_.suggested_tags,tagshtml:_.html}),extend(i.rotate,{photo:_.photo,hash:_.hash,rhash:_.rhash,angle:_.angle,rot1:_.rot1,rot3:_.rot3}),t==cur.pvListId&&o==cur.pvIndex&&Photoview.show(t,o),cur.pvPhotoTags&&cur.pvPhotoTags.reload()}},likeUpdate(_,e,t){e=intval(e);var o=ge("pv_like"),i=domByClass(o,"_count");if(i){var r=o.tt||{},a=clone(r.opts||{}),l=domByClass(r.container,"_value"),s=domByClass(r.container,"_content"),n=domByClass(r.container,"_title");t&&n&&val(n,t),r&&(r.likeInvalidated=!0),l&&(l.value=e),Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_25__.c)(i,e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(o,"pv_liked",_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(o,"no_likes",!e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.zb)(s,"me_hidden",!_),e?!r.el||isVisible(r.container)||t||tooltips.show(r.el,extend(a,{showdt:0})):r.el&&r.hide()}},tagOver(_){animate(_,{backgroundColor:"#6B8DB1"},200),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_24__.c)(_,{text:getLang("photos_delete_tag"),shift:[0,-2,0]})},tagOut(_){_.parentNode&&_.parentNode.parentNode&&animate(_,{backgroundColor:"#C4D2E1"},200)},deleteTag(_,e){var t=cur.pvListId,o=cur.pvIndex,i=cur.pvData[t][o];if(i.tagid){if(isVisible("pv_tag_handling"))return}else if(ge("pv_action_progress"))return;var r=e?1:0;ajax.post("al_photos.php",{act:"delete_tag",photo:i.id,tag:_,hash:i.hash,top_panel:r,extended:1},{onDone:(e,r,a,l)=>{i.tagid?(Object(_web_photos_photo_tag_utils__WEBPACK_IMPORTED_MODULE_30__.a)(),cur.pvPhotoTags&&cur.pvPhotoTags.dispatchEvent(_web_photos_types__WEBPACK_IMPORTED_MODULE_29__.a.DECLINE_USER_TAG,{tagId:_,photoRawId:i.id}),i.taginfo=i.tagid=!1,cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),Photoview.toggleTopInfoPanel(getLang("photos_tag_deleted"),e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(cur.pvTagInfoButtons,"no_events"),setTimeout(()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(cur.pvTagInfoButtons,"no_events")},1e3)):Photoview.actionInfo().innerHTML=e,void 0!==r&&(i.tags=r,i.tagged=a,i.tagshtml=l,cur.pvListId==t&&cur.pvIndex==o&&(Photoview.setTags(l),(!i.taginfo&&i.actions.tag&&r[0]<cur.pvMaxTags?show:_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvTagLink))),cur.pvPhotoTags&&cur.pvPhotoTags.deleteTag(_)},onFail:_=>{if(_)return Photoview.actionInfo().innerHTML=_,!0},showProgress:function(_){function e(){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}(()=>{if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(e),i.tagid);else{var _=Photoview.actionInfo();_.innerHTML="",showProgress(_)}}),hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(e),i.tagid||re(Photoview.actionInfo())}})},restoreTag(_){if(!ge("pv_action_progress")){var e=cur.pvListId,t=cur.pvIndex,o=cur.pvData[e][t];ajax.post("al_photos.php",{act:"restore_tag",photo:o.id,tag:_,hash:o.hash},{onDone:(_,i,r,a)=>{void 0!==i&&(o.tags=i,o.tagged=r,o.tagshtml=a,cur.pvListId==e&&cur.pvIndex==t&&(Photoview.setTags(a),(!o.taginfo&&o.actions.tag&&i[0]<cur.pvMaxTags?show:_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvTagLink)),cur.pvPhotoTags&&cur.pvPhotoTags.renderTagAreas()),Photoview.actionInfo().innerHTML=_},onFail:_=>{if(_)return Photoview.actionInfo().innerHTML=_,!0},showProgress:function(_){function e(){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}(()=>{var _=Photoview.actionInfo();_.innerHTML="",showProgress(_)}),hideProgress:()=>{re(Photoview.actionInfo())}})}},confirmTag(_,e){var t=cur.pvListId,o=cur.pvIndex,i=cur.pvData[t][o];isVisible("pv_tag_handling")||ajax.post("al_photos.php",{act:"confirm_tag",tag:_,photo:i.id,hash:i.hash,extended:1},{onDone:(e,r,a)=>{i.tags=e,i.tagged=r,i.tagshtml=a,i.taginfo=i.tagid=!1,cur.pvPhotoTags&&cur.pvPhotoTags.dispatchEvent(_web_photos_types__WEBPACK_IMPORTED_MODULE_29__.a.CONFIRM_USER_TAG,{tagId:_,photoRawId:i.id}),Object(_web_photos_photo_tag_utils__WEBPACK_IMPORTED_MODULE_30__.a)(),t==cur.pvListId&&o==cur.pvIndex&&(Photoview.setTags(a),(!i.taginfo&&i.actions.tag&&e[0]<cur.pvMaxTags?show:_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(cur.pvTagLink),i.suggestedTagsInfo&&!i.taginfo&&e[0]<cur.pvMaxTags?Photoview.showSuggestedInfoTopPanel(i):(cleanElems("pv_confirm_tag","pv_delete_tag","pv_prof_cancel","pv_prof_done","pv_confirm_suggested_tags","pv_decline_suggested_tags"),Photoview.toggleTopInfoPanel(!1)))},showProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(e)},hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(e)}})},confirmAllSuggestedTags(_){if(cur.pvPhotoTags){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(_);var e=Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.d)("suggested_tags"),t=Object.keys(e);cur.pvPhotoTags.confirmSuggestedTags(t,()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(_)},()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(_)})}},declineAllSuggestedTags(_){if(cur.pvPhotoTags){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(_);var e=Object(_photoview_utils__WEBPACK_IMPORTED_MODULE_27__.d)("suggested_tags"),t=Object.keys(e);cur.pvPhotoTags.declineSuggestedTags(t,()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(_)},()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(_)})}},toProfileTag(){var _=cur.pvData[cur.pvListId][cur.pvIndex].tagged[vk.id];_&&!cur.pvTagger&&Photoview.showTag(_)},showTag(_){cur.pvPhotoTags&&cur.pvPhotoTags.showTagArea(_)},showDynTag(_){if(clearTimeout(cur.pvHidingTag),cur.pvShowingTag!=_){var e=clone(cur.pvData[cur.pvListId][cur.pvIndex].tags[_]),t=ge("pv_tag"+_);if(t){each(e,(_,t)=>{e[_]=positive(t*cur[_%2?"pvPhHeight":"pvPhWidth"]/100)});var o=0;isVisible(cur.pvTagInfo)&&(o=getSize(cur.pvTagInfo)[1]),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvTagPerson,{marginLeft:e[0]+"px",marginTop:o+e[3]+"px",minWidth:e[2]-e[0]+"px"}),cur.pvTagPerson.innerHTML=t.firstChild.innerHTML;var i=getSize(cur.pvTagPerson);e[3]+i[1]>cur.pvPhHeight&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(cur.pvTagPerson,{marginTop:cur.pvPhHeight-i[1]+"px"}),cur.pvTagPerson.onmouseover=Photoview.showDynTag.pbind(_),cur.pvShowingTag=_,browser.msie?show(cur.pvTagPerson):fadeIn(cur.pvTagPerson,200)}}},hideTag(){cur.pvPhotoTags&&cur.pvPhotoTags.hideTagArea()},realOffset(_,e,t){var o=e;if(!cur.pvData||!cur.pvData[_])return o;for(var i=0;i<e;i++)cur.pvData[_][i]&&(cur.pvData[_][i].deleted||cur.pvData[_][i].moved)&&(o+=t);return o},realCount(_,e){var t=e;if(!cur.pvData||!cur.pvData[_])return t;for(var o=0;o<cur.pvData[_].length;o++)cur.pvData[_][o]&&(cur.pvData[_][o].deleted||cur.pvData[_][o].moved)&&t++;return t},list(_,e,t){"deleted"!=t&&(cur.pvList||(cur.pvList={}),cur.pvList[_+"_"+e]=t)},loaded(_,e,t,o,i){if("deleted"!=_){if(i&&(extend(cur,{lang:extend(cur.lang||{},i.lang),pvHash:i.hash,pvCommLimit:i.commlimit,pvCaptionLimit:i.captionlimit,pvMaxTags:i.maxtags,pvReasons:i.reasons,pvReplyNames:extend(cur.pvReplyNames||{},i.names||{}),pvAskForAutoTag:i.ask_for_autotag,pvNeedShowAlertForOneSuggest:i.need_show_alert_for_one_suggest,pvNeedShowAlertForSomeSuggests:i.need_show_alert_for_some_suggests,pvOneSuggestHintId:i.one_suggest_hint_id,pvOneSuggestHintHash:i.one_suggest_hint_hash,pvSomeSuggestsHintId:i.some_suggests_hint_id,pvSomeSuggestsHintHash:i.some_suggests_hint_hash,pvTagsQueueParams:i.qparams}),window.pvcur=extend(window.pvcur||{},{wallTpl:i.wallTpl,rmedia_types:i.rmedia_types}),cur.wallTpl=cur.wallTpl||i.wallTpl,cur.options||(cur.options={}),cur.options.share||(cur.options.share=i.share),val(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.x)(ge("pv_add_media")),getLang("global_add_media"))),e=Photoview.realCount(_,e),t=Photoview.realOffset(_,t,1),cur.pvData||(cur.pvData={}),cur.pvCommsLikes||(cur.pvCommsLikes={}),cur.pvData[_])if(cur.pvData[_].length<e)for(var r=cur.pvData[_].length;r<e;++r)cur.pvData[_].push(void 0);else cur.pvData[_].length>e&&(cur.pvData[_]=cur.pvData[_].slice(0,e));else cur.pvData[_]=new Array(e);for(var a=0,l=o.length;a<l;++a){for(var s=clone(o[a]),n=t+a;n>=e;)n-=e;cur.pvCommsLikes[s.id]=[s.comments,s.likes,vkNow(),!1],delete s.comments,delete s.likes,cur.pvData[_][n]=s}}},showDeleted(_,e,t){cur.pvShown&&"temp"==cur.pvListId&&(e+="<br><br>"+t),Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_23__.d)({title:getLang("global_error"),onHide:()=>{cur.pvShown&&"temp"==cur.pvListId&&Photoview.hide(!0)}},e)},spamDeleted(_,e,t){isVisible(curBox().progress)||ajax.post("al_photos.php",{act:"spam_photo",photo:e,hash:t,from:"deleted"},{onDone:e=>{domPN(_).replaceChild(ce("span",{innerHTML:e}),_)},showProgress:curBox().showProgress,hideProgress:curBox().hideProgress})},showPhoto(_,e,t,o){if(cur.pvShown&&("temp"!=cur.pvListId||cur.pvWasShown)&&void 0===t.noHistory||(debugLog("in showPhoto noHistory: "+t.noHistory),cur.pvNoHistory=t.noHistory,cur.pvHistoryLength=t.noHistory?0:t.histLen||0),extend(cur,{pvJumpTo:t.jumpTo||!1,pvJumpFrom:!1,pvJumpSteps:0}),e=cur.pvList&&cur.pvList[_+"_"+e]||e,cur.pvData&&cur.pvData[e]){var i=cur.pvData[e],r=cur.pvOptions&&cur.pvOptions.onHide,a=!0;cur.pvOptions=t,cur.pvOptions.onHide||(cur.pvOptions.onHide=r);for(var l=0,s=i.length;l<s;++l)if(i[l]){if(i[l].id===_)return Photoview.show(e,l,!1,t.root),t.onShow&&t.onShow(),!1}else a=!1;return a&&o?(t.onEmpty&&t.onEmpty(),!1):void 0}},loadedAlbums(_,e,t,o){cur.pvAlbumsData&&(ajax.preload("al_photos.php",extend({offset:o.offset,part:1,owner:_},{act:"show_albums"}),t),cur.curYear=o.cur_year,cur.pvAlbumsData[_]={html:e,opts:o},cur.pvAlbumsShowing==_&&(Photoview.doShowAlbums(_,!1),boxRefreshCoords(layer)))},showAlbums(_,e){_=intval(_),cur.pvAlbumsData||(cur.pvAlbumsData={}),"temp"==cur.pvListId&&cur.pvCancelLoad(),cur.pvNoHistory=e.noHistory,cur.pvHistoryLength=0,cur.pvAlbumsShowing=_;var t=e.onFail;cur.pvAlbumsData[_]?"loading"!=cur.pvAlbumsData[_]&&(Photoview.doShowAlbums(_,!1),boxRefreshCoords(layer)):(cur.pvAlbumsData[_]="loading",ajax.post("al_photos.php",{act:"show_albums",owner:_},extend(e,{onDone:Photoview.loadedAlbums,onFail:e=>(t&&t(e),delete cur.pvAlbumsData[_],cur.pvAlbumsData[_],layers.fullhide&&layers.fullhide(!0),!0)})))},loadedAlbum(_,e,t,o){cur.pvAlbumData&&(t&&ajax.preload("al_photos.php",extend({offset:o.offset,part:1,album:_},{act:"show_album"}),t),cur.pvAlbumData[_]={html:e,opts:o},cur.pvAlbumShowing==_&&(Photoview.doShowAlbum(_,!1),boxRefreshCoords(layer)))},showAlbum(_,e){cur.pvAlbumData||(cur.pvAlbumData={}),"temp"==cur.pvListId&&cur.pvCancelLoad(),cur.pvNoHistory=e.noHistory,cur.pvHistoryLength=0,cur.pvAlbumShowing=_;var t=e.onFail;cur.pvAlbumData[_]?"loading"!=cur.pvAlbumData[_]&&(Photoview.doShowAlbum(_,!1),boxRefreshCoords(layer)):(cur.pvAlbumData[_]="loading",ajax.post("al_photos.php",{act:"show_album",album:_},extend(e,{onDone:Photoview.loadedAlbum,onFail:e=>(t&&t(e),delete cur.pvAlbumData[_],cur.pvAlbumData[_],layers.fullhide&&layers.fullhide(!0),!0)})))},loadedTagged(_,e,t){cur.pvPhotoTagData&&(cur.pvPhotoTagData[_]={html:e,opts:t},cur.pvPhotoTagShowing==_&&(Photoview.doShowTagged(_,!1),boxRefreshCoords(layer)))},showTagged(_,e){_=intval(_),cur.pvPhotoTagData||(cur.pvPhotoTagData={}),"temp"==cur.pvListId&&cur.pvCancelLoad(),cur.pvNoHistory=e.noHistory,cur.pvHistoryLength=0,cur.pvPhotoTagShowing=_;var t=e.onFail;cur.pvPhotoTagData[_]?"loading"!=cur.pvPhotoTagData[_]&&(Photoview.doShowTagged(_,!1),boxRefreshCoords(layer)):(cur.pvPhotoTagData[_]="loading",ajax.post("al_photos.php",{act:"show_tag",mid:_},extend(e,{onDone:Photoview.loadedTagged,onFail:e=>(t&&t(e),delete cur.pvPhotoTagData[_],cur.pvPhotoTagData[_],layers.fullhide&&layers.fullhide(!0),!0)})))},updatePeriods(){Photoview.periods=geByClass("photos_period_delimiter")},destroyPeriod(){Photoview.fixedPeriod&&(re(Photoview.fixedPeriod),Photoview.fixedPeriod=!1,Photoview.fixedPeriodEl=!1)},fixPeriod(){if(Photoview.periods&&Photoview.periods.length){var _=scrollGetY(),e=getSize(Photoview.periods[0])[1],t=!1,o=!1;for(var i in Photoview.periods)if(Photoview.periods.hasOwnProperty(i)){if(getXY(Photoview.periods[i])[1]>=_)break;t=Photoview.periods[i];var r=intval(i)+1;o=!!Photoview.periods[r]&&getXY(Photoview.periods[r])[1]-_}if(t){t==Photoview.fixedPeriodEl||(Photoview.fixedPeriod?Photoview.fixedPeriod.innerHTML=t.innerHTML:(Photoview.fixedPeriod=ce("div",{innerHTML:t.innerHTML,className:"pva_period_fixed"},{left:getXY(t)[0]+"px"}),utils.appendChild(Photoview.fixedPeriod)),Photoview.fixedPeriodEl=t);var a=!1!==o?o-e:0;a>=0&&(a=0),Photoview.fixedPeriodTop!==a&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.vb)(Photoview.fixedPeriod,{top:a+"px"}),Photoview.fixedPeriodTop=a)}else!t&&Photoview.fixedPeriod&&(re(Photoview.fixedPeriod),Photoview.fixedPeriod=!1,Photoview.fixedPeriodEl=!1)}},scrollResize(){if(!browser.mobile&&cur.pvShown&&(cur.pvAlbumsShown||cur.pvAlbumShown||cur.pvPhotoTagShown||cur.pvVideoTagsShown)){var _=ge("ui_pv_photos_load_more"),e=ge("ui_pva_more_load_more"),t=3*lastWindowHeight;isVisible(_)&&t>getXY(_)[1]-(browser.msie6?0:scrollGetY())&&(cur.pvVideoTagsShown?Photoview.loadVideoTags():cur.pvPhotoTagShown?Photoview.loadTaggedPhotos():cur.pvAlbumsShown?Photoview.loadAlbumsPhotos():Photoview.loadAlbumPhotos()),cur.pvAlbumsShowing&&Photoview.fixPeriod(),cur.pvAlbumsShown&&cur.pvShowAllAlbums&&isVisible(e)&&t>getXY(e)[1]-(browser.msie6?0:scrollGetY())&&Photoview.loadAlbums()}},loadAlbums(){cur.pvShowAllAlbums=!0,Photoview.loadAlbumsPhotos(!0)},loadedAlbumsPhotos(_,e,t,o){if(cur.pvaLoading=0,cur.pvAlbumsShown){t?cur.pvaOffset=_:cur.pvaPhotosOffset=_,o&&(cur.curYear=o);var i=t?ge("pva_content"):ge("pva_content_photos"),r=t?ge("ui_pva_more_load_more"):ge("ui_pv_photos_load_more"),a=t?{act:"show_albums"}:{act:"show_albums",only_photos:1,cur_year:cur.curYear},l=t?cur.pvaOffset:cur.pvaPhotosOffset,s=t?cur.pvaCount:cur.pvaPhotosCount;if(i){for(var n=ce("div",{innerHTML:e});n.firstChild;){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.ab)(n.firstChild,"photos_period_delimiter")){var c=domData(n.firstChild,"year");if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("photos_period_delimiter_"+c)){re(n.firstChild);continue}}i.appendChild(n.firstChild)}Photoview.onResize(),Photoview.updatePeriods(),_>=s||!e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(r):t&&(cur.pvaLoading=1,ajax.post("al_photos.php",extend({offset:l,part:1,owner:cur.pvAlbumsShown},a||{}),{onDone(){debugLog("preload done: "+cur.pvaLoading),2==cur.pvaLoading?Photoview.loadedAlbumsPhotos.apply(window,arguments):cur.pvaLoading=!1},onFail:()=>(cur.pvaLoading=0,!0)}))}}},loadAlbumsPhotos(_){var e=_?ge("ui_pva_more_load_more"):ge("ui_pv_photos_load_more"),t=_?{act:"show_albums"}:{act:"show_albums",only_photos:1},o=_?cur.pvaOffset:cur.pvaPhotosOffset;cur.pvAlbumsShown&&e&&isVisible(e)&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.k)(e)&&(cur.pvaLoading?cur.pvaLoading=2:ajax.post("al_photos.php",extend({offset:o,part:1,owner:cur.pvAlbumsShown},t||{}),{cache:t.only_photos?0:1,onDone:Photoview.loadedAlbumsPhotos,onFail:()=>(cur.pvaLoading=0,!0),showProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(e)},hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(e)}}))},loadedAlbumPhotos(_,e){if(cur.pvaLoading=0,cur.pvAlbumShown){cur.pvsaOffset=_;var t=ge("pvsa_content_photos"),o=ge("ui_pv_photos_load_more");if(t){if(t.appendChild(cf(e)),!cur.pvAlbumData[cur.pvAlbumShown].opts.no_known_count&&_>=cur.pvsaCount||!e)return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(o),void Photoview.onResize();setTimeout(()=>{Photoview.onResize()},10),cur.pvsaLoading=1,ajax.post("al_photos.php",{offset:cur.pvsaOffset,part:1,album:cur.pvAlbumShown,act:"show_album"},{onDone(){2==cur.pvsaLoading?Photoview.loadedAlbumPhotos.apply(window,arguments):(cur.pvsaLoading=!1,ajax.preload("al_photos.php",{offset:cur.pvsaOffset,part:1,album:cur.pvAlbumShown,act:"show_album"},arguments))},onFail:()=>(cur.pvsaLoading=0,!0)})}}},loadAlbumPhotos(){var _=ge("ui_pv_photos_load_more"),e=cur.pvsaOffset;cur.pvAlbumShown&&_&&isVisible(_)&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.k)(_)&&(cur.pvsaLoading?cur.pvsaLoading=2:ajax.post("al_photos.php",{act:"show_album",album:cur.pvAlbumShown,offset:e,part:1},{onDone:Photoview.loadedAlbumPhotos,onFail:()=>(cur.pvsaLoading=0,!0),showProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(_)},hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(_)},cache:!0}))},loadedTaggedPhotos(_,e){if(cur.pvaLoading=0,cur.pvPhotoTagShown){cur.pvsaOffset=_;var t=ge("pvsa_content_photos"),o=ge("ui_pv_photos_load_more");t&&(t.appendChild(cf(e)),Photoview.onResize(),_>=cur.pvsaCount||!e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)(o):(cur.pvsaLoading=1,ajax.post("al_photos.php",extend({offset:cur.pvsaOffset,part:1,mid:cur.pvPhotoTagShown},{act:"show_tag"}),{onDone(){debugLog("preload done: ",cur.pvsaLoading),2==cur.pvsaLoading?Photoview.loadedTaggedPhotos.apply(window,arguments):cur.pvsaLoading=!1},onFail:()=>(cur.pvsaLoading=0,!0)})))}},loadTaggedPhotos(){var _=ge("ui_pv_photos_load_more"),e=cur.pvsaOffset;cur.pvPhotoTagShown&&_&&isVisible(_)&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.k)(_)&&(cur.pvsaLoading?cur.pvsaLoading=2:ajax.post("al_photos.php",{act:"show_tag",mid:cur.pvPhotoTagShown,offset:e,part:1},{onDone:Photoview.loadedTaggedPhotos,onFail:()=>(cur.pvsaLoading=0,!0),showProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.o)(_)},hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_22__.w)(_)},cache:1}))},thumbOver(_,e){clearTimeout((cur.pvHideTO||{})[e]);var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pva_title",_),o=t.previousSibling,i=getSize(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pva_desc",_))[1];i<5||(animate(t,{marginTop:146-(i+7)},{duration:200,transition:Fx.Transitions.easeOutCirc}),"pva_repeat"==o.className&&animate(o,{marginTop:43-Math.floor((i+7)/2)},{duration:200,transition:Fx.Transitions.easeOutCirc}))},thumbOut(_,e){cur.pvHideTO||(cur.pvHideTO={}),cur.pvHideTO[e]=setTimeout(()=>{var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pva_title",_),t=e.previousSibling;animate(e,{marginTop:146},200),"pva_repeat"==t.className&&animate(t,{marginTop:43},200)},150)},fsMove(_){if(!(cur.pvAlbumsShown||cur.pvAlbumShown||cur.pvPhotoTagShown)&&cur.pvCurPhoto.author){var e=getXY(cur.pvActions),t=getSize(cur.pvActions),o=Math.max(100,.2*cur.pvPhWidth);_.pageX>e[0]-o&&_.pageX<e[0]+t[0]+o&&_.pageY>e[1]-o&&_.pageY<e[1]+t[1]+o?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.c)(cur.pvActions,"visible"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.mb)(cur.pvActions,"visible")}},showRepeat(_){if(_&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pva_repeat",_)){var e=stManager._srcPrefix(".css")+"/images/icons/post_hh"+(window.devicePixelRatio>=2?"_2x":""),t=getLang("photos_repeat_album");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pva_link",_).insertBefore(ce("div",{className:"pva_repeat",innerHTML:`\n        <div class="pva_repeat_blob">\n         <div class="pva_repeat_cont">\n         <img class="pva_repeat_img png" src="${e}.png?3" />\n         <span class="pva_repeat_text">${t}</span></div>\n        </div>`}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.L)("pva_title",_))}},showPlace(){var _=cur.pvCurPhoto.geohash;showBox("al_places.php",{act:"show_photo_place",geohash:_,photo:cur.pvCurPhoto.id},{cache:1})},editPlace(){var _=cur.pvCurPhoto.geohash;showBox("al_places.php",{act:"show_photo_place",edit:1,geohash:_||"",photo:cur.pvCurPhoto.id})},updatePlace(_,e){var t=ge("pv_edit_place");e?(t&&(t.innerHTML=e?e+".":""),ge("pv_place").innerHTML=e?'<span class="pv_place_label"></span> <a class="pv_place_a" id="pv_place_a" onclick="Photoview.showPlace()">'+e+"</a>":"",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_16__.bb)("pv_add_place")):setTimeout(()=>{ajax.post("al_photos.php",{act:"get_photo_place",photo:_},{onDone:e=>{Photoview.updatePlace(_,e)}})},1e3)},reportComment(_,e,t){stManager.add([jsc("web/privacy.js"),"privacy.css"],()=>Privacy.show(_,e,"report_"+t))},selectProductInBox:function(){var _=cur.pvData[cur.pvListId][cur.pvIndex].attached_tags,e=(_.tags?_.tags.length:0)>=_.max_tags_per_object;if(_.tags&&e)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_23__.d)(getLang("global_error"),getLang("market_attach_products_overflow",_.max_tags_per_object)),!1;Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_15__.A)(window.event,Photoview.attachProduct)},attachProduct:function(_){curBox().hide(),Photoview.toggleTopInfoPanel(`<span class="attach_market_title">${getLang("market_product_attach_photo")} "${_.title}</span>`,`<button id="attach_market_cancel" class="flat_button secondary_dark black">${getLang("groups_cancel2")}</button>\n      <button id="attach_market_save" class="flat_button" disabled>${getLang("Save")}</button>`);var e=()=>{Photoview.toggleTopInfoPanel();var _=cur.pvAttachedProducts;_.point&&_.point.remove(),cur.pvAttachedProducts.isProcess=!1};cur.pvAttachedProducts.isProcess=!0,document.getElementById("attach_market_cancel").addEventListener("click",e),document.getElementById("attach_market_save").addEventListener("click",(function(){e();var t,o=cur.pvAttachedProducts;if(Object.assign(_,o.tempTag),!o.tempTag)return!1;if(document.getElementById("MarketList")){var i=_slicedToArray(Photoview.generateMarketListItem(_),2),r=i[0],a=i[1];t=r,document.getElementById("MarketList").appendChild(r),cur.pvImageAreaWrap.appendChild(a)}else{var l=_slicedToArray(Photoview.generateMarketList([_],!0),3),s=l[0],n=l[1],c=l[2];t=c,cur.pvImageAreaWrap.appendChild(n),document.getElementById("pv_attached_products_list").appendChild(s)}var d=cur.pvData[cur.pvListId][cur.pvIndex],b="link"===_.type?_.url:_.url.match(/product-?\d+_\d+/)[0],p=_slicedToArray(d.id.split("_"),2),u=p[0],E=p[1];_.x=o.tempTag.x,_.y=o.tempTag.y,ajax.post("al_market.php",{act:"add_tag_content_product",owner_id:u,item_id:E,type:"photo",hash:d.attached_tags.hash,tag_object:b,x:o.tempTag.x,y:o.tempTag.y},{onDone:e=>{t.id=e,d.attached_tags.tags=d.attached_tags.tags||[],_.tag_id=e,d.attached_tags.tags.push(_)}})}))},attachProductPoint:function(_){var e=document.getElementById("pv_product_point");e||((e=document.createElement("div")).classList.add("attach_market_point"),e.id="pv_product_point");var t=cur.pvImageAreaWrap,o=cur.pvAttachedProducts;o.tempTag=o.tempTag||{},document.getElementById("attach_market_save").removeAttribute("disabled");var i=_.currentTarget.getBoundingClientRect(),r=cur.pvAttachedProducts.photoSize,a=_.clientX-i.left-(i.width-r.width)/2,l=_.clientY-i.top-(i.height-r.height)/2;a>0&&l>0&&a<r.width&&l<r.height&&(document.getElementById("pv_product_point")||t.appendChild(e),o.tempTag.y=(_.clientY-i.top-r.top)/r.height,o.tempTag.x=(_.clientX-i.left-(i.width-r.width)/2)/r.width,e.style.top=_.clientY-i.top+"px",e.style.left=_.clientX-i.left+"px"),o.point=e},generateMarketList:function(_){var e=document.createElement("span");e.innerHTML=getLang("photos_attached_goods"),e.classList.add("pv_photo_product_attach_label");var t,o=document.createElement("ul");o.id="MarketList",o.classList.add("AttachedProductsList");var i=document.createDocumentFragment(),r=document.createDocumentFragment();_&&_.forEach((function(e){var o=Photoview.generateMarketListItem(e);1===_.length&&(t=o[0]),i.appendChild(o[0]),r.appendChild(o[1])})),o.appendChild(i);var a=document.createElement("div");return a.appendChild(e),a.appendChild(o),[a,r,t]},generateMarketListItem:function(_){var e=document.createElement("li");e.id=_.tag_id,e.classList.add("AttachedProductsList__item");var t=document.createElement("a");t.href=_.url,t.setAttribute("target","_blank");var o=e=>{Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_17__.d)(e)||(layerQueue.push(),cancelEvent(e),showWiki({w:_.url.match(/product-?\d+_\d+/)[0]},!1,e))};"link"!==_.type&&t.addEventListener("click",o),t.classList.add("AttachedProductsList__content");var i=document.createElement("div");i.classList.add("AttachedProductsList__img"),i.style.backgroundImage="url("+(_.thumb||"/images/market/attach_product_list_placeholder.png")+")",t.appendChild(i);var r=document.createElement("span");r.classList.add("AttachedProductsList__title"),r.innerHTML=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_18__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_18__.J)(_.title)),t.appendChild(r);var a=document.createElement("span");a.classList.add("AttachedProductsList__price"),a.innerHTML=_.price,t.appendChild(a),e.appendChild(t);var l=cur.pvData[cur.pvListId][cur.pvIndex],s=document.createElement("button");l.attached_tags&&l.attached_tags.hash&&(s.classList.add("AttachedProductsList__cross"),e.appendChild(s));var n=document.createElement("a");n.href=_.url,n.setAttribute("target","_blank"),"link"!==_.type&&n.addEventListener("click",o),n.classList.add("pv_attach_product_badge"),n.innerHTML=`<span class="pv_attach_product_badge_title">${Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_18__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_18__.J)(_.title))}</span>\n      <span class="pv_attach_product_badge_price">${_.price}</span>`;var c=cur.pvImageAreaWrap.getBoundingClientRect(),d=cur.pvAttachedProducts.photoSize,b=176,p=54,u=14,E={top:Math.floor(_.y*d.height)+(c.height-d.height)/2,left:Math.floor(_.x*d.width)+(c.width-d.width)/2,height:p+u,width:b};n.style.top=E.top+"px",n.style.left=E.left+"px",n.style.opacity="1";var O=Photoview.getBadgePositioningClass({photoSize:d,badgeRect:E});n.classList.add(O);var h=_slicedToArray(l.id.split("_"),2),w=h[0],v=h[1];return l.attached_tags&&l.attached_tags.hash&&s.addEventListener("click",_=>{ajax.post("al_market.php",{act:"delete_tag_content_product",owner_id:w,item_id:v,type:"photo",access_key:cur.pvCurPhoto.hash,hash:l.attached_tags.hash,tag_id:_.target.parentElement.id});var e=cur.pvData[cur.pvListId][cur.pvIndex];return e.attached_tags.tags=e.attached_tags.tags.filter(e=>e.tag_id!=_.target.parentElement.id),n.remove(),document.getElementById("MarketList").childElementCount>1?_.target.parentElement.outerHTML="":document.getElementById("pv_attached_products_list").innerHTML="",cancelEvent(_)}),s.addEventListener("mouseover",_=>{Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_24__.c)(_.target,{text:getLang("photos_pv_act_delete"),black:1,center:!0,shift:[0,3]})}),e.addEventListener("mouseover",(function(){n.style.opacity="1"})),e.addEventListener("mouseout",(function(_){if(e.contains(_.relatedTarget))return!1;n.style.opacity="0"})),cur.pvImageAreaWrap.addEventListener("mouseover",(function(){cur.pvEditorMode||(n.style.opacity="1")})),cur.pvImageAreaWrap.addEventListener("mouseout",(function(_){if(cur.pvImageAreaWrap&&cur.pvImageAreaWrap.contains(_.relatedTarget))return!1;n.style.opacity="0"})),cur.pvAttachedProducts.badges=cur.pvAttachedProducts.badges||[],cur.pvAttachedProducts.badges.push(n),[e,n]},isBadgeWiderThanPhoto:_=>{var e=_.photoWidth;return _.badgeWidth>e},getRequiredBadgeSideSize:_=>_/2,isBadgeCroppedFromLeft:_=>{var e=_.photoSize,t=_.badgeRect;if(Photoview.isBadgeWiderThanPhoto({photoWidth:e.width,badgeWidth:t.width}))return!1;var o=Photoview.getRequiredBadgeSideSize(t.width);return t.left<o},isBadgeCroppedFromRight:_=>{var e=_.photoSize,t=_.badgeRect;if(Photoview.isBadgeWiderThanPhoto({photoWidth:e.width,badgeWidth:t.width}))return!1;var o=Photoview.getRequiredBadgeSideSize(t.width);return t.left+t.width>e.width-o},isBadgeCroppedFromBottom:_=>{var e=_.photoSize,t=_.badgeRect;return!(t.height>e.height)&&t.top>e.height-t.height},getBadgePositioningClass:_=>{var e={photoSize:_.photoSize,badgeRect:_.badgeRect},t=Photoview.isBadgeCroppedFromLeft(e),o=Photoview.isBadgeCroppedFromRight(e),i=Photoview.isBadgeCroppedFromBottom(e),r="pv_attach_product_badge";return t||o||i?t&&o&&!i?"pv_attach_product_badge--down-middle":t?i?r+"--up-right":r+"--down-right":o?i?r+"--up-left":r+"--down-left":i?r+"--up-middle":"pv_attach_product_badge--down-middle":"pv_attach_product_badge--down-middle"}}},"p4k+":function(_,e,t){"use strict";t.d(e,"b",(function(){return w})),t.d(e,"c",(function(){return v})),t.d(e,"e",(function(){return M})),t.d(e,"a",(function(){return g})),t.d(e,"d",(function(){return f})),t.d(e,"g",(function(){return C})),t.d(e,"f",(function(){return L}));var o=t("jE6c"),i=t("smNX"),r=t("fBgk"),a=t("zxIV"),l=t("7jxN"),s=t("4+be"),n=t("DN6O"),c=t("crIy"),d=t("WQ5g"),b=t("9xR5"),p=t("ZxpX"),u=t("t7n3"),E=function(_,e,t,o,i){var l=function(_,e,t){void 0===t&&(t=!1);for(var o=[],i=0,a=Object.keys(_);i<a.length;i++){var l=a[i],s=Object(r.e)(l);s.isValid&&_[s.value]>0&&o.push(s.value)}return o=o.sort((function(e,t){return(_[t]||0)-(_[e]||0)})).slice(0,e),t&&o.reverse(),o}(e,3,i),s=_.querySelector(".ReactionsPreview__items"),n=Object(c.b)(t),d=0===Object(b.b)(e),E=Object(u.n)("reactions_preview_item");s&&n&&E?(s.innerHTML=l.map((function(_){var e=n.itemsById[_];if(!e)return"";var t=Object(p.a)({"ReactionsPreviewItem--lite ReactionsPreviewItem--stackOverlayLite":i,"ReactionsPreviewItem--post ReactionsPreviewItem--stackOverlayPost":!i});return Object(a.qb)(E,{image_url:e.imagePreviewURL,title:e.title,class:t})})).join(""),_.classList.toggle("ReactionsPreview--empty",d),_.classList.toggle("ReactionsPreview--active",void 0!==o)):console.warn("Unable to render reaction previews",{itemsContainer:s,previewItemTemplate:E,reactionSet:n})},O=t("xqyG"),h=function(_){var e=_.getAttribute("data-reaction-counts");if(null===e)return{};var t=e?Object(i.a)(e):void 0;return"object"==typeof t&&null!==t?t:void 0},w=function(_){var e=_.getAttribute("data-reaction-target-object"),t=_.getAttribute("data-reaction-hash"),o=_.getAttribute("data-reaction-set-id");if(null!==o){var i=_.getAttribute("data-reaction-user-reaction-id"),a=i?Object(r.f)(i):void 0,l=!!_.getAttribute("data-reaction-lite"),s=!!_.getAttribute("data-reaction-without-preview");return{counts:h(_),csrfHash:t,isLite:l,objectRaw:e,reactionSetId:o,userReactionId:a,withoutPreview:s}}},v=function(_,e){_.setAttribute("data-reaction-user-reaction-id",void 0===e?"":String(e))},m=function(_){var e,t=null===(e=_.__reactionIconAnimation)||void 0===e?void 0:e.animationItem;t&&(!t._cbs||t.destroy(),delete _.__reactionIconAnimation)},P=function(_,e,t,o){var i=_.querySelector('[data-section-ref="reactions-button-icon"]');if(i){if(e){var r=null==e?void 0:e.imageMenuURL;i.style.backgroundImage="url('"+r+"')",i.setAttribute("aria-label",null==e?void 0:e.title)}else i.style.backgroundImage="",(null==t?void 0:t.title)&&i.setAttribute("aria-label",null==t?void 0:t.title);i.classList.toggle("PostButtonReactions__icon--custom",!!e),function(_,e,t,o){var i;if(!(_!==(null===(i=t.__reactionIconAnimation)||void 0===i?void 0:i.animationURL))&&_||(m(t),e.innerHTML="",t.classList.remove("PostButtonReactions__icon--animationActive")),o&&_){var r=Object(n.a)(_,e,{loadAnimationParams:{autoplay:!0,loop:!1}});Object(O.c)(r,(function(){t.classList.add("PostButtonReactions__icon--animationActive")}));r.addEventListener("complete",(function(){t.classList.remove("PostButtonReactions__icon--animationActive"),m(t)})),t.__reactionIconAnimation={animationItem:r,animationURL:_}}}(null==e?void 0:e.animationURL,function(_){var e=_.querySelector(".PostButtonReactions__iconAnimation");return e||(e=Object(a.rb)('<div class="PostButtonReactions__iconAnimation" data-section-ref="reactions-button-icon-animation"></div>'),_.append(e),e)}(i),i,o)}},D=function(_,e,t){_.classList.toggle("PostButtonReactions--icon-active",e)},M=function(_,e,t,o){var i=!Object(r.c)(e),l=Object(r.a)(t),n=void 0;void 0===e||(n=t.itemsById[e])?(P(_,n,l,o),function(_,e,t){var o,i=_.querySelector('[data-section-ref="reactions-button-title"]');if(i){var r=null===(o=null==e?void 0:e.titleColor)||void 0===o?void 0:o.light,l=r?{color:"#"+r}:{color:null};if(e){i.innerText=e.title,Object(a.vb)(i,l);var n=Object(s.l)(Object(s.d)("reactions_button_unset_reaction_title"),{reaction_name:e.title});_.setAttribute("aria-label",n||"")}else(null==t?void 0:t.title)&&(i.innerText=t.title),Object(a.vb)(i,l),_.setAttribute("aria-label",Object(s.d)("reactions_button_title")||"")}}(_,n,l),D(_,i),o&&function(_,e){_.setAttribute("data-reaction-last-own-change-time",String(e))}(_,Date.now())):console.error(new Error("Missing reaction meta for "+e+" in set '"+t.id+"'"))},g=function(_){var e=_.getAttribute("data-reaction-last-own-change-time");if(e&&Object(o.k)(e))try{return new Date(Number.parseInt(e)).getTime()||void 0}catch(_){return void console.error(_)}};var f=function(_){return Object(b.b)(_)>0},T=function(_,e){var t=e.counts,o=e.countsPrevious,i=e.isLite,r=e.objectRaw,a=e.reactionId,n=e.reactionSetId,p=Object(c.b)(n),u=Object(b.a)(t,p),O=Object(b.c)(u),h=Object(b.b)(t),w=o?Object(b.b)(o):0,v=Object(d.d)(r);v&&(E(v,t,n,a,i),function(_,e,t,o){var i,r,a=Object(s.j)(t,Object(s.d)("reactions_n_reacted","raw")||"%s",!0);_.setAttribute("aria-label",a);var n=function(_){var e;return null!==(e=_.querySelector('[data-section-ref="like-button-count"]'))&&void 0!==e?e:void 0}(_);if(n){if(_.tt&&"object"==typeof _.tt)_.tt.shown||_.tt.showing||null===(r=null===(i=_.tt)||void 0===i?void 0:i.destroy)||void 0===r||r.call(i);var c=Object(s.j)(e,"%s",!0);Object(l.c)(n,c,{allowZero:0!==o,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}}(v,O,h,w))},C=function(_,e){var t=Object(d.b)(_),o=e.counts;t&&o?function(_,e){var t=w(_);t&&t.objectRaw&&T(0,{counts:e,countsPrevious:t.counts,isLite:t.isLite,objectRaw:t.objectRaw,reactionId:t.userReactionId,reactionSetId:t.reactionSetId})}(t,o):console.warn("Unable to update object reactions",{objectRaw:_,options:e})},L=function(_,e){var t=e.counts,o=Object(d.b)(_);o&&function(_,e){_.setAttribute("data-reaction-counts",JSON.stringify(e))}(o,t)}},pruO:function(_,e,t){"use strict";t.d(e,"d",(function(){return o})),t.d(e,"b",(function(){return i})),t.d(e,"c",(function(){return r})),t.d(e,"a",(function(){return a}));var o={wall:"wall",wall_reply:"wall_reply"},i={width:96,height:96},r={width:40,height:40},a="reactions_counts"},qwyz:function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("HEwt"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("rGqo"),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("rE2o"),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("ioFf"),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("OG14"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("a1Th"),core_js_modules_es6_promise__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("VRzm"),core_js_modules_es6_object_to_string__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("Btvt"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("Oyvg"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("KKXr"),core_js_modules_es6_object_assign__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("91GP"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("pIFo"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("SRfc"),_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("zxIV"),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("/PiP"),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("Egk5"),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("FWc3"),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("EasH"),_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("v+DW"),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("Xrg9"),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("t7n3"),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("kcIO"),_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("XzvV"),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("lXE5"),_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("7jxN"),_web_lib_video__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("Ia1d"),_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("4+be"),_shared_lib_convert__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("cGUQ"),_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("t/FQ"),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("QGEU"),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("98sY"),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__("o7bv"),_web_lib_utils__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("aong"),_web_youla_preloadYoulaItemCreate__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("EIqf"),_web_donut__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("7GuL"),_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("DzCs"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__("YIAi"),_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__("QxcO"),_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__("te1c"),_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__("hzb7"),_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__("jE6c"),_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__("oK+H"),_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__("F5gA"),_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__("bWc2"),_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__("zqir"),_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__("34p4"),_internal_nospam_common__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__("FThC"),_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__("DfBR"),_web_lib_date__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__("1BRX"),_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__("g4nd"),_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__("6krn"),_web_BestFriends_analytics__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__("3EzW");function _extends(){return(_extends=Object.assign||function(_){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(_[o]=t[o])}return _}).apply(this,arguments)}function _slicedToArray(_,e){return _arrayWithHoles(_)||_iterableToArrayLimit(_,e)||_unsupportedIterableToArray(_,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(_,e){if(_){if("string"==typeof _)return _arrayLikeToArray(_,e);var t=Object.prototype.toString.call(_).slice(8,-1);return"Object"===t&&_.constructor&&(t=_.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(_,e):void 0}}function _arrayLikeToArray(_,e){(null==e||e>_.length)&&(e=_.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=_[t];return o}function _iterableToArrayLimit(_,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(_)){var t=[],o=!0,i=!1,r=void 0;try{for(var a,l=_[Symbol.iterator]();!(o=(a=l.next()).done)&&(t.push(a.value),!e||t.length!==e);o=!0);}catch(_){i=!0,r=_}finally{try{o||null==l.return||l.return()}finally{if(i)throw r}}return t}}function _arrayWithHoles(_){if(Array.isArray(_))return _}var Wall={LS_ADS_EVENTS:"ads.events",deleteAll:function(_,e,t){ajax.post("al_wall.php",{act:"delete_all",post:e,hash:t},{onDone:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_));t.oldt=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(t,e)},showProgress:function(){hide(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_).appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{className:"progress"})))},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_))}})},restoreAll:function(_,e,t){var o=Math.floor(1e5*Math.random());cur.wallRnd=o,ajax.post("al_wall.php",{act:"restore_all",post:e,hash:t,rnd:o},{onDone:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(t,t.oldt)},showProgress:function(){hide(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_).appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span",{className:"progress_inline"})))},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_))}})},deleteThread:function(_,e,t){ajax.post("al_wall.php",{act:"delete_thread",post:e,hash:t,from_deleted:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e),"reply_deleted")},{onDone:function(t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("dld_inner",_);if(o)o.oldElements=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(o,t);else{var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e),r=geByClass1("reply_wrap",i);hide(r),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{id:"post_del"+e,className:"dld",innerHTML:'<span class="dld_inner">'+t+"</span>"}),i.appendChild(o)}hide("replies_wrap_deep"+e)},showProgress:function(){hide(_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post_actions",_);if(e)addClass(e,"post_actions_progress");else{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_);t||(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{className:"progress"}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_).appendChild(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(t))}},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post_actions",_);e?removeClass(e,"post_actions_progress"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_))}})},restoreThread:function(_,e,t){ajax.post("al_wall.php",{act:"restore_thread",post:e,hash:t},{onDone:function(){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("replies_wrap_deep"+e),t.oldElements)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(t,t.oldElements);else{var o=geByClass1("reply_wrap","post"+e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("post_del"+e)}},showProgress:function(){hide(_);var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_);e||(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{className:"progress"}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_).appendChild(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(e))},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_))}})},block:function(_,e,t,o,i){ajax.post("al_wall.php",{act:"block",post:e,hash:t,bl:o,from:i},{onDone:function(e){o?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_).insertBefore(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span",{innerHTML:e}),_),hide(_)):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_))),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_)))},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.u)(_,"post_inline_progress","post_inline_progress",!0)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("post_inline_progress")}})},blockEx:function(_,e){Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.b)("groupsedit.php",{act:"bl_edit",name:"id"+e,gid:_,auto:1},{stat:["page.css","ui_controls.js","ui_controls.css"],dark:1})},withMentions:!(browser.mozilla&&browser.version.match(/^2\./)||browser.mobile),editPost:function(_,e,t,o,i){if(cur.editingPost&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wpe_text")){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wall_posts",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wpe_text"));if(!r||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(r))return o&&o(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.q)("wpe_text");Wall.cancelEdit()}cur.editingPost=[e],Wall.withMentions?stManager.add(["ui_controls.css","ui_controls.js","mentions.js",jsc("web/wall_edit.js")]):stManager.add([jsc("web/wall_edit.js")]),ajax.post("al_wall.php",extend({act:"edit",post:e,mention:Wall.withMentions?1:""},t),{onDone:function(){var _=Array.prototype.slice.call(arguments);if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(_[4])&&cur.options&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(cur.options.filter_media_types)){var o=[];each(_[4],(function(_,e){each(cur.options.filter_media_types,(function(_,t){if(e[0]===t[0])return o.push(t),!1}))})),_[4]=o}_.unshift(e),t&&t.fromAds&&_.push(t.fromAds),WallEdit.editPost.apply(window,_),i&&i()},onFail:function(){cur.editingPost=!1,o&&o()},showProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(_):addClass(geByClass1("post_actions","post"+e),"post_actions_progress")},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(_):removeClass(geByClass1("post_actions","post"+e),"post_actions_progress")},noSort:!0})},fixPost:function fixPost(link,post,hash,value){return ajax.post("al_wall.php",{act:"a_fix_post",post,hash,value},{onDone:function onDone(js){if(js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.d)(_,js)}var postEl=cur.wallLayer==post?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+post);each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post_fixed"),(function(){removeClass(this,"post_fixed")})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(postEl,"post_fixed",value),link&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(link,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)(value?"wall_unfix_post":"wall_fix_post")),link.onclick=function(){return Wall.fixPost(link,post,hash,value?0:1)}),cur.onWKFix&&(cur.onWKFix(value),delete cur.onWKFix)},showProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(link,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind("wpe_fix"+post)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(link,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v)(link):_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind("wpe_fix"+post)}}),!1},cancelEdit:function(_){if(cur.editingPost){if(!0===_&&cur.editingPost[0].match(/^-?\d+_/))return;window.WallEdit?WallEdit.cancelEditPost():cur.editingPost=!1}},searchWall:function(){},switchTabContent:function(_){switch(hide("page_wall_posts","page_postponed_posts","page_suggested_posts","page_search_posts","page_top_posts","page_archive_posts","page_donut_posts"),_){case"own":case"all":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_wall_posts");break;case"postponed":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_postponed_posts"),hide("wall_more_link");break;case"suggested":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_suggested_posts");break;case"search":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_search_posts");break;case"top":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_top_posts");break;case"archive":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_archive_posts");break;case"donut":Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_donut_posts")}},switchWall:function(_,e,t){var o;if(e&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.d)(e))return!0;if(t||(t="own"==cur.wallType?"all":"own"),e&&"click"==e.type&&e.clientX&&e.offsetX&&cur.wallTab==t&&cur.wallType==t&&"top"!==t)return nav.go(_,e);if("postponed"==cur.wallTab&&wall.checkPostponedCount(),"archive"!==cur.wallTab&&"archive"!==t||((cur.wallLayer?wkcur:cur).wallMyDeleted={}),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(cur.wallArchiveFeatureTooltipHide)&&cur.wallArchiveFeatureTooltipHide(),!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(t,["top","archive","donut"])){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_posts");removeClass(i,"own"),removeClass(i,"all"),addClass(i,t)}cur.wallType=t,cur.wallTab=t,uiTabs.switchTab(_),uiTabs.hideProgress(_),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(t,["top","archive","donut"])?(cur.baseWallModule=cur.module,cur.module="wall_"+t,cur.topWallFeatureTT&&cur.topWallFeatureTT.hide()):cur.baseWallModule&&(cur.module=cur.baseWallModule,delete cur.baseWallModule);var r="donut"===t&&Wall.cantAccessDonutPosts();return Wall.hasPosts()||r?(Wall.update(),Wall.showWall()):(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,cur.wallArchiveRestored=0,cur.wallArchiveArchived=0,cur.wallArchiveRolledback=0,cur.wallDonutNextFrom=0,"top"===t?delete cur.wallTopFinished:"archive"===t?delete cur.wallArchiveFinished:"donut"===t&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_)),(null==_||null===(o=_.dataset)||void 0===o?void 0:o.donutLogEvent)&&Object(_shared_donut_stats_donut_log__WEBPACK_IMPORTED_MODULE_49__.a)(_.dataset.donutLogEvent),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(e)},resetWall:function(){if(cur.wallType&&cur.wallTab){var _=geByClass1("_wall_tab_"+cur.wallType);_&&(cur.wallNextFrom=0,cur.wallTopNextFrom=0,cur.wallArchiveNextFrom=0,(cur.wallLayer?wkcur:cur).wallMyDeleted={},"top"===cur.wallType?delete cur.wallTopFinished:"archive"===cur.wallType?delete cur.wallArchiveFinished:"donut"===cur.wallType&&delete cur.wallDonutFinished,uiTabs.showProgress(_),Wall.showMore(0,_,!0))}},hasPosts:function(_){_=_||cur.wallType;var e=Wall.getPostsWrap(_);return!!geByClass1("post",e)},getPostsWrap:function(_){switch(_){case"archive":return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_archive_posts");case"top":return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_top_posts");case"donut":return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_donut_posts");default:return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_posts")}},showSuggested:function showSuggested(ev,rows,notAll){if(ev&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.d)(ev))return!0;if(!cur.oid)return!1;var el=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_suggest");if(el=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(el,"unshown")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.F)("#page_wall_suggest_more .ui_tab_group_item"):geByClass1("ui_tab",el),!el)return!1;if(uiTabs.switchTab(el),cur.wallTab="suggested",delete cur.suggestedDeletedCount,void 0!==rows)wall.suggestLoaded(rows,notAll);else{if(cur.suggestedLoading)return!1;var curOid=cur.suggestedLoading=cur.oid;uiTabs.showProgress(el),ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid},{onDone:function onDone(rows,notAll,js,count){if(js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.d)(_,js)}cur.suggestedLoading=!1,uiTabs.hideProgress(el),Wall.updateTabCounter("page_wall_suggested_cnt",count),curOid===cur.oid&&"suggested"==cur.wallTab&&wall.suggestLoaded.apply(window,arguments)}})}return!1},deleteSuggested:function(_,e,t,o){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.k)(o)){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(o);var i=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)({title:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_action_confirmation"),onHide:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(o)}},Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_delete_suggested_box"),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_delete_suggested_btn"),(function(o){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.k)(o)||(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(o),ajax.post("al_wall.php",{act:"delete_suggested",post_id:_,hash:t,group_id:e},{onDone:function(_){if("full_own"==cur.wallType||"full_all"==cur.wallType){var e=(Math.ceil(_/cur.pgPerPage)-1)*cur.pgPerPage;e<cur.pgOffset&&(e>0?nav.objLoc.offset=e:delete nav.objLoc.offset,nav.setLoc(nav.objLoc)),nav.reload()}else Wall.showSuggested();i.hide()},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind(o)}))}),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_cancel"))}},suggestLoaded:function(_,e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_suggested_posts",_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)("wall_more_link",e),wall.switchTabContent("suggested")},suggestMore:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_suggested_posts"),e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_more_link");Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.k)(e)||ajax.post("al_wall.php",{act:"get_suggests",owner_id:cur.oid,offset:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post",_).length-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("dld",_).length},{onDone:function(t,o){for(var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{innerHTML:t}),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(i);r;)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(r.id)||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"post")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(r):_.appendChild(r),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(i);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)(e,o)},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind(e),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind(e)})},suggestUpdate:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_suggests_count"),t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e));e&&(-1!==_&&1!==_||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e,t+=_),Wall.updateTabCounter("page_wall_suggested_cnt",t))},suggestPublished:function(_,e,t){if(cur.onepost)return nav.go("/wall"+cur.oid);if(Wall.suggestUpdate(-1),Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.f)(e),cur.wallMyDeleted[_]=1,cur.editingPost=!1,Wall.deinitComposer(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wpe_text")),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),cur.postWpeIsPoster=!!cur.posterWpeSendParams,cur.posterWpe&&cur.posterWpeSendParams&&WallEdit.posterDestroy(),t&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_postponed_posts",t),wall.postponeUpdateCount()),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_suggests_count")))Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("post"+_);else{var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_rmenu");o?(geByClass1("ui_rmenu_item",o).click(),hide(geByClass1("_wall_menu_suggested",o))):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_tabs")&&(geByClass1("ui_tab",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_suggest",!1))}},showDonutWall:function(_){if(!cur.oid)return!1;Wall.updateTabVisibility("page_wall_donut",!0);var e=Wall.getWallTabLink("donut");if(!e)return!1;uiTabs.switchTab(e),cur.wallTab="donut",cur.wallType="donut",void 0!==_&&Wall.donutWallSetRows(_)},donutWallSetRows(_){var e=Wall.getPostsWrap("donut");e&&(e.innerHTML=_,Wall.switchTabContent("donut"),Wall.update())},getWallTabLink:_=>{var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_"+_);return(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"unshown")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.F)(`#page_wall_${_}_more .ui_tab_group_item`):geByClass1("ui_tab",e))||null},showPostponedFull:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("ui_rmenu_postponed"),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_posts");if(!e||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"ui_rmenu_item_sel")||!t){var o={0:nav.objLoc[0],postponed:1};return nav.go(o)}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(t,_),FullWall.updateSummary(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post",t).length)},showPostponed:function(_,e){if(_&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.d)(_))return!0;if(!cur.oid)return!1;var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_postponed");if(!(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"unshown")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.F)("#page_wall_postponed_more .ui_tab_group_item"):geByClass1("ui_tab",t)))return!1;if(uiTabs.switchTab(t),cur.wallTab="postponed",void 0!==e)Wall.postponedLoaded(e);else{if(cur.postponedLoading)return!1;var o=cur.postponedLoading=cur.oid;uiTabs.showProgress(t),ajax.post("al_wall.php",{act:"get_postponed",owner_id:cur.oid},{onDone:function(_){cur.postponedLoading=!1,uiTabs.hideProgress(t),o===cur.oid&&"postponed"==cur.wallTab&&Wall.postponedLoaded(_)}})}return!1},postponedLoaded:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_postponed_posts",_),wall.postponeUpdateCount(),wall.switchTabContent("postponed")},postponeUpdateCount:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_postponed_posts"),e=_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post",_).length-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("dld",_).length||0;_&&Wall.updateTabCounter("page_wall_postponed_cnt",e)},checkPostponedCount:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post","page_postponed_posts"),e=0;each(_,(function(){var _=this.id.replace("post","");cur.wallMyDeleted[_]||e++})),e||wall.updateTabVisibility("page_wall_postponed",!1)},updateTabCounter:function(_,e){e=e?Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.j)(e,"%s",!0):"",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)(_).forEach((function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(_,e);var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"ui_tab_group_item")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"default-label",t.innerHTML)}))},updateTabVisibility:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_more_tab");if(t)if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(t))if(e){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"unshown")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_+"_more","unshown")){var o=!1;cur.wallTabsMorePriority.forEach((function(e){o||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"unshown")||(addClass(e,"unshown"),removeClass(e+"_more","unshown"),removeClass(_,"unshown"),o=!0)})),o||removeClass(_+"_more","unshown")}}else{var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i,"unshown"))addClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_+"_more"),"unshown");else{addClass(i,"unshown");var r=cur.wallTabsLimit-1-Object(_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_47__.a)(t).length;if(r>0){var a=r;cur.wallTabsMorePriority.forEach((function(_){if(!(a<=0)){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_+"_more");e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"unshown")&&(removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_),"unshown"),addClass(e,"unshown"),a--)}}))}}var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("ui_tab_group_item",t);l.length-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("unshown",t).length<=1&&(l.forEach((function(_){_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"unshown")||(removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_.id.replace(/_more$/,"")),"unshown"),addClass(_,"unshown"))})),addClass(t,"unshown"))}else{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_),"unshown",!e);var s=Object(_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_47__.a)(t).length;if(s>cur.wallTabsLimit){var n=s-(cur.wallTabsLimit-1);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("ui_tab_group_item",t).forEach((function(_){addClass(_,"unshown")})),cur.wallTabsMorePriority.forEach((function(_){if(!(n<=0)){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_);e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"unshown")&&(addClass(e,"unshown"),removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_+"_more"),"unshown"),n--)}})),removeClass(t,"unshown"),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.bb)("wall_more_tab_shown",cur.oid)}}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_),"unshown",!e)},postponedPublished:function(_,e){if(cur.onepost)return nav.go("/wall"+cur.oid);"full_own"!=cur.wallType&&"full_all"!=cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.f)(e),cur.wallMyDeleted[_]=1;var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_postponed_posts")),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);if(t.length<=1&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(o,t)){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_rmenu");i?(geByClass1("ui_rmenu_item",i).click(),hide(geByClass1("_wall_menu_postponed",i))):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_tabs")&&(geByClass1("ui_tab",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_tabs")).click(),wall.updateTabVisibility("page_wall_postponed",!1))}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(o),wall.postponeUpdateCount()},onWallSearchSend:function(_,e){e?Wall.showSearch(e,0):Wall.hideSearch()},showSearch:function(_,e){if(cur.searchLoading&&cur.searchLoading==_||!cur.oid)return!1;var t=cur.oid;cur.wallQuery=cur.searchLoading=_,"search"!=cur.wallTab&&(cur.prevWallTab=cur.wallTab,cur.wallTab="search");var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_more_link"),i=+new Date;return ajax.post("al_wall.php",{act:"s",search:1,q:_,owner_id:cur.oid,offset:e,inline:1,owners_only:1},{onDone:function(r,a,l){if(t===cur.oid&&"search"==cur.wallTab){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_search_posts");e||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(s,""),s.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(r)),wall.switchTabContent("search"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)(o,a<l),o.onclick=Wall.showSearch.pbind(_,a);var n=cur.oid>0?_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.ab:_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.Z,c=+new Date-i;Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.t)(n,0,l,_,0,0,c)}},showProgress:function(){uiSearch.showProgress("wall_search"),e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(o)},hideProgress:function(){cur.searchLoading=!1,uiSearch.hideProgress("wall_search"),e&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(o)}}),!1},hideSearch:function(){if(delete cur.wallQuery,cur.prevWallTab){var _=(cur.oid,_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.ab);Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.s)(_),cur.wallTab=cur.prevWallTab,cur.prevWallTab=!1,wall.switchTabContent(cur.wallTab),wall.update()}},publishPostponedPost:function(_,e,t){Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("publish_postponed_title"),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("publish_postponed_confirm"),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("publish_postponed_btn"),(function(){Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)().hide(),ajax.post("al_wall.php",{act:"publish_postponed",post:_,from:t,hash:e},{onDone:Wall.postponedPublished.pbind(_),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind("wpe_publish"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind("wpe_publish"+_)})}),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_cancel"))},publishFreeDonutCopy:function(_,e,t,o){var i=_.currentTarget,r=o?{title:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_warning"),content:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_publish_donut_as_free_confirmation_warn")}:{title:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_publish_donut_as_free_confirmation_title"),content:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_publish_donut_as_free_confirmation_confirm")},a=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)(r.title,r.content,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_publish_donut_as_free_confirmation_btn"),()=>{var _=()=>{a.hide()},o=a.btns.ok[0];ajax.post("al_wall.php",{act:"publish_free_donut_copy",post_id:e,hash:t},{onDone:e=>{Wall.publishFreeDonutCopyDone({menuActionEl:i,message:e}),_()},onFail:()=>{_()},showProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(o)},hideProgress:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(o)}})},Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_cancel"))},publishFreeDonutCopyDone(_){var e=_.message,t=_.menuActionEl;"full_own"!==cur.wallType&&"full_all"!==cur.wallType||(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)),e&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.f)(e,{timeout:3e3}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(t)},cmp:function(_,e){var t=_.length,o=e.length;return t<o?-1:t>o?1:_<e?-1:_>e?1:0},receive:function(_,e,t,o){o=!0===o;var i,r,a,l,s="top"===(t=t||cur.wallType),n="archive"===t,c="donut"===t,d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{innerHTML:_}),b=!!cur.options.revert,p=Wall.getPostsWrap(t),u=[],E=[],O=["page_top_posts","page_wall_posts","page_archive_posts","page_donut_posts"],h=0;if(o)E=O;else{var w=[[n,"page_archive_posts"],[s,"page_top_posts"],[c,"page_donut_posts"],[!0,"page_wall_posts"]].find(_=>_slicedToArray(_,1)[0]),v=_slicedToArray(w,2)[1];E=O.filter(_=>_!==v),a=b?p.firstChild:p.lastChild}function m(_){return!!(_&&_.tagName&&"div"===_.tagName.toLowerCase()&&_.id&&"post"===_.id.substr(0,4))&&_.id}E.forEach((function(_){if("page_donut_posts"!==_||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_donut_info"))for(var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_));e;){var t=e;e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(e),t.tagName&&"input"===t.tagName.toLowerCase()||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(t)}}));for(var P=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(b?d.firstChild:d.lastChild);P;P=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(b?d.firstChild:d.lastChild))if("input"!=P.tagName.toLowerCase()){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(P,"post_fixed")||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(P.id))if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(P,"_ads_promoted_post"))u.push({el:P,beforePost:m(b?d.firstChild:i),afterPost:m(b?i:d.lastChild)});else{for(;a&&a.tagName&&"div"==a.tagName.toLowerCase()&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(a,"post_fixed")&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(a,"_ads_promoted_post")||!s&&!n&&Wall.cmp(a.id,P.id)<0);)a=b?a.nextSibling:a.previousSibling;++h,a?Wall.cmp(a.id,P.id)?(l=a,(r=b?a.previousSibling:a.nextSibling)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"_ads_promoted_post")&&(l=r),b?(p!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(l)&&Wall.sendInsertBeforeError(),p.insertBefore(P,l)):(p!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(l.nextSibling)&&Wall.sendInsertBeforeError(),p.insertBefore(P,l.nextSibling))):(p.replaceChild(P,a),a=P,--h):b?p.appendChild(P):p.insertBefore(P,p.firstChild),i=P,Object(_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_31__.c)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.O)("textarea",P),{fast:1})}}else{var D=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(P.id);D?p.replaceChild(P,D):p.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(P,p.firstChild):p.appendChild(P)}if(u.length)for(var M=0,g=u.length;M<g;++M){var f=u[M];if(f.beforePost||f.afterPost){for(var T="no_position",C=b?p.firstChild:p.lastChild;C;C=b?C.nextSibling:C.previousSibling){l=null;var L=m(C);if(L){if(f.beforePost===L?l=C:f.afterPost===L&&(l=C.nextSibling),l&&(l.previousSibling&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(l.previousSibling,"_ads_promoted_post")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(l,"_ads_promoted_post"))){l=null,T="ads_sibling";break}if(l){p!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(l)&&Wall.sendInsertBeforeError(),p.insertBefore(f.el,l),T=!1;break}}}T&&Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.bb)("debug_watch",1,"js_page_ads_promoted_post_no_position",T)}}s&&!h?cur.wallTopFinished=cur.oid:n&&!h?cur.wallArchiveFinished=cur.oid:c&&!h&&(cur.wallDonutFinished=cur.oid),"full_own"!==t&&"full_all"!==t||(Pagination.recache(h),FullWall.updateSummary(cur.pgCount)),Wall.update(),wall.addReplyNames(e),Wall.updateMentionsIndex(),h&&Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.l)().updateCurrentPlaying()},showMore:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox();if(!cur.wallLayer){if("suggested"===cur.wallTab)return Wall.suggestMore();if(!(cur.wallTypeLoading&&cur.wallTypeLoading[cur.wallType]||"top"===cur.wallType&&cur.wallTopFinished===cur.oid||"archive"===cur.wallType&&cur.wallArchiveFinished===cur.oid||"donut"===cur.wallType&&cur.wallDonutFinished===cur.oid)){var o=cur.wallType,i="top"===o,r="archive"===o,a="donut"===o,l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_more_link"),s=cur.wallLoading=cur.oid,n=i&&!!cur.wallTopOnlyCache,c="";0!==_&&(c=r?cur.wallArchiveNextFrom:i?cur.wallTopNextFrom:a?cur.wallDonutNextFrom:cur.wallNextFrom),cur.wallTypeLoading=cur.wallTypeLoading||{},cur.wallTypeLoading[o]=!0,t=!0===t&&!_,ajax.post("al_wall.php",{act:"get_wall",owner_id:cur.oid,offset:_,type:o,fixed:cur.options.fixed_post_id||"",wall_start_from:c,onlyCache:n},{onDone:function(l,n,c,d){return e&&uiTabs.hideProgress(e),s!==cur.oid||o!==cur.wallType?(delete cur.wallLoading,void delete cur.wallTypeLoading[o]):i&&isObject(l)&&l.wait?(cur.wallTopLoadingDelay=cur.wallTopLoadingDelay?cur.wallTopLoadingDelay+100:200,void(cur.wallTopLoadingDelay<500?setTimeout((function(){delete cur.wallLoading,delete cur.wallTypeLoading[o],Wall.showMore(_)}),cur.wallTopLoadingDelay):(delete cur.wallLoading,delete cur.wallTypeLoading[o],cur.wallTopOnlyCache=!1,Wall.showMore(_)))):(delete cur.wallTopLoadingDelay,cur.wallVideos&&each(c,(function(_,e){cur.wallVideos[_]&&(cur.wallVideos[_].list=cur.wallVideos[_].list.concat(e.list))})),r?cur.wallArchiveNextFrom=d:i?cur.wallTopNextFrom=d:a?cur.wallDonutNextFrom=d:cur.wallNextFrom=d,void setTimeout((function(){Wall.receive(l,n,o,t),_||o!==cur.wallType||Wall.showWall(),delete cur.wallLoading,delete cur.wallTypeLoading[o]}),0))},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind(l),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind(l)})}}},showWall:function(){wall.switchTabContent(cur.wallType);var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("wall_module",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_posts")))[1];_<Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)()&&Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(_-15)},checkTextLen:function(_,e,t){var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Emoji.editableVal(_).replace(/\n\n\n+/g,"\n\n"));if(_.lastLen!==o.length||t){var i=_.lastLen=o.length,r=(cur.options||{}).max_post_len||(window.mvcur||{}).maxReplyLength,a=i-o.replace(/\n/g,"").length;e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(e),i>r-100||a>4?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(e),e.innerHTML=i>r?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_recommended_exceeded",i-r):a>4?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_recommended_lines",a-4):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("text_N_symbols_remain",r-i)):hide(e),window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()}else window.FullWall&&cur.onepost&&FullWall.onePostOnScroll()},checkPostLen:function(_,e,t,o){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_);if(t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(t).replace(/\n\n\n+/g,"\n\n"),i&&(i.lastLen!==t.length||o)){var r=i.lastLen=t.length,a=cur.options.max_post_len,l=r-t.replace(/\n/g,"").length,s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(e);r>a-100||l>4?(s.innerHTML=r>a?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_recommended_exceeded",r-a):l>4?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_recommended_lines",l-4):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("text_N_symbols_remain",a-r),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(s)):hide(s)}},postChanged:function(_){var e,t=Wall.isPosterEditorOpen();if((t||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)("submit_post"))&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"),"shown")||Wall.showEditPost(),vk.id&&!vk.widget&&!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)){clearTimeout(cur.postAutosave);var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(cur.oid)==vk.id?Wall.saveDraft:Wall.saveOwnerDraftText.pbind(cur.oid);!0===_?o():cur.postAutosave=setTimeout(o,10===_?10:1e3)}t||setTimeout(Wall.checkPosterAvailability)},ownerDraftKey:function(_){return"wall_draft"+vk.id+"_"+_},ownerDraftData:function(){return cur.wallDraftData||(cur.wallDraftData={}),cur.wallDraftData},addOwnerDraftMedia:function(_,e){var t;if(!(null===(t=cur.options)||void 0===t?void 0:t.no_draft)){var o=Wall.ownerDraftData(),i=e[0],r=e[1],a=e[2];o._attach_cache=o._attach_cache||{},a?o._attach_cache[i+r]=a:a=o._attach_cache[i+r],o.attaches=o.attaches||[];var l=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.get(Wall.ownerDraftKey(_))||{};!1!==i?o.attaches.push([i,r,a,o.attaches.length]):!1===i&&void 0!==r&&(o.attaches=o.attaches.filter((function(_){return _[3]!==r}))),_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.set(Wall.ownerDraftKey(_),extend(l,{txt:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Wall.getDraftData().message||""),medias:o.attaches}))}},cleanOwnerDraftMedia:function(_){var e;if(!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)){var t=Wall.ownerDraftData(),o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.get(Wall.ownerDraftKey(_))||{};t.attaches=[],_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.set(Wall.ownerDraftKey(_),extend({txt:""},o,{medias:[]}))}},saveOwnerDraftText:function(_){var e;if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)){var t=Wall.ownerDraftData(),o=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.get(Wall.ownerDraftKey(_))||{},i=Wall.getDraftData(),r=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(i.message||""),a=null;if(t.txt=r,each(o.medias||{},(function(_,e){switch(e[0]){case"postpone":i.postpone&&(o.medias[_][1]=i.postpone,o.medias[_][2].draft=1);break;case"poll":var t=(cur.wallAddMedia||{}).pollData(!0,!0);t&&extend(o.medias[_][2],t);break;case"copyright":var r=(cur.wallAddMedia||{}).copyrightData(!0);r&&extend(o.medias[_][2],r);break;case _web_donut__WEBPACK_IMPORTED_MODULE_34__.a:i[_web_donut__WEBPACK_IMPORTED_MODULE_34__.a]&&(o.medias[_][2]=Object.assign(o.medias[_][2]||{},{[_web_donut__WEBPACK_IMPORTED_MODULE_34__.a]:i[_web_donut__WEBPACK_IMPORTED_MODULE_34__.a]}))}})),r&&i.bkg_id&&(a={id:i.bkg_id},cur.poster&&cur.poster.isCustomBkgId(i.bkg_id)&&extend(a,cur.poster.getCustomBkg()),o.bkg_id&&delete o.bkg_id),extend(o,{txt:r,bkg:a}),cur.shareShowImg&&extend(o,{shareShowImg:cur.shareShowImg}),_<0){var l=cur.poster?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("_submit_post_box",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("official"));extend(o,{from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(l,"from-oid")||vk.id,signed:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("signed")?1:0}),Object(_web_donut__WEBPACK_IMPORTED_MODULE_34__.d)(l,cur.wallAddMedia)?o.donutOnly=1:delete o.donutOnly}_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.set(Wall.ownerDraftKey(_),o)}},getOwnerDraft:function(_){var e;if(null===(e=cur.options)||void 0===e?void 0:e.no_draft)return[];var t=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.get(Wall.ownerDraftKey(_))||[],o={from:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(t.from),signed:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(t.signed),shareShowImg:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(t.shareShowImg)};return Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(t.donutOnly)&&(o.donutOnly=1),[t.txt,t.medias,!0,o,t.bkg]},saveOwnerDraftMedia:function(_,e,t,o){var i;if(!(null===(i=cur.options)||void 0===i?void 0:i.no_draft)){Wall.cleanOwnerDraftMedia(_);var r=cur.wallAddMedia||{},a=[],l=(cur.wallAddMedia?r.getMedias():[]).slice().map((function(_){return _.slice(0,2)}));void 0!==t&&e?a=[[e,t,o]]:e||void 0===t||l.splice(t,1),l=l.concat(a),each(l,(function(){Wall.addOwnerDraftMedia(_,this)}))}},saveDraft:function(){var _;if(cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia),!(null===(_=cur.options)||void 0===_?void 0:_.no_draft))if(cur.noDraftSave)cur.noDraftSave=!1;else if(!cur.postSent&&vk.id==Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(cur.oid)){var e=Wall.getDraftData();e.delayed||ajax.post("al_wall.php",Wall.fixPostParams(extend({act:"save_draft",hash:cur.options.post_hash},e)),{onFail:function(){return!0}})}},getDraftData:function(){var _;if(null===(_=cur.options)||void 0===_?void 0:_.no_draft)return{};var e=cur.wallAddMedia||{},t=e.chosenMedia||{},o=cur.wallAddMedia?e.getMedias():[],i=e.shareData||{},r="",a=0,l=null;if(Wall.isPosterEditorOpen())l=(r=cur.poster.getText())?cur.poster.getBkgId():null;else{var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field");r=window.Emoji?Emoji.editableVal(s):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(s),r=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(r)}var n={message:r,bkg_id:l};return Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(t)&&t.length&&o.push(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.d)(t)),o.length&&each(o,(function(_,t){if(t){var o=this[0],l=this[1];switch(o){case"poll":var s=e.pollData(!0,!0);if(!s)return n.delayed=!0,!1;l=s.question,delete s.question,n=extend(n,s);break;case"copyright":var c=e.copyrightData(!0);if(c)return void(n=extend(n,c));break;case"share":if(i.failed||!i.title&&(!i.images||!i.images.length)&&!i.photo_url&&!i.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(n.delayed=!0,!1):void 0;i.video?(l=i.video_owner_id+"_"+i.video_id,n.snippet_video=1):l=i.user_id&&i.photo_id&&!i.noPhoto?i.user_id+"_"+i.photo_id:"",i.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(r)==i.initialPattern&&(n.message=""),i.is_vk_mini_app&&(n.is_vk_mini_app=!0,n.is_photo_edit=i.isPhotoEdit,n.image_offset=cur.shareShowImg),n=extend(n,{url:i.url,module:cur.module,mode:i.mode,title:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(i.title),description:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(i.description),button_text:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(i.button_text),button_action:i.button_action,extra:i.extra,extra_data:i.extraData,photo_url:i.video?"":Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(i.photo_url),open_graph_data:(i.openGraph||{}).data,open_graph_hash:(i.openGraph||{}).hash});break;case"page":i.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(r)==i.initialPattern&&(n.message="");break;case"postpone":var d=+e.postponeDate;return void(n=extend(n,{postpone:d}));case"mark_as_ads":return void(n=extend(n,{mark_as_ads:1}));case _web_donut__WEBPACK_IMPORTED_MODULE_34__.a:return void(n=extend(n,Object(_web_donut__WEBPACK_IMPORTED_MODULE_34__.f)(t)))}this[3]&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(r)==this[3]&&(n.message=""),n["attach"+(a+1)+"_type"]=o,n["attach"+(a+1)]=l,a++}})),n},setDraft:function(_){var e;if(!(null===(e=cur.options)||void 0===e?void 0:e.no_draft)&&(_[0]||_[1]&&_[1].length||null!=_[4])){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field");if(t){var o=_[4];o||Emoji.val(t,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(_[0]||"")).replace(/\n/g,"<br/>")),Wall.showEditPost((function(){setTimeout((function(){if(o&&cur.poster){Wall.hidePosterFeatureTooltip();var e={text:_[0]||""};if(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.A)(o)?e.bkgId=_[4]:isObject(o)&&(cur.poster.isCustomBkgId(o.id)&&cur.poster.addCustomBkg(o),e.bkgId=o.id),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(Wall.getMainPostBlock()))return cur.poster.setBkg(e.bkgId,!0),cur.poster.setText(e.text),void Emoji.val(t,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(_[0])).replace(/\n/g,"<br/>"));Wall.openPosterEditor(e)}if(_[1]&&cur.wallAddMedia)for(var i in _[1])cur.noDraftSave=!0,cur.wallAddMedia.chooseMedia.apply(cur.wallAddMedia,_[1][i]);Wall.checkPosterAvailability(),Wall.saveDraft()}),0)})),_[2]&&wall.focusOnEnd(),_[3]&&(wall.setReplyAsGroup(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("official"),_[3]),_[3].shareShowImg&&(cur.shareShowImgRestored=_[3].shareShowImg),_[3].donutOnly&&cur.wallAddMedia&&cur.wallAddMedia.donutPostSettings&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly&&cur.wallAddMedia.donutPostSettings.setPostDonutOnly()),cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}}},initPostEditable:function(_){var e=cur.postField;if(!e||e.emojiInited)return!1;e.emojiInited=!0,stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.init(e,{ttDiff:-42,rPointer:!0,controlsCont:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(e),noStickers:!0,onSend:Wall.sendPost,noEnterSend:!0,ref:"post",checkEditable:Wall.postChanged,initUploadForImagePasteCallback:function(_,e,t){window.Upload&&Upload.onFileApiSend(cur.wallUploadInd,[t])}}),addClass(e,"submit_post_inited"),_?setTimeout(Wall.setDraft.pbind(_),0):cur.postFieldZoomText&&cur.postFieldZoomText(cur.postField,cur.wallAddMedia)})),setTimeout((function(){cur.postFieldZoomText&&addEvent(e,"keydown paste",(function(){setTimeout((function(){cur.postFieldZoomText(cur.postField,cur.wallAddMedia)}),0)}))}),0)},showEditPost:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field");if(cur.viewAsBox)return setTimeout((function(){e.blur()}),0),cur.viewAsBox();0!==cur.editing&&(setTimeout(WallUpload.init,0),Wall.initComposer(e,{lang:{introText:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("profile_mention_start_typing"),noResult:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("profile_mention_not_found")},checkLen:Wall.postChanged,onValueChange:Wall.onPostValChange,onItemSelect:Wall.onPostItemSelect},_),Wall.hideEditPostReply(),addClass("submit_post_box","shown"),cur.editing=0,Wall.showPosterFeatureTooltip(),Wall.showPostCopyrightFeatureTooltip(),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(cur.onShowEditPost)&&cur.onShowEditPost(),cur.wallAdsReplacedFeatureTooltip&&Wall.showAdsReplacedTooltip(),window.cur.wallBestFriendsSettingsFeatureTooltip&&Wall.showBestFriendsSettingsFeatureToolTip(),stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")]))},postBoxFocus:function(_,e){Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.j)(_||window.event);var t=Wall.isPosterEditorOpen();(cur.postField&&window.Emoji||t)&&setTimeout((function(){e?t?(cur.poster.focusPoster(),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(cur.poster.getPosterElement())[1]-15)):(Emoji.focus(cur.postField),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(cur.postField)[1]-15)):t?cur.poster.focusPoster():Emoji.focus(cur.postField,!0,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"))}),0)},initComposer:function(_,e,t){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"composer"))t&&t();else if(cur.composerAdded){var o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}else stManager.add(["wide_dd.css","wide_dd.js"],(function(){cur.composerAdded=!0;var o=Composer.init(_,e);t&&t(),cur.destroy.push(Composer.destroy.bind(Composer).pbind(o))}))},deinitComposer:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"composer");e&&Composer.destroy(e),_.emojiId&&window.Emoji&&Emoji.destroy(_.emojiId)},hasComposerMedia:function(_){var e=_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"composer");return!(!e||!e.addMedia)&&e.addMedia.attachCount()>0},composerListShown:function(_){var e=_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"composer");if(!e)return!1;var t=e.wdd,o=0;for(var i in t.shown)o+=1;return!!(t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(t.listWrap)&&o)},onPostValChange:function(_){if(cur.wallAddMedia&&cur.wallAddMedia.checkMessageURLs.apply(window,arguments),"full_own"!=cur.wallType&&"full_all"!=cur.wallType||Pagination.pageTopUpdated(),browser.msie&&!_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field");hide(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.H)(e)}},onPostItemSelect:function(_){if(_&&!(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(_[0])>=0)&&cur.wallAddMedia){var e="vk.com/event"+-_[0];cur.wallAddMedia.checkMessageURLs(e,!0)}},hideEditPost:function(_){cur.editing=!1;var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field"),t=cur.wallAddMedia||{},o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e));!browser.opera_mobile&&e&&(!_&&(o||t.chosenMedia||t.getMedias&&t.getMedias().length>0||t.activeState||t.attachCount&&t.attachCount()>0)||(removeClass("submit_post_box","shown"),e&&!o&&cur.postMention&&(cur.postMention.options.minHeight=cur.emptyPostheight||14),cur.onWallSendCancel&&cur.onWallSendCancel(),window.WallUpload&&WallUpload.hide(),cur.wallAddMedia&&cur.wallAddMedia._hideAddMedia(!0)))},clearInput:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("page_add_media");var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field");if(Wall.withMentions){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"mention");e&&(e.rtaEl.innerHTML="",hide(e.cont),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(_))}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(_,""),_.blur(),_.phonblur(),Wall.hideEditPost(!0),cur.wallAddMedia&&cur.wallAddMedia.unchooseMedia(),Wall.resetPostVisibilityAccess(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)("export_status",!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)("close_comments",!1),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.forEach(_=>{_()});var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"composer");t&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(t.articleConvertEl),t.articleConvertEl=!1)},fixPostParams:function(_){var e=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.d)(_);return e.Message=_.message,delete e.message,e},focusOnEnd:function(_){if(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field"))if("TEXTAREA"!=_.tagName){var e=_.innerHTML?_.innerHTML.length:_.length?_.length:_.childNodes.length-1;if(_.focus(),document.selection){var t=document.selection.createRange();t.moveStart("character",e),t.select()}else window.getSelection().collapse(_,_.childNodes.length)}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.H)(_)},isAnonPost:function(){var _=geByClass1("anon_toggle");return _&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(geByClass1("_ui_toggler",_),"on")?1:""},saveAnon:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(geByClass1("_ui_toggler",_),"on");var e=Wall.isAnonPost();Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)("friends_only",!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)("best_friends_only",!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)("status_export",!e),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)("facebook_export",!e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"),"anon_field_on");var t=cur.anonPostBtn||Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_send");cur.anonPostBtn=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("send_post").innerHTML,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("send_post").innerHTML=e?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_send"):t},showPostSettings:function(_,e){var t=cur.wallAdsReplacedFeatureTooltip&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"addpost_opt");if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"ett")||t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_),i=o&&o.querySelector(".Post__copyrightButton");t&&Wall.hideAdsReplacedTT(),new ElementTooltip(_,{cls:"post_settings_tooltip"+(i?" post_settings_tooltip_with_custom_btn":""),content:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(o),defaultSide:"top",offset:[0,-5],appendTo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_)}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(o)}e&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.e)(e)&&"click"===e.type&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"ett").toggle()},saveExport:function(_,e,t){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("friends_only")||Wall.isAnonPost()||Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(_),cur.saveExportTO=cur.saveExportTO||{},clearTimeout(cur.saveExportTO[e]),cur.saveExportTO[e]=setTimeout((function(){ajax.post("/al_settings.php",{act:"a_save_export",service:e,disabled:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(_)?0:1,hash:t})}),300)},togglePostVisibilityAccess:function(_,e,t,o){var i=Wall.isAnonPost(),r=!!t;if(!i||r){t=t||"";var a="post_visibility_btn",l=cur[a+t];l&&l.hide(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.r)(_,e,"post_settings_btn"+a+t);var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_visibility_btn"+t),n=r?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wpe_status_export"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("status_export"),c=r?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wpe_facebook_export"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("facebook_export"),d=geByClass1("post_action_btn_text",s),b=![_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.ONLY_FRIENDS,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.ONLY_BEST_FRIENDS].includes(e);if(e===_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.ONLY_BEST_FRIENDS){var p=(window.event||{}).target,u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("best_friends_only"+t).querySelector(".PostVisibilityBestFriendsOnlyOption"),E=Number(u.dataset.count);p&&p.closest(".PostVisibilityBestFriendsOnlyOption__editLink")||0===E?(Object(_web_BestFriends_analytics__WEBPACK_IMPORTED_MODULE_51__.b)(_web_BestFriends_analytics__WEBPACK_IMPORTED_MODULE_51__.a.editBestFriends),this.resetPostVisibilityAccess(),stManager.add([jsc("web/best_friends.js"),"BestFriends.css"],()=>{window.bestFriendsBoxSettings(_=>{var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("best_friends_only"+t);if(0===_)e.innerHTML=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.n)("visibility_access_best_friends_only_option",{html:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_choose_best_friends"),count:_}),this.togglePostVisibilityAccess(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("no_friends_only"+t),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.PUBLIC,t,!0);else{var o=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_best_friends_settings_box_conversation_friends_count",_);e.innerHTML=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.n)("visibility_access_best_friends_only_option",{html:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.n)("visibility_access_best_friends_only_item",{count_text:o}),count:_}),this.togglePostVisibilityAccess(e,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.ONLY_BEST_FRIENDS,t,!0)}})})):(Object(_web_BestFriends_analytics__WEBPACK_IMPORTED_MODULE_51__.b)(_web_BestFriends_analytics__WEBPACK_IMPORTED_MODULE_51__.a.selectBestFriends),d.innerHTML=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_best_friends_only"),d.setAttribute("aria-label",Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_best_friends_only")),addClass(s,"best_friends_only"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(n,!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(c,!1))}else if(b){var O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("no_friends_only"+t).innerHTML;d.innerHTML=O,d.setAttribute("aria-label",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(O)),removeClass(s,"on"),removeClass(s,"best_friends_only")}else{var h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("friends_only"+t),w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(h);d.innerHTML=w,d.setAttribute("aria-label",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(w)),addClass(s,"on"),removeClass(s,"best_friends_only"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(n,!1),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(c,!1)}n&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(n,!b),c&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(c,!b),o||Wall.postChanged()}},resetPostVisibilityAccess(){Wall.canChangeVisibilityForNewPost()&&Wall.togglePostVisibilityAccess(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("no_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.PUBLIC,!1,!0)},canChangeVisibilityForNewPost:()=>!!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_visibility_btn"),initPostVisibilitySelector(_){Wall.canChangeVisibilityForNewPost()&&Object(_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_41__.a)("post_visibility_btn",_.id)},cantAccessDonutPosts:()=>!1===window.cur.donutGroupUserHasWallAccess,togglePostMarkAsAds:function(_,e){e=e||"mute_notifications";var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(e);if(t){var o=Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(_);if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(t,o),o)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"prev-state",+Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(t)),addClass(t,"on");else{var i=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"prev-state");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(t,"on",i)}}},needCheckSign:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("check_sign");return _&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(_)},saveCheckSign:function(_){var e=Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"title",e?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_check_sign_disabled"):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_check_sign_enabled")),window.tooltips&&tooltips.hide(_,{onHide:_.onmouseover.bind(_)}),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(_,!e)},checkAsGroup:function(_){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(_),wall.setReplyAsGroup(_,{fromGroup:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(_)})},sendPost:function(_,e){var t=cur.wallAddMedia||{},o=t.chosenMedia||{},i=cur.wallAddMedia?t.getMedias():[],r=t.shareData||{},a=cur.poster&&!!e,l=a?e.text:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)((window.Emoji?Emoji.editableVal:_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field"))),s=!1,n=Wall.isAnonPost(),c=a?null:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("send_post"),d=cur.options.suggesting?"suggest":cur.wallType;"top"===d&&(d="all"),a&&(i=i.filter(_=>{if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(_)){var e=_slicedToArray(_,1)[0];return["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_34__.b].includes(e)}}));var b=a?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("_submit_post_box",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("official")),p=Object(_web_donut__WEBPACK_IMPORTED_MODULE_34__.d)(b,t),u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(b,"from-oid")==cur.postTo?1:"";b&&cur.postTo||u||cur.defaultPostSettings&&(u=cur.defaultPostSettings.official?1:"");var E={act:"post",message:l,to_id:cur.postTo,type:d,friends_only:!n&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("friends_only"),best_friends_only:!n&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("best_friends_only"),check_sign:Wall.needCheckSign(),status_export:!n&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("status_export"),close_comments:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("close_comments")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("close_comments")?1:0:"",mute_notifications:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("mute_notifications")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("mute_notifications")?1:0:"",mark_as_ads:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("mark_as_ads")?1:0,official:u,signed:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)("signed"),anonymous:n,hash:cur.options.post_hash,from:cur.from?cur.from:"",fixed:cur.options.fixed_post_id||"",situational_suggest_id:cur.options.situational_suggest_id||null},O=0;extend(E,Object(_web_donut__WEBPACK_IMPORTED_MODULE_34__.e)(p,t)),cur.options.additional_save_params&&(E=extend(E,cur.options.additional_save_params));var h,w=cur.wallAddMedia&&cur.wallAddMedia.id||"";function v(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)("submit_post_error")||(Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.l)("submit_post_error",100),Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.b)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("box_layer_wrap"),{scrollTop:0})),Wall.isPosterEditorOpen()){var t=cur.poster.getErrorWrapperElement();t.innerHTML="",t.appendChild(e)}}if(extend(E,Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_39__.a)(String(w))),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(o)&&o.length&&i.push(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.d)(o)),a&&(E.poster_bkg_id=e.bkgId,E.poster_bkg_access_hash=e.accessHash,e.fallbackObj&&(i.push(["photo",e.fallbackObj.owner_id+"_"+e.fallbackObj.id,!1]),E.poster_photo_hash=e.fallbackObj.post_hash),E.poster_bkg_id!==cur.posterCtaBkgId&&(E.poster_author_bkg_check=!0)),hide("submit_post_error"),i.length){var m=0;h=!1,each(i,(function(_,e){var o;if(e){var a=this[0],b=this[1];switch(a){case"video":if(s||"suggest"==d)break;var p=Wall.getOwnerDraft(cur.oid)[1];if(!p)break;each(p,(function(_,e){e[1]===b&&e[2]&&e[2].upload_new&&m++}));break;case"poll":if(n)return;var u=t.pollData();if(!u)return h=!0,!1;b=u.question,delete u.question,E=extend(E,u);break;case"copyright":if(n)return;var w=t.copyrightData();if(w)return void(E=extend(E,w));break;case"share":if(r.failed||!r.title&&(!r.images||!r.images.length)&&!r.photo_url&&!r.video)return cur.shareLastParseSubmitted&&Date.now()-cur.shareLastParseSubmitted<2e3?(h=!0,!1):void 0;if((cur.options.share||{}).button_exclusive&&r.button_text&&r.button_action){var P;i.length>1&&(P=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_share_too_many_attachments")),l.split("\n").length-1>(cur.options.share||{}).button_exclusive_max_message_newlines&&(P=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_share_too_many_newlines")),l.length>(cur.options.share||{}).button_exclusive_max_message_len&&(P=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_share_too_long_message"));var D=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.j)(" "+l+" "),M=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.j)(" "+r.url+" ")[0];if(M&&D.length){"/"===M.query&&(M.query=""),"www."===M.domain.substr(0,4)&&(M.domain=M.domain.substr(4));for(var g=0;g<D.length;++g){var f=D[g];if("/"===f.query&&(f.query=""),"www."===f.domain.substr(0,4)&&(f.domain=f.domain.substr(4)),M.domain!=f.domain||M.query!=f.query){P=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_share_too_many_links");break}}}if(P)return v(P),h=!0,!1}if(!r.title)return v(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_share_title_required")),h=!0,!1;if(!r.url)return v(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_share_url_required")),h=!0,!1;if(r.url=new URL(r.url).href,r.video?(b=r.video_owner_id+"_"+r.video_id,E.snippet_video=1):b=r.user_id&&r.photo_id&&!r.noPhoto?r.user_id+"_"+r.photo_id:"",r.share_upload_failed&&!b)return void(r.share_upload_failed=0);if(r.images&&r.images.length&&!Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(r.images[cur.shareShowImg])&&!b&&!r.noPhoto&&!r.share_own_image&&!r.video)return Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(c),t.uploadShare((function(){Wall.sendPost(!0)})),h=!0,!1;if((cur.options.share||{}).require_image&&!b)return v(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_share_image_required")),h=!0,!1;r.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(l)==r.initialPattern&&(E.message=""),r.is_vk_mini_app&&(E.is_vk_mini_app=!0,E.is_photo_edit=r.isPhotoEdit,E.image_offset=cur.shareShowImg),E=extend(E,{url:r.url,module:cur.module,mode:r.mode,title:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(r.title),description:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(r.description),button_text:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(r.button_text),button_action:r.button_action,extra:r.extra,extra_data:r.extraData,photo_url:r.noPhoto||r.video?"":Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.F)(r.photo_url),open_graph_data:(r.openGraph||{}).data,open_graph_hash:(r.openGraph||{}).hash});break;case"page":r.initialPattern&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(l)==r.initialPattern&&(E.message="");break;case"postpone":if(n)return;var T=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("postpone_date"+t.lnkId);return E=extend(E,{postpone:T}),cur.postponedLastDate=T,void(s=!0);case"mark_as_ads":return void(E=extend(E,{mark_as_ads:1}));case"pretty_cards":if(!t.prettyCardGallery)return;if(t.prettyCardGallery.needSendData())return t.prettyCardGallery.saveCards(Wall.sendPost,(function(_){v(_)})),h=!0,!1;var C=t.prettyCardGallery.getSendData();b=C.attachVal;break;case"podcast":if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(this[2],"attach_disabled"))return!1;break;case _web_donut__WEBPACK_IMPORTED_MODULE_34__.b:return;case"donut_link":E["attach"+(O+1)+"_owner_id"]=null===(o=this[5])||void 0===o?void 0:o.owner_id}this[3]&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(l)==this[3]&&(E.message=""),n&&"photo"!==a||(E["attach"+(O+1)+"_type"]=a,E["attach"+(O+1)]=b,O++)}}));var P=cur.postTo<0||cur.postTo===vk.id;if(cur.wallUploadVideoOpts&&cur.wallUploadVideoOpts.vars.is_wall_postponed_allowed&&P&&m&&!_&&!cur.postponeVideoPost)return Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)()&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)().hide(),void Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.b)("al_video.php?act=postponed_post_box",{videos_count:m},{onDone:function(_,e){_.removeButtons(),_.addButton(e.video_post_later_text,(function(){cur.postponeVideoPost=!0,Wall.sendPost(!0),_.hide()})),_.addButton(e.video_post_now_text,(function(){Wall.sendPost(!0),_.hide()}),"no")}});if(h)return void(_&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(c))}if(!O&&!l)return _&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(c),void Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.H)("post_field");if(!c||_||!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.k)(c)){cur.postponeVideoPost&&(E=extend(E,{postpone_video:!0,postpone_video_hd:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("postponed_post_hd"))})),cur.postAutosave&&clearTimeout(cur.postAutosave),hide("submit_post_error"),cur.postSent=!0;var D=window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()?1:0;E.update_admin_tips=D;var M=Object(_web_donut__WEBPACK_IMPORTED_MODULE_34__.g)(t,cur.oid);E.donut_duration&&-1!==E.donut_duration&&M&&!cur.donutAttachesApproved?Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)({title:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("publish_postponed_title"),onHide:()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(c)}},Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_publish_donut_freeing_attaches_confirmation_title"),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("publish_postponed_btn"),()=>{Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)().hide(),cur.donutAttachesApproved=!0,Wall.sendPost(_,e)},Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_cancel"),()=>{Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)().hide(),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(c)}):setTimeout((function(){ajax.post("al_wall.php",Wall.fixPostParams(E),{onDone:function(_,e,o,i){Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.A)(o)||(o=null),cur.poster&&a&&(cur.poster.unlockEditPoster(),cur.poster.closeEditor(),cur.poster.resetPoster(),cur.posterCtaBkgId&&(cur.posterCtaBkgId=null)),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),Wall.clearInput(),cur.postSent=!1,cur.postponeVideoPost=!1,cur.donutAttachesApproved=!1;var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("mark_as_ads"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("mute_notifications");if(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(r)&&l&&(removeClass(l,"on"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(l,0)),r&&(removeClass(r,"on"),t.donutUpdateVisibility()),cur.options.onSendPostDone)cur.options.onSendPostDone.apply(window,arguments);else{if(i&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.f)(i),!isObject(_)||!_.redirect){if(Object(_wall_tabs_utils__WEBPACK_IMPORTED_MODULE_47__.b)(),s){if("feed"==d)Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.f)(_,{out:3e3});else if("full_own"==d||"full_all"==d)return Wall.showPostponedFull(_);return wall.updateTabVisibility("page_wall_postponed",!0),void Wall.showPostponed(!1,_)}if(("full_own"==d||"full_all"==d)&&(cur.pgStart||nav.objLoc.postponed)){var n=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.d)(nav.objLoc);return delete n.offset,delete n.postponed,vk.id!=cur.oid&&delete n.own,nav.go(n)}if(vk.id!=cur.oid&&"full_own"==d){var c=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.d)(nav.objLoc);return delete c.own,nav.go(c)}return"feed"==d?cur.wallPostCb():"suggest"==d?(wall.updateTabVisibility("page_wall_suggest",!0),Wall.showSuggested(!1,_,e),Wall.suggestUpdate()):void(p?Wall.showDonutWall(_):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_tabs")&&geByClass1("ui_tab",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_tabs")).click(),Wall.receive(_,e),cur.onWallSendPost&&cur.onWallSendPost(),D&&null!==o&&window.GroupsAdminTips&&window.GroupsAdminTips.refreshSection(o)))}nav.go(_.redirect)}},onFail:function(_){if(cur.postSent=!1,cur.postponeVideoPost=!1,cur.donutAttachesApproved=!1,cur.poster&&a&&cur.poster.unlockEditPoster(),cur.posterFeatureTT&&cur.posterFeatureTT.hide(),!cur.options.onSendPostFail){if(!_)return!0;var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_error");if(e.innerHTML=_.length>60?'<div class="msg_text">'+_+"</div>":_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)("submit_post_error")||Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.l)("submit_post_error",100),Wall.isPosterEditorOpen()){var t=cur.poster.getErrorWrapperElement();t.innerHTML="",t.appendChild(e)}return!0}cur.options.onSendPostFail.apply(window,arguments)},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(c)},hideProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(c)},noSort:!0})}),0)}},_repliesLoaded:function(_,e,t,o,i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_);if(r){var a=r.nextSibling;if(e){var l=r.offsetHeight;r.innerHTML=t,Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)()+(r.offsetHeight-l),0,void 0,!0),setTimeout(Wall.scrollHighlightReply.pbind("post"+e),0)}else r.innerHTML=t;if(a&&"replies_open"==a.className&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(a),ajax._framenext(),_==cur.wallLayer){var s=wkcur.reverse;extend(wkcur,{offset:!s&&i.offset||0,loaded:i.num||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply",r,"div").length,count:i.count}),wall.addReplyNames(o),WkView.wallUpdateReplies(),s||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll())}else wall.addReplyNames(o),Wall.repliesSideSetup(_);Wall.updateMentionsIndex(),setTimeout((function(){Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.l)().updateCurrentPlaying()}),10),i&&Likes.updateComments("wall"+_,i.count)}},repliesSideSetup:function(_){if(cur.wallLayer!=_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_);if(e){var t=geByClass1("wr_header",e,"a"),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(o,"deep_active"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_side"+_);if(cur.wallMyOpened[_]&&(t||i)){if(!r){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)('<div class="replies_side_wrap"><div id="replies_side'+_+'" class="replies_side"></div></div>');e.parentNode.insertBefore(a,e),(r=a.firstChild).onmouseover=Wall.repliesSideOver.pbind(_),r.onmouseout=Wall.repliesSideOut.pbind(_),r.onclick=i?Wall.hideDeepReplies.pbind(_):Wall.repliesSideClick.pbind(_)}e.onmouseover=Wall.repliesSideOver.pbind(_),e.onmouseout=Wall.repliesSideOut.pbind(_),Wall.repliesSideOver(_)}else hide(r),e.onmouseover=null,e.onmouseout=null}}else WkView.wallUpdateReplies()},repliesSideClick:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_),t=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)(),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(e)[1];return t>o&&Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(o-100,0),hide("replies_side"+_),Wall.showReplies(_,3,!1)},repliesSideOver:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_side"+_);if(e){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(t))[1],i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(t)[1],r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(e)[1],a=e.offsetHeight,l=window.lastWindowHeight||0,s=o+i-l+15,n=r+a-l;cur.wallRepliesSideOver=[_,t,s,n],Wall.repliesSideUpdate()}},repliesSideOut:function(_){cur.wallRepliesSideOver&&cur.wallRepliesSideOver[0]==_&&delete cur.wallRepliesSideOver},repliesSideUpdate:function(_){var e=cur.wallRepliesSideOver;if(e){var t,o=e[1],i=e[4]||{},r=e[5]||"",a="replies_side";void 0===_&&(_=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)()),_<e[2]?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(o),t={marginTop:0,opacity:1}):_<e[3]?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(o),a+=" replies_side_fixed",t={opacity:Math.max(0,Math.min(1,(e[3]-_)/200))}):(a+=" replies_side_hidden",t={marginTop:e[3]-e[2],opacity:0,display:null}),JSON.stringify(i)!==JSON.stringify(t)&&(each(i,(function(_,e){i[_]=null})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.vb)(o,extend(i,t)),e[4]=t),r!=a&&(o&&(o.className=a),e[5]=a)}},highlightReply:function(_){(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_))&&(addClass(_,"reply_highlighted"),setTimeout((function(){removeClass(_,"reply_highlighted")}),1500))},scrollHighlightReply:function(_){if(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_))if(cur.wallLayer||_.id.match(/^post-?\d+(photo|video|market)?_\d+$/)&&(window.wkcur&&wkcur.shown||window.mvcur&&mvcur.mvShown||cur.pvShown)){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(_,!0)[1];e<0||e>lastWindowHeight-200?Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.b)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+e-50},300,Wall.highlightReply.pbind(_)):Wall.highlightReply(_)}else{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(_)[1];t<Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)()+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)("page_header")[1]?(Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(t,300),setTimeout(Wall.highlightReply.pbind(_),300)):Wall.highlightReply(_)}},showReply:function(_,e,t,o){if(cur.viewAsBox)return!1;if(o&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.d)(o))return!0;if(window.mvcur&&mvcur.post==e)return Videoview.showComment(t),!1;var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+t);if(i)Wall.scrollHighlightReply(i);else if(cur.wallLayer==e)WkView.wallShowPreviousReplies(t);else if(e.match(/market/))Market.comments(e);else{if(_.tt&&_.tt.hide&&_.tt.hide(),"full"==cur.wallType){var r=t.split("_");return delete nav.objLoc.offset,nav.go(extend(nav.objLoc,{reply:r[1]}))}Wall.showReplies(e,!1,t)}return!1},showReplies:function(_,e,t,o){if(Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.d)(o||window.event))return!0;if(cur.viewAsBox)return cur.viewAsBox();if(cur.wallLayer!=_||!wkcur.reverse){cur.wallMyOpened[_]=3!=e;var i={act:"get_replies",post:_,count:e},r={onDone:Wall._repliesLoaded.pbind(_,t),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind("wrh"+_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind("wrh"+_),local:1};if(t||e&&!(e>20)||(extend(i,{cont:"replies"+_}),extend(r,{frame:1}),cur.onFrameBlocksDone=function(){setTimeout(Wall.repliesSideSetup.pbind(_),browser.msie?100:10)}),ajax.post("al_wall.php",i,r),!browser.msie&&e>0&&e<10){for(var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_),l=a&&a.lastChild,s=[];s.length<e&&l;)"DIV"==l.tagName&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(l,"reply")&&s.push(l),l=l.previousSibling;if(s.length==e){var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply",a,"div").length;for(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(a,'<a class="wr_header wrh_all"></a>'),Wall.updateRepliesHeader(_,a.firstChild,e,n),hide("replies_side"+_);s.length;)a.appendChild(s.pop());Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)("wrh"+_)}}return!1}},moreReplies:function(_,e,t,o){var i;if(o.deep){var r=_.split("_");i={act:"get_post_replies",offset:e,owner_id:r[0],item_id:r[1],count:t},o.order&&(i.order=o.order)}else i={act:"get_replies",offset:e,post:_,count:t};return extend(i,{rev:o.rev,from:o.from}),ajax.post("al_wall.php",i,{onDone:function(e,t,i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_);o.clear?r.innerHTML=e:o.rev||o.append?r.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(e)):r.innerHTML=e+r.innerHTML,wall.addReplyNames(t),o.onDone&&o.onDone(e,t,i),Wall.updateMentionsIndex()},onFail:()=>!1,showProgress:o.showProgress,hideProgress:o.hideProgress}),!1},openDeepShortReplies:function(_,e){var t=geByClass1("replies_next",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_));return t&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(t),t.focus(),t.click(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(_)),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(e)},collapseDeepReplies:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+e);if(t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"replies_list_deep")){var o=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)(),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(_)[1],r=Math.round(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.j)()/2);cur.wallLayer?(i-=o)<r&&Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.b)(wkLayerWrap,{scrollTop:wkLayerWrap.scrollTop+i-r},300):o>i-r&&Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(i-r),Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e));var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span",{className:"progress_inline replies_next_loader"});Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(_),t.innerHTML="";var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box_wrap"+e);l&&hide(l);var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+e),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",t),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(n,"post-id"),d=wall.getRepliesOrder(c);removeClass(s,"replies_deep_has_field"),addClass(s,"replies_deep_has_short"),wall.updateRepliesOnScroll(),ajax.post("al_wall.php",{act:"get_collapsed_replies",reply_id:e,order:d},{onDone:function(_){t.innerHTML=_},onFail:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(cur.wallTpl.reply_deep_next,{post_id:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(n,"post-id"),reply_id:e,offset:0,text:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_next_n_replies",cur.options&&cur.options.replies_page_count||20),class:" replies_next_deep"}));t.appendChild(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(_)},showProgress:function(){t.appendChild(a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(a)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(a)}})}},overCollapseDeepReplies:function(_){var e=geByClass1("replies_deep_collapse_icon",_),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(e),o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.T)(e,"bottom")),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(_),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(_),a=Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)(),l=cur.wallLayer?wkLayerWrap.scrollTop:a;cur.wallLayer&&(r[1]-=a);var s,n,c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.j)(),d=r[1]+i[1],b=Object(_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_43__.a)(),p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(b)[1];cur.wallLayer?(s=l+d-c,n=l+r[1]+t[1]+o+o-c):(s=d-c,n=r[1]+t[1]+o+o-c),cur.onScrollCollapseDeepReplies=wall.updCollapseDeepRepliesIcon.pbind(_,e,{iconSize:t,iconBottom:o,collapseSize:i,collapsePos:r,fixedField:b,fixedFieldSize:p,maxFixedScroll:s,topMaxScroll:n}),addEvent(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),addEvent(window,"resize",cur.onScrollCollapseDeepReplies),cur.onScrollCollapseDeepReplies()},outCollapseDeepReplies:function(_){cur.onScrollCollapseDeepReplies&&(removeEvent(cur.wallLayer?wkLayerWrap:window,"scroll",cur.onScrollCollapseDeepReplies),removeEvent(window,"resize",cur.onScrollCollapseDeepReplies),delete cur.onScrollCollapseDeepReplies);var e=geByClass1("replies_deep_collapse_icon",_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.vb)(e,{position:null,bottom:null,left:null,right:null})},updCollapseDeepRepliesIcon:function(_,e,t){var o=cur.wallLayer?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)(),i=t.maxFixedScroll;if((cur.wallLayer&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t.fixedField,"wl_reply_form_fixed")||"full"===cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t.fixedField,"fixed"))&&(i+=t.fixedFieldSize),o<i){var r=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)((t.collapseSize[0]-t.iconSize[0])/2),a=t.topMaxScroll+t.fixedFieldSize-o,l=t.fixedFieldSize+t.iconBottom;a>0&&(l-=a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.vb)(e,{position:"fixed",bottom:l,left:t.collapsePos[0]+r,right:"auto"})}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.vb)(e,{position:null,bottom:null,left:null,right:null})},updateCollapseDeepReplies:function(_){if(cur.wallTpl&&cur.wallTpl.reply_deep_collapse){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_));if(e){_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"post-id");var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_);if(!t)return t;var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply",t).length>=2,i=geByClass1("replies_deep_collapse",e);if(o){if(i)return;i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(cur.wallTpl.reply_deep_collapse,{reply_id:_})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(i,t)}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(i)}}},showNextReplies:function(_,e,t){var o=e.split("_"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"offset"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"count"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"collapse"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"replies_prev"),s=cur.wallLayer?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)("post"+e,"reply"),c={act:"get_post_replies",owner_id:o[0],item_id:o[1],offset:i,count:r,collapse:a},d=l?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.D)(_);if(d&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(d,"reply")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(d,"replies_wrap_deep"))){var b=(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(d,"post-id")||"").split("_")[1];l?c.next_id=b:c.prev_id=b}if(n)cur.wallLayer||(s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",s));else{var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+e),u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(p,"top-ids");u&&(c.top_replies=u)}var E=s.offsetHeight,O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"post-id");c.order=wall.getRepliesOrder(O);var h=n&&wall.isDescRepliesOrder(O,c.order);h&&(l=!l);var w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span",{className:"progress_inline replies_next_loader"});return ajax.post("al_wall.php",c,{onDone:function(t,o,r){var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.p)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{innerHTML:t})),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(),d=!1;n.forEach((function(_){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"wr_header")){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_.id);e&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"reply")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"replies_wrap_deep"))||(c.appendChild(_),d=!0)}}));var b,p,u=l&&!h||!l&&h,w=!1;if(u){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+e),"replies_deep_has_short")){var v=window.innerHeight||document.documentElement.clientHeight,m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)("page_header")[1],P=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_),D=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(P)[1];b=cur.wallLayer?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)(),w=cur.wallLayer?D<v:D<b+v-m}p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(c),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(c,_)}else p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.A)(c),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(c,_);var M=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(r.num),g=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(r.offset),f=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(r.count),T=Math.max(0,g+(l?-M:M)),C=f-T,L=0;if(d&&(l&&g>0||!l&&C>0)&&(L=l?i-T:Math.min(C,M),r.closest_inx>=0&&(L=Math.min(L,r.closest_inx))),document.activeElement===_?addEvent(_,"focusout",(function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(_)})):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(_),L){var A=_.cloneNode(!0);removeClass(A,"replies_next_pre_deleted"),a||(u?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(A,p),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(A,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_prev_n_replies",L))):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(A,p),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(A,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_next_n_replies",L))),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(A,"count",L),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(A,"offset",T))}removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+e),"replies_deep_has_short");var j=s.offsetHeight-E;if(w&&j){var I=b+j;cur.wallLayer?wkLayerWrap.scrollTop=I:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(I,0,!1,!0)}wall.updateCollapseDeepReplies(e),wall.updateMentionsIndex(),wall.addReplyNames(o),wall.addDeepRepliesBlock(e),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[O]=1,wall.repliesSideSetup(O),wall.updateRepliesOnScroll()},onFail:function(){removeClass(_,"replies_next_pre_deleted")},showProgress:function(){addClass(_,"replies_next_pre_deleted"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(w,_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(w)},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(w)}}),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(!1)},emojiOpts:{},emojiShowTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttShow(Wall.emojiOpts[_],e,t)},emojiHideTT:function(_,e,t){return void 0!==Wall.emojiOpts[_]&&Emoji.ttHide(Wall.emojiOpts[_],e,t)},initReplyEditable:function(_,e,t,o,i){if(_.emojiInited)return!1;var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_button"+t),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_media_preview"+t);_.emojiInited=!0,stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){var l=Emoji.init(_,{ttDiff:o?-40:-42,rPointer:!0,controlsCont:e,shouldFocus:!i,ref:"reply",onSend:function(){Wall.sendReply(t),_.blur()},ctrlSend:function(){return Wall.customCur().wallTpl.reply_multiline||Wall.composerListShown(_)},checkEditable:function(){cur.onReplyChanged&&cur.onReplyChanged(_,t),Wall.checkTextLen(_,"reply_warn"+t)},onChange:function(){r&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(r,"reply_send_disabled",!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Emoji.editableVal(_))&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(a,"media_preview_has_medias")),Wall.hideCheckTimer(t,"editing")},onStickerSend:function(_,e){Wall.sendReply(t,!1,{stickerId:_,sticker_referrer:e})},initUploadForImagePasteCallback:Page.initUploadForImagePaste});if(vk.widget&&!window.emojiStickers&&Emoji.updateTabs(),Wall.emojiOpts[t]=l,cur.afterEmojiInit&&cur.afterEmojiInit[t]){var s=geByClass1("emoji_smile",Emoji.opts[l].controlsCont);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(s)&&(cur.afterEmojiInit[t](),delete cur.afterEmojiInit[t])}}))},initEditReply:function(_,e,t,o){var i,r=_,a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+_),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(l,"reply"),d=cur.wallLayer?wkcur:cur,b=!1;if(c){if(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",l)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",l),b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i,"deep_active")){if(!cur.reply_to){var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(l,"answering-id");if(p){var u=_.split("_")[1];cur.reply_to=[Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(p),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(u)],Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to"+_,u)}}wall.addDeepRepliesBlock(_),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+_)}r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"post-id")}else cur.wallLayer?(b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"),"deep_active"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_reply_form_inner")):(i=l,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i,"deep_active"));if(!i&&s?i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_post_wrap",s):!i&&n&&(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_post_wrap",n)),s){var E=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+r),O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(E,"can_reply_as_group"),h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(E,"can_reply_as_any_group"),w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"owner-photo")||"",v=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"owner-href")||"",m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"owner-name")||"",P="";h?P=d.wallTpl.reply_form_any_group:O&&(P=d.wallTpl.reply_form_group),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(b&&d.wallTpl.reply_form_new?d.wallTpl.reply_form_new:d.wallTpl.reply_form,{add_buttons:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(P,{post_id:_,oid:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(_),owner_photo:w||"/images/blank.gif"}),post_id:_,oid:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(_),owner_photo:w,owner_href:v,owner_name:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.J)(m))})),s.parentNode.replaceChild(n,s),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_)}if(!a)throw new Error("Failed to init new reply or edit reply: no reply field");if(Wall.initReplyEditable(a,n,_,e,t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(a,"composer"))o&&o();else{var D,M,g,f,T=[],C=!1;window.mvcur&&mvcur.mvShown?D=mvcur.mvMediaTypes:cur.wallLayer==r?D=wkcur.options.rmedia_types:window.pvcur&&cur.pvShown?(D=pvcur.rmedia_types,M=0,g=0):D=d.options&&d.options.rmedia_types,(b||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i.parentElement,"VerticalVideoLayerInfo__commentsReply"))&&(C=!0,M=0,g=0),each(D||d.options&&d.options.media_types||[],(function(){Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(this[0],["photo","video","audio","doc","link","page"])&&T.push(this)}));var L=!1,A=r.match(/^(\d+_)?-?\d+_(photo|video|topic|market)?\d+(mv)?(_\d+)?$/);T.length>0&&A?(f={lnk:b?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_more_attaches"+_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_add_media_"+_),preview:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_media_preview"+_),actionsEl:!1,gearEl:!1,types:T,options:{from:"topic"===A[2]?"board":"comment",limit:2,disabledTypes:["album","market","market_album","poll",_web_ui_media_selector_ui_media_selector__WEBPACK_IMPORTED_MODULE_38__.a],toggleLnk:!0,maxShown:void 0!==M?M:void 0,hideAfterCount:void 0!==g?g:void 0,vectorIcon:C,hideLabel:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_reply_add_attach_label"),toId:"full"===cur.wallType?cur.oid:cur.postTo,onToggleBlock:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_),o=geByClass1("reply_box_photo",t);o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)(o,e)},onMediaChanged:function(){Wall.hideCheckTimer(_,"editing"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)("reply_button"+_,"reply_send_disabled",!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Emoji.editableVal(a))&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)("reply_media_preview"+_,"media_preview_has_medias"))}}},r.match(/^-?\d+_topic/)&&(extend(f.options,{disabledTypes:["album","share","link","page"],limit:10,editable:1,sortable:1,teWidth:280,teHeight:200}),L=!0)):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("reply_add_media_"+_),Wall.initComposer(a,{lang:{introText:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("profile_mention_start_typing"),noResult:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("profile_mention_not_found")},toup:L,wddClass:"reply_composer_dd",width:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(a.parentNode)[0],media:f,isReply:!0},o)}return void 0!==a.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),{postId:r,postEl:i,isReply:c,rf:a}},showEditReply:function(_,e,t,o,i,r){if(cur.viewAsBox)return setTimeout((function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_).blur()}),0),cur.viewAsBox();if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)("post"+_,"Post--with_closed_comments_donut"))return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.vb)("replies_wrap"+_,{display:""}),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(e);var a=wall.initEditReply(_,t,i,r);if(a.rf){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("reply_box_wrap",a.rf));var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",a.rf);l&&addClass(l,"replies_deep_has_field")}return cur.wallMyOpened&&(cur.wallMyOpened[_]=cur.wallMyOpened[_]||!1),cur.editing===_?(Emoji.editableFocus(a.rf,!1,!0),!1):(Wall.hideEditPostReply(),a.isReply?addClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+_),"deep_reply_box_open"):(addClass(a.postEl,"reply_box_open"),addClass(a.postEl,"post--replyBoxWasOpened")),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.vb)("replies_wrap"+_,{display:""}),cur.editing=_,window.Emoji&&setTimeout((function(){Emoji.editableFocus(a.rf,!1,!0),Wall.repliesSideOver(_)}),0),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.k)(window,"scroll"),void 0!==a.rf.emojiId&&cur.afterEmojiInit&&cur.afterEmojiInit[_]&&(cur.afterEmojiInit[_](),delete cur.afterEmojiInit[_]),cur.wallTpl&&cur.wallTpl.reply_multiline_intro&&ajax.post("al_wall.php",{act:"a_ctrl_submit_intro",hash:cur.wallTpl.poll_hash},{onDone:function(e){e&&cur.editing===a.postId&&Wall.replySubmitTooltip(_,1)},onFail:function(){return!0}}),window.mvcur&&(mvcur.post==a.postId&&Videoview.onShowEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),mvcur.scrollBottom&&mvcur.scrollBottom()),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(cur.onReplyFormSizeUpdate)&&cur.onReplyFormSizeUpdate(a.rf),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(cur.onReplyFormFocus)&&cur.onReplyFormFocus(a.rf),!1)},hideEditReply:function(_,e){cur.editing=!1;var t,o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_),a=cur.reply_to&&Wall.getReplyName(cur.reply_to[0]),l=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(window.Emoji?Emoji.editableVal(o):""),s=Wall.hasComposerMedia(o),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i,"reply");if(!(t=cur.wallLayer?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_reply_form_inner"):n?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",i):i)&&r&&(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_post_wrap",r)),o&&(!s||e)){if(a&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(a)&&a[1]&&(l&&a[1].indexOf(l)||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(o,""),l="")),e&&(l||s)){var c=o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(o,"composer");c?Composer.reset(c):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(o,""),l="",hide(geByClass1("reply_warn",t))}if(!(browser.opera_mobile||browser.safari_mobile||l)){Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)()&&Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)().isVisible()||(n?removeClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+_),"deep_reply_box_open"):removeClass(t,"reply_box_open")),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_link"+_)&&hide("replies_wrap"+_),window.tooltips&&r&&tooltips.hideAll(r),o.blur(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.k)(window,"scroll"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to"+_,""),hide("reply_to_title"+_),cur.reply_to=!1;var d=Wall.emojiOpts[_];d>=0&&Emoji.opts[d]&&Emoji.opts[d].onChange&&Emoji.opts[d].onChange(),cur.onReplyFormSizeUpdate&&cur.onReplyFormSizeUpdate();var b=cur.replySubmitSettings;b&&b.tt&&b.tt.el&&b.tt.destroy(),window.mvcur&&mvcur.post==_&&(Videoview.onHideEditReply(),mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate())}}},replyNamesRE:function(){wall.addReplyNames({});var _=wall.getReplyNames();if(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.u)(_))return!1;var e=[];return each(_,(function(_,t){t&&(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(t)&&(t=t[1]),"string"==typeof t&&e.push(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.h)(t)))})),new RegExp("^("+e.join("|")+")")},replyTo:function(_,e,t,o){var i=window.cur.wallLayer==_?wkcur:window.cur;Wall.showEditReply(_,o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to"+_,e);var r=i.reply_to&&Wall.getReplyName(i.reply_to[0]);i.reply_to=[t,e];var a=Wall.getReplyName(t),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_as_group"+_),s=_.match(/^(-?\d+)_([a-z]+)?(\d+)([a-z]+)?$/),n=s[1],c=s[2]||"",d=s[4]||"",b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+n+c+"_"+e),p=b&&geByClass1("reply_to",b,"a"),u=Wall.replyNamesRE(),E=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",b)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",b),O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(E,"deep_active"),h=O?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",b):null,w=h?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(h,"post-id"):_,v="";if(!O||h){var m=(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(a)?a[0]:a)||"";m='<a class="reply_to_mem" onclick="return wall.showReply(this, \''+w+"', '"+n+c+"_"+e+d+"', event);\">"+m+"</a>";var P='<span class="reply_to_cancel" onclick="return Wall.cancelReplyTo(\''+w+"', event);\"></span>",D='<div class="reply_to_label">'+langStr(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_reply_to"),"user",m)+"</div>";v=O?D+P:P+D}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to_title"+w,v);var M=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+w);if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(a)&&a[1]&&window.Emoji){var g=M,f=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Emoji.val(g)));!(f=f.replace(/&nbsp;/g," "))||r&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(r)&&!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.N)(r[1]).indexOf(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.N)(f))?Emoji.val(g,a[1]):u&&(f=f.replace(u,a[1]),Emoji.val(g,f));var T=Wall.emojiOpts[_];T>=0&&Emoji.opts[T]&&Emoji.opts[T].onChange&&Emoji.opts[T].onChange(),Emoji.focus(g,!0)}if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)("reply_to_title"+w,v),l){var C=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(l.parentNode)&&n<0&&p&&p.getAttribute("rid")===n;Wall.setReplyAsGroup(l,{from:C?n:vk.id})}var L=Object(_web_wall_reply_utils__WEBPACK_IMPORTED_MODULE_43__.a)();return O&&M&&L&&Object(_web_wall_deep_replies_utils__WEBPACK_IMPORTED_MODULE_42__.a)(M,L),i.onReplyFormSizeUpdate&&i.onReplyFormSizeUpdate(),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.j)(o),!1},cancelReplyTo:function(_,e){var t=window.cur.wallLayer==_?wkcur:window.cur,o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_),i=t.reply_to&&Wall.getReplyName(t.reply_to[0]),r=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(window.Emoji?Emoji.editableVal(o):"")),a=Wall.replyNamesRE(),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",l)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",l),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(s,"deep_active");if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(i)&&i[1]&&window.Emoji){r&&i[1].indexOf(r)?a&&(r=r.replace(a,""),Emoji.val(o,r)):(r="",Emoji.val(o,r));var c=Wall.emojiOpts[_];c>=0&&Emoji.opts[c]&&Emoji.opts[c].onChange&&Emoji.opts[c].onChange(),Emoji.focus(o,!0)}if(hide("reply_to_title"+_),n){var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(l,"answering-id");if(d){var b=_.split("_")[1];t.reply_to=[Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(d),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(b)],Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to"+_,b)}else t.reply_to=!1,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to"+_,"")}else window.mvcur&&mvcur.post==_?mvcur.mvReplyTo=!1:t.reply_to=!1,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to"+_,"");return t.onReplyFormSizeUpdate&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(t.onReplyFormSizeUpdate)&&t.onReplyFormSizeUpdate(o),window.mvcur&&mvcur.onReplyFormSizeUpdate&&mvcur.onReplyFormSizeUpdate(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.j)(e),!1},replySubmitTooltip:function(_,e,t){var o=_&&window.cur.wallLayer==_?wkcur:window.cur,i=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+_)),r=i&&geByClass1("button_blue",i,"div"),a=o.replySubmitSettings;if(!(t&&r&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(r)))if(t=t||r,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"flat_button")&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.k)(t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"button_disabled"))!e&&a&&a.tt&&a.tt.hide&&a.tt.hide();else if(a||(a=o.replySubmitSettings=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{className:"reply_submit_hint_tt_point"})),e){if(t)if(a.parentNode==t&&a.tt&&a.tt.show)a.tt.show();else{a.tt&&a.tt.el&&a.tt.destroy(),t.insertBefore(a,t.firstChild);var l=Wall.customCur().wallTpl.reply_multiline?1:0,s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(Wall.customCur().wallTpl.reply_multiline_hint,{enabled:l?"on":"",disabled:l?"":"on"}),n=i&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",i)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",i)),c=n&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(n,"deep_active");Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(a,{text:s,typeClass:"tt_default_right",slide:15,shift:c?[15,8]:[0,8],asrtl:1,hasover:1,toup:!1,showdt:700,hidedt:700,dir:"auto",noZIndex:!0,onCreate:function(){radioBtns.reply_submit={els:Array.prototype.slice.apply(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("radiobtn",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_submit_hint_opts"))),val:s?1:0}}})}}else a&&a.tt&&a.tt.hide&&a.tt.hide()},onReplySubmitChanged:function(_,e){if(cur.wallTpl?cur.wallTpl.reply_multiline=_:mvcur.wallTpl&&(mvcur.wallTpl.reply_multiline=_),Wall.customCur().wallTpl&&(Wall.customCur().wallTpl.reply_multiline=_),e){var t=cur.replySubmitSettings;t&&t.tt&&t.tt.el&&t.tt.destroy()}else ajax.post("al_wall.php",{act:"a_save_ctrl_submit",value:_,hash:Wall.customCur().wallTpl.poll_hash}),window.Notifier&&Notifier.lcSend("wall_reply_multiline",{value:_})},getReplyFromId:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_as_group"+_);return!(!e||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(e.parentNode))&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("_submit_post_box",e),"from-oid")},showCheckTimer(_,e,t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_),r=i&&geByClass1("WallCheckComment__timer",i);if(o&&r){Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(o,{text:t.description,showdt:0,hidedt:0,shift:[0,-1],width:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(o)[0],forcetoup:!0,nohide:!0,noZIndex:browser.msie_edge,className:"WallCheckComment__tt"}),geByTag("span",r).forEach(_=>{_.style.animationDuration=t.delay+"s"}),i.classList.add("WallCheckComment--shown");var a=setTimeout(()=>{i.classList.remove("WallCheckComment--shown"),Wall.sendReply(_,void 0,e)},1e3*t.delay);r.timeout=a,r.onclick=()=>{Wall.hideCheckTimer(_,"button")},cur.destroy||(cur.destroy=[]),cur.destroy.push(()=>{a&&clearTimeout(a)}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.H)(o)}},hideCheckTimer(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_),i=o&&geByClass1("WallCheckComment__timer",o);if(t&&i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"check_timestamp");e&&r&&Wall.isCheckTimerShown(_)&&ajax.post("al_wall.php",{act:"check_comment_cancelled",post_raw:_,timestamp:r,reason:e}),i.timeout&&clearTimeout(i.timeout),t.tt&&t.tt.hide&&t.tt.hide(),o.classList.remove("WallCheckComment--shown"),"button"===e&&setTimeout(()=>Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.H)(t),0)}},isCheckTimerShown(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_);return e&&e.classList.contains("WallCheckComment--shown")},sendReply:function(_,e,t){t=extend({},t);var o,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+_),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("reply_to"+_);if(i?(o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",i)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",i),"post-id"),r=r||_.split("_")[1]):o=_,window.mvcur&&mvcur.post==o)return Videoview.sendComment(o,e,t);var a,l,s,n=window.cur.wallLayer==o,c=n?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+o),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_),b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(c,"deep_active"),p=n?wkcur:window.cur,u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_),E=u&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(u,"composer"),O=p.reply_to&&Wall.getReplyName(p.reply_to[0]),h=u&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(u,"send");if(h&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(h))return h(_,e,t);if(t.stickerId)l={message:"",attach1_type:"sticker",attach1:t.stickerId,sticker_referrer:t.sticker_referrer};else if(t.suggest)l={message:t.suggest};else{if((l=E?Composer.getSendParams(E,Wall.sendReply.pbind(_)):{message:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Emoji.editableVal(u))}).delayed)return;if(!l.attach1_type&&(!l.message||Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(O)&&O[1]&&!O[1].indexOf(l.message)))return void Emoji.editableFocus(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_),!1,!0)}var w=window.wkcur&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wk_content");if(u&&(w&&w.contains(u)?wkcur.wallCheckComments:p.wallCheckComments)){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(u,"check_in_progress"))return;if(!(s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(u,"check_timestamp")||void 0))return Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.j)(e),void ajax.post("al_wall.php",{act:"check_comment",post_raw:o,text:l.message},{onDone(e){e&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(u,"check_timestamp",e.timestamp),e.description&&e.delay)?Wall.showCheckTimer(_,t,e):Wall.sendReply(_,void 0,t)},onFail:()=>(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(u,"check_timestamp",Date.now()),Wall.sendReply(_,void 0,t),!0),showProgress(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(u,"check_in_progress",!0)},hideProgress(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(u,"check_in_progress",null)}});if(Wall.isCheckTimerShown(_))return void Wall.hideCheckTimer(_,"button");Wall.hideCheckTimer(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(u,"check_timestamp",null)}t.stickerId||t.suggest||(E?a=Composer.reset(E):window.Emoji&&Emoji.val(u,""),u.autosize&&u.autosize.update()),p.wallMyOpened=p.wallMyOpened||{},p.wallMyReplied[o]=1,p.wallMyOpened[o]=1;var v=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_hash"+o)?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_hash"+o).value:p.options.post_hash,m=null,P=b&&(i||!n&&"full"!==p.wallType),D=wall.getRepliesOrder(o),M=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(d,"top-ids"),g=!1;if(P&&d){var f=!i&&wall.isDescRepliesOrder(o,D)?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(d):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.A)(d);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(f,"replies_next")&&(P=!1,g=!0)}extend(l,{act:"post",type:p.wallType,reply_to:o,reply_to_msg:r,reply_to_user:p.reply_to&&p.reply_to[0]||0,start_id:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("start_reply"+o),from:n?"wkview":"",hash:v,only_new:P?1:0,need_last:g?1:0,order:D,top_replies:M||null,timestamp:s}),p.reverse&&(l.rev=1);var T,C=wall.getReplyFromId(_);if(C&&(l.from_oid=C),T=p.wallType?"feed"==p.wallType?"news"==p.section?"feed_"+(p.subsection?p.subsection:p.section):"recommended"==p.section?"feed_recommended"+("recent"!=p.subsection?"_"+p.subsection:""):-1!==["friends","groups","videos","photos","list"].indexOf(p.section)?"feed_"+p.section+(p.subsection?"_"+p.subsection:""):"feed_"+p.section:"top"==p.wallType?"wall_top":"wall_"+(p.onepost?"one":(p.wallType||"").indexOf("full_")?"page":"full"):p.module,extend(l,{ref:T}),browser.mobile?Wall.hideEditReply(_):(Emoji.editableFocus(u,!1,!0),Wall.cancelReplyTo(_,e)),hide("reply_warn"+_),ajax.post("al_wall.php",Wall.fixPostParams(l),{onDone:function(e,t,i,r){if(b){if(P)return wall.onOnlyNewReplySent.apply(window,arguments);if(g)return wall.onLastChunkReplySent.apply(window,arguments);if(n)return wall.onNewReplySentLayer.apply(window,arguments)}if("full"===p.wallType)return b?FullWall.onNewReplySent.apply(window,arguments):FullWall.onReplySent.apply(window,arguments);p.wallMyReplied[o]=0,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("reply_link"+o),hide("reply_warn"+o),Wall._repliesLoaded(_,!1,t,i,r),Wall.processPostReplyActions(e)},onFail:function(_){if(m&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(m),E?a=Composer.restore(E,a):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(u,l.message),u.autosize&&u.autosize.update(),_)return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_error"),_),!0},showProgress:function(){b?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.f)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_button"+_),!0):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_button"+_))},hideProgress:function(){b?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.f)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_button"+_),!1):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_button"+_))}}),window.cur.onPostReply&&window.cur.onPostReply(_),!l.from_oid&&l.message&&!P){var L=-++p.wallMyRepliesCnt,A=Emoji.emojiToHTML(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(l.message),!0),j=wall.getReplyNames(),I=l.reply_to_user<0?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_replied_to_group"):j[l.reply_to_user]&&j[l.reply_to_user][0],W=I?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(p.wallTpl.reply_link_to,{to_user:I}):"";if(m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(p.wallTpl.reply_fast,{reply_id:"0_"+L,message:A.replace(/\n/g,"<br/>"),to_link:W,date:Wall.getNowRelTime(p)})),d&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(d)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_link"+_))Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("reply_link"+_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("replies_wrap"+_);else if(!p.onepost){var R=d.nextSibling;if(R&&"replies_open"==R.className&&Wall.openNewComments(_),!n){var B=geByClass1("wr_header",d,"a"),U=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply",d,"div").length+1,K=U;B&&(K=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(B.getAttribute("offs").split("/")[1])+1),(K>5||U<K)&&(B||d.insertBefore(B=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("a",{className:"wr_header"}),d.firstChild),Wall.updateRepliesHeader(_,B,U,K))}}p.reverse?d.insertBefore(m,d.firstChild):d.appendChild(m),n&&(WkView.wallUpdateReplies(),p.reverse||(wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()))}},onOnlyNewReplySent:function(_,e,t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(o,"reply"),r=i?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",o)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",o):o,a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(r,"post-id"),l=!i&&wall.isDescRepliesOrder(a);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"deep_active")){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",o);i&&s&&(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"post-id"));var n=cur.wallLayer===a,c=Wall._getRepliesInfoBeforeAddNewReply(_,n),d=Wall._checkVisibilityBeforeAddNewReply(_,c,l,n);i&&wall.addDeepRepliesBlock(_);var b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(e);l&&c.repliesListEl.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(b,c.repliesListEl.firstChild):c.repliesListEl.appendChild(b),Wall._fixScrollAfterAddNewReply(_,c,d,l,n),i&&wall.updateCollapseDeepReplies(_),Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(b),wall.incReplyCounter(r),wall.addReplyNames(t)}},onLastChunkReplySent:function(_,e,t,o,i,r){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+i),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(a,"reply"),s=l?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",a)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",a):a,n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"post-id"),c=!l&&wall.isDescRepliesOrder(n);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(s,"deep_active")){var d=cur.wallLayer===n,b=Wall._getRepliesInfoBeforeAddNewReply(i,d),p=Wall._checkVisibilityBeforeAddNewReply(i,b,c,d);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(b.repliesListEl,e),Wall._fixScrollAfterAddNewReply(i,b,p,c,d);var u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+r);Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(u),l&&wall.updateCollapseDeepReplies(i),wall.incReplyCounter(s,1,_),wall.addReplyNames(o)}},_getRepliesInfoBeforeAddNewReply:function(_,e){var t=e?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)(),o=window.innerHeight||document.documentElement.clientHeight,i=t+(e?0:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)("page_header_cont")[1]),r=t+o,a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(a,e)[1],s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(a)[1];return{repliesListEl:a,scrollY:t,topY:i,bottomY:r,viewportHeight:o,repliesListY:l,repliesListH:s,repliesListEndY:l+s,layerFieldH:e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)("wl_reply_form")[1]:0}},_checkVisibilityBeforeAddNewReply:function(_,e,t,o){return t?o?e.repliesListY>0&&e.repliesListY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListY&&e.bottomY>e.repliesListY:o?e.repliesListEndY>0&&e.repliesListEndY<e.viewportHeight-e.layerFieldH:e.topY<e.repliesListEndY&&e.bottomY>e.repliesListEndY},_fixScrollAfterAddNewReply:function(_,e,t,o,i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(e.repliesListEl)[1];if(o)t||Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(e.repliesListY-100,300,!1,!0);else if(t){var a=e.scrollY+r-e.repliesListH;i?wkLayerWrap.scrollTop=a:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(a,0,!1,!0)}else{var l=e.repliesListY+r-300;i?Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.b)(wkLayerWrap,{scrollTop:e.scrollY+l},300):Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(l,300,!1,!0)}},incReplyCounter:function(_,e,t){e=e||1;var o,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"post-id"),r=geByClass1("comment",_);r&&(t||(o=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(r,"count"),t=Math.max(0,o+e)),Likes.update("wall"+i,{comment_num:t}))},onNewReplySentLayer:function(_,e,t,o){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"),r=geByClass1("wl_replies",i);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(r,e);var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.p)(r).filter((function(_){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"reply")})).length;extend(wkcur,{offset:t,loaded:a,count:_}),wall.addReplyNames(o),WkView.wallUpdateReplies();var l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"post-id");wall.isDescRepliesOrder(l)?wkLayerWrap.scrollTop=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(i)[1]-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)("wl_replies_wrap")[1]-30:wkLayerWrap.scrollTop=wkLayerWrap.scrollHeight,WkView.wallUpdateRepliesOnScroll()},postTooltip:function(_,e,t,o){if(!cur.viewAsBox){var i=(t||{}).reply,r=(t||{}).className||"",a=i&&!(i%2)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(_)[0]>420;o=o||{},i||(o.appendEl=bodyNode),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(_,extend({url:"al_wall.php",params:extend({act:"post_tt",post:e},t||{}),slide:15,shift:[a?417:27,6,6],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",className:"rich wall_tt"+r,typeClass:a?"tt_default_right":"tt_default"},o))}},adsMarkTooltip:function(_){cur.viewAsBox||Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(_,{black:1,shift:[15,7,0],text:_.getAttribute("data-tooltip")})},hideEditPostReply:function(_,e){if(!1!==cur.editing&&(cur.wallLayer&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)("wl_post","deep_active")&&(e=!0),e||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(boxLayerBG)&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(layerBG))){var t=_&&_.target?_.target:{},o=t.id;cur.editing?cur.editingHide?cur.editingHide(cur.editing,t):_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("_reply_wrap",t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"reply_link")||o=="reply_field"+cur.editing||"reply_to_link"==t.className)||Wall.hideEditReply(cur.editing):(cur.wallAddMedia||{}).chosenMedia||_&&"post_field"==o||Wall.hideEditPost()}},postShowDeletedMessage:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);if(t){var o=geByClass1("_post_content",t)||geByClass1("feedback_row_t",t);Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.g)(o),hide(o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(o),"post_publish")&&hide(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(o));var i="post_del"+_,r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(i),a='<span class="dld_inner">'+e+"</span>";return r?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(r,a),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(r)):t.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{id:i,className:"dld",innerHTML:a})),!0}return!1},postHideDeletedMessage:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);if(e){var t=geByClass1("_post_content",e)||geByClass1("feedback_row_t",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(t),"post_publish")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(t));var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_del"+_);return hide(o),!0}return!1},isArchiveWall:function(){return cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module},rollbackPostsArchiveState:function(_,e,t){if(Wall.isArchiveWall()&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.m)(_)){var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_rollback_state",from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){cur.wallArchiveRolledback=!0,Wall.postShowDeletedMessage(e,_)},showProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.p)(_),hideProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.x)(_)})}},restoreLastRollbackPostsArchiveState:function(_,e,t){if(Wall.isArchiveWall()&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.m)(_)){var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e.split("_")[1]);ajax.post("al_wall_archive.php",{act:"a_restore_last_rollback",from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_more_tab")?"profile":"wall",postId:o,hash:t},{onDone:function(_){delete cur.wallArchiveRolledback,Wall.postShowDeletedMessage(e,_)},showProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.p)(_),hideProgress:Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.x)(_)})}},postSetArchiveState:function postSetArchiveState(actionEl,postRaw,hash,state,isRollback){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.a)(actionEl)&&!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.m)(actionEl)){var postId=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(postRaw.split("_")[1]),isActionMenuItem=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(actionEl,"ui_actions_menu_item"),localCur=cur.wallLayer?wkcur:cur;localCur&&(localCur.wallMyDeleted||(localCur.wallMyDeleted={}),localCur.wallMyDeleted[postRaw]=!Wall.isArchiveWall()==!state?0:1);var extended=!isRollback&&(Wall.isArchiveWall()?cur.wallArchiveRestored>=3&&!cur.wallArchiveRolledback:!cur.wallArchiveArchived);ajax.post("al_wall_archive.php",{act:"a_set_state",from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_more_tab")?"profile":cur.pid?"post":"wall",hash,state:state?1:void 0,extended:extended?1:void 0,postId},{onDone:function onDone(msg,js){if(Wall.isArchiveWall()&&(state=!state,isRollback||(cur.wallArchiveRestored||(cur.wallArchiveRestored=0),cur.wallArchiveRestored++)),state&&(cur.wallArchiveArchived=!0),isRollback?Wall.postHideDeletedMessage(postRaw):Wall.postShowDeletedMessage(postRaw,msg)){"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(state?-1:1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(postEl,"reply")&&(state?--cur.pgOffset:++cur.pgOffset,state?--cur.pgCount:++cur.pgCount,FullWall.repliesSummary(cur.pgCount));var postEl=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+postRaw);"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(postEl,"own")&&(state?++cur.deletedCnts.own:--cur.deletedCnts.own),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(postEl,"all")&&(state?++cur.deletedCnts.all:--cur.deletedCnts.all),Wall.isArchiveWall()&&(state?--cur.deletedCnts.archive:++cur.deletedCnts.archive),Wall.update())}if(js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.d)(_,js)}},showProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n.pbind(actionEl):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.p)(actionEl),hideProgress:isActionMenuItem?_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v.pbind(actionEl):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.x)(actionEl)})}},deletePost:function(_,e,t,o,i){(cur.wallLayer?wkcur:cur).wallMyDeleted[e]=1;var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e),a=geByClass1("post_actions",r),l={act:"delete",post:e,hash:t,root:o?1:0,confirm:i?1:0,from:"wall"};cur.suggestedDeletedCount&&cur.suggestedDeletedCount>=2&&(l.delete_all=1),Object(_internal_nospam_common__WEBPACK_IMPORTED_MODULE_46__.isClaimContent)()&&(l._nol=JSON.stringify(window.nav.objLoc)),ajax.post("al_wall.php",l,{onDone:function(i,a,l){if(l)var s=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)(i,l,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_delete"),(function(){s.hide(),wall.deletePost(_,e,t,o,1)}),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("box_cancel"));else{Wall.postShowDeletedMessage(e,i),"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(-1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"reply")&&(cur.pgOffset--,cur.pgCount--,FullWall.repliesSummary(cur.pgCount));var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_publish_wrap"+e);n&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(n,"suggest")&&(void 0===cur.suggestedDeletedCount&&(cur.suggestedDeletedCount=0),cur.suggestedDeletedCount++),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"suggest")?Wall.suggestUpdate(-1):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"postponed")?wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"own")&&++cur.deletedCnts.own,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"all")&&++cur.deletedCnts.all,Wall.isArchiveWall()&&++cur.deletedCnts.archive,Wall.update())}},showProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(_):addClass(a,"post_actions_progress")},hideProgress:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v)(_):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"flat_button")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(_):removeClass(a,"post_actions_progress")}});var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("delete_post"+e);s&&s.tt&&s.tt.el&&s.tt.destroy()},markAsSpam:function markAsSpam(el,post,hash,inline){var postEl="block_market-items"===post?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(post):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+post),adData=postEl?postEl.getAttribute("data-ad"):"";ajax.post("al_wall.php",{act:"spam",post,ad_data:adData,hash,from:inline?"inline":""},{onDone:function onDone(msg,js,js2){if("string"!=typeof js&&js2&&(js=js2),inline)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(el).replaceChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{innerHTML:msg}),el);else{var postSelector="#post"+post,r=el.closest(postSelector)||document.querySelector(postSelector),t=geByClass1("_post_content",r)||geByClass1("feedback_row_t",r);Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.g)(r);var pd=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_del"+post);if(pd?(pd.innerHTML=msg,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(pd)):r.appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{id:"post_del"+post,innerHTML:msg})),hide(t),js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.d)(_,js)}adData&&Wall._setAdReportHandler(post,adData,hash)}},showProgress:function(){el&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(el,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n)(el):inline&&(hide(el),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(el)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(el).appendChild(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span",{className:"progress_inline"}))))},hideProgress:function(){el&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(el,"ui_actions_menu_item")?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v)(el):inline&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(el),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(el)))},stat:[jsc("web/privacy.js"),"privacy.css"]});var btn=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("delete_post"+post);btn&&btn.tt&&btn.tt.el&&btn.tt.destroy()},_setAdReportHandler(_,e,t){var o="ad_report_"+_,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(o+"_send");if(i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("radiobtn",o),a=geByClass1("radiobtn on",o);window.radioBtns[o]={val:a.dataset.value||1,els:r};var l=()=>{var r=_slicedToArray(_.split("_"),2),a=r[0],s=r[1],n=window.radioBtns[o].val;ajax.post("reports.php",{act:"report_ad_common",type:"ad",oid:a,item_id:s,hash:t,reason:n,ad_data:e},{onDone:()=>{delete window.radioBtns[o],i.removeEventListener("click",l),window.closeChosenReportReasonBlock(a,s),Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.f)(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("reports_warning_sent"))},onFail:_=>(Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.f)(_),!1),showProgress:()=>Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(i),hideProgress:()=>Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(i)})};i.addEventListener("click",l)}},showIgnoreItemReasons:function(_,e,t,o,i,r,a){var l="block_market-items"===e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(e):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e);if(l){var s=l.getAttribute("data-ad");Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.g)(l),ajax.post("/al_wall.php?misc",{act:"get_ignore_reasons",post_raw:e,feed_raw:t,caption_type:i,uids:r,hash:o,ad_data:s,mode:a},{onDone:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(l,_);var s="ad_hide_"+e,n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(s+"_send");if(n){var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("radiobtn",s),d=geByClass1("radiobtn on",s);window.radioBtns[s]={val:d.dataset.value||1,els:c},n.addEventListener("click",()=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(n);var _=window.radioBtns[s].val;("feed"===a?window.feed.ignoreItem:wall.ignoreAdsItem)(e,t,o,i,r,_).then(()=>{delete window.radioBtns[s]}).catch(()=>Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(n))})}},showProgress:function(){_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"ui_actions_menu_item")&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n)(_)},hideProgress:function(){_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"ui_actions_menu_item")&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v)(_)}})}},ignoreAdsItem:function(_,e,t,o,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_),l=a.getAttribute("data-ad"),s=geByClass1("ui_actions_menu_wrap",a);if(a)return s&&uiActionsMenu.toggle(s,!1),Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.g)(a),new Promise((o,i)=>{ajax.post("/al_feed.php?misc",{act:"a_ignore_item",post_raw:_,feed_raw:e,hash:t,ad_data:l,no_html:1,reason_id:r},{onDone:function(){hide(a),o()},onFail:i})})},ignoreAdsOwner:function(_,e,t,o){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);i&&ajax.post("/al_feed.php?misc",{act:"a_ignore_owner",post_raw:_,owner_id:e,hash:t,list:0,no_html:1},{onDone:function(_){hide(i)},showProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind(o),hideProgress:o&&_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind(o)})},markAsAds:function(_,e,t,o){ajax.post("al_wall.php",{act:"mark_as_ads",post:_,hash:e,full:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(o)},{onDone:function(e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("ui_actions_menu_item_mark_as_ads"+_).innerHTML=e}})},restorePost:function(_,e,t){return(cur.wallLayer?wkcur:cur).wallMyDeleted[_]=0,ajax.post("al_wall.php",{act:"restore",post:_,hash:e,root:t?1:0},{onDone:function(e){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("post_del_btn"+_),Wall.postHideDeletedMessage(_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);"full_own"==cur.wallType||"full_all"==cur.wallType?(Pagination.recache(1),FullWall.updateSummary(cur.pgCount)):"full"==cur.wallType&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"reply")&&(cur.pgOffset++,cur.pgCount++,FullWall.repliesSummary(cur.pgCount)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"suggest")?Wall.suggestUpdate(1):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"postponed")?wall.postponeUpdateCount():"own"!=cur.wallType&&"all"!=cur.wallType&&"archive"!=cur.wallType||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"own")&&--cur.deletedCnts.own,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"all")&&--cur.deletedCnts.all,Wall.isArchiveWall()&&--cur.deletedCnts.archive,Wall.update())}}}),!1},blockPostApp:function(_,e,t,o){ajax.post("al_wall.php",{act:"block_post_app",aid:_,from:e,hash:t},{onDone:function(_){o.parentNode.parentNode.innerHTML=_},showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind(o),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind(o)})},checkPostClick:function(_,e,t){if(e=e||window.event,!_||!e)return!0;var o=e.target||e.srcElement,i=8,r=!1,a=/wall_post_text|published_comment|post_media|page_event_share|page_public_share|page_group_share|feed_friends|feed_videos|feed_explain_list|explain|feed_photos|feedback_row/;do{if(!o||o==_||o.onclick||o.onmousedown||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(o.tagName,["A","IMG","TEXTAREA","EMBED","OBJECT"])||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(o.className,["play_new","video_box_wrap"])||(r=o.className.match&&o.className.match(a)))break}while(i--&&(o=o.parentNode));if(!r)return!1;if(cur.postClicked||(cur.postClicked={}),!t||!cur.postClicked[_]){if(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return!1;t&&(cur.postClicked[_]=!0,setTimeout((function(){cur.postClicked[_]=!1}),2e3))}return o||!0},postClick:function(_,e,t){t=t||{};var o,i=(_||"").match(/^(-?\d+)_(wall)?(\d+)$/),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);if(o=!!t.skipCheck||Wall.checkPostClick(r,e)){if(!0!==o){var a=geByClass1("wall_post_more",o,"a");if(a&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(a))return a.onclick(),void(i||removeClass(r,"wall_post_over"))}if(i&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(r,"suggest")&&!cur.onepost){var l=r&&r.getAttribute("data-ad"),s=r&&r.getAttribute("data-ad-block-uid"),n="/wall"+i[1]+"_"+i[3];if(browser.mobile&&e){var c={};l&&s&&(c.params={_post_ad_data:l,_post_ad_block_unique_id:s}),nav.go(n,null,c)}else Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.d)(e)?window.open(n,"_blank"):(l&&s&&(t.ads_params={post_ad_data:l,ad_block_unique_id:s}),Wall.hideEditPostReply(),Wall.postFull("wall"+i[1]+"_"+i[3],!1,t))}}},postClickStat:function(_){var e=(_=Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.h)(_)).currentTarget,t=[];e.getAttribute("data-ad-view")&&(t.push(Wall.postsGetRaws(e)),Page.postsSeen(t));var o=_.target;Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(o.getAttribute("data-post-click-type"),["post_owner_img","post_owner_link"])||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(o,"author")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(o,"post_image")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(o,"post_img")?Wall.triggerAdStat(e,"click_post_owner"):("A"==_.target.nodeName&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wall_post_text",_.target,e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("page_media_thumbed_link",_.target,e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_.target,"lnk")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("lnk",_.target,e))&&Wall.triggerAdStat(e,"click_post_link")},adBlockClickStat:function(_,e){var t=(_=Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.h)(_)).currentTarget;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"_ads_block_data_w")||(t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_ads_block_data_w",t));var o=[];t.getAttribute("data-ad-view")&&(o.push(Wall.postsGetRaws(t)),Page.postsSeen(o)),Wall.triggerAdStat(t,e)},getAdsEvents:function(){var _=Wall._lsAdsEvents;return _||(_=Wall._lsAdsEvents=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.get(Wall.LS_ADS_EVENTS)||{}),_},cleanAdsEvents:function(){var _=Wall.getAdsEvents(),e=(new Date).getTime()/1e3|0,t=!1;each(_,(function(o,i){e-i>=3600&&(delete _[o],t=!0)})),t&&_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.set(Wall.LS_ADS_EVENTS,_)},triggerAdPostStat:function(_,e){Wall.triggerAdStat(_,e)},triggerAdStat:function triggerAdStat(elIdOrEl,event){for(var el="string"==typeof elIdOrEl?Wall.domPost(elIdOrEl):elIdOrEl,pixels=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(el,"ad-stat-"+event);pixels;){var adBlockUID=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(el,"ad-block-uid"),isUniqueEvent=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(event,["load","impression","impression_long","video_start","video_play_3s","video_play_10s","video_play_25","video_play_50","video_play_75","video_play_95","video_play_100"]);if(isUniqueEvent&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(el,"ad-disabled-stat-"+event,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(el,"ad-stat-"+event)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(el,"ad-stat-"+event,null)),adBlockUID&&isUniqueEvent)try{var eventKey=Object(_web_lib_utils__WEBPACK_IMPORTED_MODULE_32__.g)(""+event+adBlockUID),lsData=Wall.getAdsEvents();if(lsData[eventKey])break;var now=(new Date).getTime()/1e3|0;lsData[eventKey]=now,_shared_lib_ls__WEBPACK_IMPORTED_MODULE_19__.a.set(Wall.LS_ADS_EVENTS,lsData)}catch(_){try{console.log(_.message)}catch(_){}}pixels=pixels.split("$$$"),each(pixels,(function(_,e){Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.K)().src=e}));break}var statHtml=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(el,"ad-stat-html-"+event);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(el,"ad-stat-html-"+event,null),statHtml)for(var statElemWrap=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{innerHTML:statHtml}),elem;elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.d)(_,elem.innerHTML)}},copyHistory:function(_,e,t,o){var i=(_=_||window.event).target||_.srcElement,r=8,a=!1,l=/published_a_quote/;do{if(!i||(a=i.className.match(l))||i.onclick||i.onmousedown||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(i.tagName,["A","IMG"]))break}while(r--&&(i=i.parentNode));if(a&&!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString()))return ajax.post("al_wall.php",{act:"copy_history",post:t,offset:o,from:cur.module},{onDone:function(_){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(e)&&(hide(e),_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(e),"published_by_quote")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(e):e;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(t).insertBefore(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(t)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.db)(t,"im_rows")?IM.updateScroll(!0):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.db)(t,"wl_post")&&WkView.wallUpdateReplies()}}}),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(_)},postFull:function(_,e,t){if(_.match(/^wall-?\d+_\d+$/)&&!(t||{}).nolist&&(!cur.pgParams||!cur.pgParams.owners_only&&!cur.pgParams.q))switch(cur.wallType){case"all":case"full_all":_+="/all"}return Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.H)({w:_},!1,e,t)},checkReplyClick:function(_,e){if(e=e||window.event,!_||!e)return!1;var t=e.target||e.srcElement,o=8,i=!1;do{if(!t||t==_||t.onclick||t.onmousedown||"A"==t.tagName&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"_reply_lnk")||Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(t.tagName,["IMG","TEXTAREA","EMBED","OBJECT"])&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"emoji")||"wpe_cont"==t.id||(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"_reply_content")))break}while(o--&&(t=t.parentNode));return!i||!!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||document.selection&&document.selection.createRange().text||"").toString())},replyClick:function(_,e,t,o){var i=_.split("_"),r=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(i[0]),a=i[1].replace(/-?\d+$/,""),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+r+a+"_"+e),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);if(!(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(s,"closed_comments")||!cur.stickerClicked&&Wall.checkReplyClick(l,t))){(t||{}).cancelBubble=!0;var n=geByClass1("wall_reply_more",l,"a");if(n&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(n))return removeClass(l,"reply_moreable"),void n.onclick();if(o){s=cur.wallLayer?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"):s;var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(s,"deep_active"),d=cur.stickerClicked||!1,b=_;if(c){var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",l);b=p?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(p,"post-id"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(l,"post-id")}var u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+b);cur.stickerClicked=!1,!d||u&&u.emojiInited||(cur.afterEmojiInit=cur.afterEmojiInit||{},cur.afterEmojiInit[b]=function(){Emoji.clickSticker(d,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+b))}),Wall.replyTo(b,e,o,t),d&&u&&u.emojiInited&&Emoji.clickSticker(d,u)}}},stickerClick:function(_,e,t){if((t||{}).cancelBubble=!0,window.Emoji)if(e){var o=Emoji.isStickerPackEnabled(_,Wall.stickerClick.pbind(_,e));if(0!==o)if(o){var i=e.parentNode,r=8;do{if(!i||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i,"reply"))break}while(r--&&(i=i.parentNode));i&&i.onclick&&(cur.stickerClicked=_,i.onclick())}else Emoji.clickSticker(_,!1)}else Emoji.clickSticker(_,!1);else stManager.add([jsc("web/emoji.js"),"notifier.css"],(function(){Wall.stickerClick(_,e)}))},domPost:function(_){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_)},formatCount:function(_,e){return e=e||{},Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.l)(_,e)},likeFullUpdate:function(_,e,t){var o=e.match(/^(wall|photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(-?\d+_)(\d+)/);Likes.update(o?(o[1]||"wall")+o[2]+o[3]:e,t)},likeUpdate:function(_,e,t,o,i,r,a){a||(o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(o)),!1===_&&cur.wallLayer===e&&(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post_body"));var l=e.match(/(-?\d+)(_?)(photo|video|note|topic|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),s=l[1]+"_"+l[4],n=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",_))||wall.domPost(s),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(n,a?"_views_wrap":r?"_share_wrap":"_like_wrap"),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(c,"_count");if(d){if(!a&&!r){var b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(n,"_views_wrap"),p=b&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(b,"_count");!p||!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(b,"_auto_update")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(p)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(p)!=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(d)||wall.likeUpdate(_,e,0,this.formatCount(o),void 0,void 0,1)}var u=c.tt||{},E=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.d)(u.opts||{}),O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(u.container,"_value"),h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(u.container,"_content"),w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(u.container,"_title");i&&w&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(w,i),u&&(u.likeInvalidated=!0),O&&(O.value=o),Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.c)(d,a?o:Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.j)(o,"%s",!0),{str:"auto",noWrapWidth:!!a}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(c,r?"my_share":"my_like",t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(c,a?"no_views":r?"no_shares":"no_likes",!o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(h,"me_hidden",!t&&!a),o?u.el&&(!1===i?u.destroy&&u.destroy():Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(u.container)||i||!1===i||tooltips.show(u.el,extend(E,{showdt:0}))):u.el&&u.hide();var v=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.j)(o,"%s",!0);if(a){var m=geByClass1("feedback_views",n),P=0;P=o.match(/^\d+$/)?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(o):5,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(m,"<em>"+o+"</em> "+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_X_post_views",P,!0))}else if(r){var D="";o>0&&(D="<em>"+v+"</em> "+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_X_shared",o,!0)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(geByClass1("feedback_share",n),D)}else{var M="";o>0&&(M="<em>"+v+"</em> "+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_like")),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(geByClass1("feedback_like",n),M)}Wall.updateFeedbackVisibility(n)}},updateFeedbackVisibility:function(_){var e=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(geByClass1("feedback_views",_))),t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(geByClass1("feedback_share",_))),o=!Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(geByClass1("feedback_like",_)))&&!t&&!e;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(geByClass1("post_feedback_info",_),"empty",o)},likeShareUpdate:function(_,e,t,o,i){return Wall.likeUpdate(_,e,t,o,i,!0)},like:function(_,e){if(vk.id&&!cur.viewAsBox){var t=wall.domPost(_),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(t,"_like_wrap"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(o,"_icon"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(o,"_count"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i,"fw_like_icon")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(i,"fw_my_like"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(o,"my_like"),l=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),s=(l[3]||"wall")+l[1]+"_"+l[4],n=cur.module;cur.wallType&&(n="feed"==cur.wallType?"feed_"+("news"==cur.section&&cur.subsection?cur.subsection:cur.section):"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full")),ajax.post("like.php",{act:"a_do_"+(a?"un":"")+"like",object:s,hash:e,wall:2,from:n},{onDone:Wall.likeFullUpdate.pbind(!1,_)});var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(r);Wall.likeUpdate(!1,_,!a,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(c)+(a?-1:1)),cur.onWallLike&&cur.onWallLike()}},bookmark:function(_,e){Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(e),addClass(_,"bookmarked")},likeShare:function(_,e){if(vk.id&&!cur.viewAsBox){var t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4],i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("like_share_"+o),r=Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(i),a=cur.wallType?"feed"==cur.wallType?"feed_"+cur.section:"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module;"top"==cur.wallType&&(a="wall_top"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(i),ajax.post("like.php",{act:"a_do_"+(r?"un":"")+"publish",object:o,hash:e,wall:2,ref:a},{onDone:Wall.likeFullUpdate.pbind(!1,_)});var l=wall.domPost(_),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(l,"_like_wrap"),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(s,"_icon"),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(l,"_count")),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(n,"fw_like_icon")?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(n,"fw_my_like"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(s,"my_like");Wall.likeUpdate(!1,_,!0,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(c)+(d?0:1))}},likeShareCustom:function(_,e){var t=_.match(/(-?\d+)(_?)(photo|video|note|topic|market|wall_reply|note_reply|photo_comment|video_comment|topic_comment|market_comment|)(\d+)/),o=(t[3]||"wall")+t[1]+"_"+t[4];Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.b)("like.php",extend({act:"publish_box",object:o},e))},likeShareCheckLen:function(_,e,t){_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_),e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(e),t=t||255;var o=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(_)).replace(/\n\n\n+/g,"\n\n");if(_.lastLen!==o.length){var i=_.lastLen=o.length,r=i-o.replace(/\n/g,"").length;i>t-50||r>4?(i>t?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("text_exceeds_symbol_limit",i-t)):r>4?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_recommended_lines",r-4)):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("text_N_symbols_remain",t-i)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(e)):hide(e)}},showLikesPage:function(_,e,t){cur.likesBox.loadTabContent("like.php",{act:"a_get_members",object:_,published:e,offset:t,wall:1},e)},clearLikesCache:function(_,e){var t="^/like.php#"+Object(_shared_lib_convert__WEBPACK_IMPORTED_MODULE_27__.toQueryString)({act:"a_get_members",object:_,published:e,offset:12345,wall:1,tab:e,only_content:1}).replace("12345","\\d+")+"$",o=new RegExp(t,"i");for(var i in ajaxCache)o.test(i)&&delete ajaxCache[i]},subscribeByButton:function(_,e,t,o,i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"_subscribed"),a={showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w.pbind(_),onDone:function(){r=!r,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(_,"_subscribed",r)}},l={};e>0&&i&&(l.from=i),Wall.subscribeToAuthor(r,e,t,o,a,l)},subscribeByAction:function(_,e,t,o){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.a)(_)){var i=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"value"))?1:0,r={showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n.pbind(_),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v.pbind(_)},a={};e>0&&o?a.from=o:e<0&&(r=extend(r,{onDone:function(o,a,l){if(a){var s=Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_warning"),a,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("group_leave_group"),(function(){s.hide(),Wall.subscribeToAuthor(i,e,t,r,"",{confirm:1})}),Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_cancel"));return!0}Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(_,o),_.setAttribute("data-value",1-i),l&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(_))}})),Wall.subscribeToAuthor(i,e,t,"",r,a)}},subscribeToAuthor:function(_,e,t,o,i,r){i=extend({onFail:function(_){setTimeout(Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.d)(Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_error"),_).hide,3e3)}},i),r=r||{},e>0?ajax.post("al_friends.php",extend({act:_?"remove":"add",mid:e,hash:t,from:"feed"},r),i):ajax.post("al_groups.php",extend({act:_?"list_leave":"list_enter",gid:-e,hash:t},r),i),o&&ajax.post("al_feed.php?act=viral_subscribe_stat",{author_id:e,subscribe:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(!_),hash:o})},showPhoto:function(_,e,t,o,i){return!Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.b)("al_photos.php",{act:"photo_box",to_id:_,photo:e,hash:t},{cache:1},!!o.href&&i)},_animDelX:function(_,e,t,o){},domFC:function(_){for(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(_);_&&_.id.match(/page_wall_count_/);)_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(_);return _},domPS:function(_){for(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.D)(_);_&&_.id.match(/page_wall_count_/);)_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.D)(_);return _},scrollCheck:function(_,e,t){var o,i,r=null==e?Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)():e,a=0,l=[],s=window.innerHeight||document.documentElement.clientHeight||bodyNode.clientHeight;if(window.scrollAnimation)return!1;if((Wall.repliesSideUpdate(r),cur.wallPage)&&(i="suggested"==cur.wallTab?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_suggested_posts"):"top"==cur.wallTab?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_top_posts"):"donut"===cur.wallTab?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_donut_posts"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_posts"),(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(cur.topRow)!=i||((cur.topRow||{}).id||"").match(/page_wall_count_/))&&(cur.topRow=Wall.domFC(i)),vk.id&&cur.topRow&&!cur.topRow.id.match(/page_wall_count_/)&&!((window.curNotifier||{}).idle_manager||{}).is_idle)){for(var n=[],c=Wall.domPS(cur.topRow);c;c=Wall.domPS(c))cur.topRow.offsetTop>r&&(cur.topRow=c),c.unseen||(c.unseen=!0,n.push(Wall.postsGetRaws(c)));Page.postsUnseen(n);for(var d=cur.topRow;d;d=o){LongView&&LongView.register(d,"Wall");var b=a||d.offsetTop;if(b>=r+s)break;(((o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(d))||{}).id||"").match(/page_wall_count_/)&&(o=null),(a=o?o.offsetTop:b+d.offsetHeight)<r&&o&&(cur.topRow=o);var p=d.bits||0;p>=3||(p|=(b>=r&&b<r+s?1:0)|(a>=r&&a<r+s?2:0))&&(d.bits=p,3==p&&l.push(Wall.postsGetRaws(d)))}LongView&&LongView.onScroll(r,s),Page.postsSeen(l)}if(cur.wallAutoMore&&!cur.wallLoading&&!cur.viewAsBox){var u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_more_link");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(u)&&r+lastWindowHeight+1500>Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(u)[1]&&u.onclick()}},postsGetRaws:function(_){var e,t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.p)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_).children,_),o={};if(!_)return o;o.module=cur.module,o.index=t;var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"_ads_promoted_post"),r=_.getAttribute("data-ad-view");r&&(o["ad_"+r]=1,i&&(o.module+="_ads_promoted_post"));var a=_.getAttribute("post_view_hash");if(a&&(o.hash=a),"block_"===_.id.substr(0,6)){o[_.id]=1,o.block=_.id.substr(6);var l=attr(_,"data-contain");l&&(l=l.split(",")).forEach((function(_){_=_.split(":"),o[_[0]]=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(_[1])||1}))}else(e=_.id.match(/^post(-?\d+_\d+)$/))&&(o[e[1]]=1,(e=(_.getAttribute("data-copy")||"").match(/^(-?\d+_\d+)$/))&&(o[e[1]]=-1));return o},votingExtendParams:function(_,e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"fixed")&&(_.is_fixed=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"preview")&&(_.is_preview=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"board")&&(_.is_board=1),vk.widget&&(_.is_widget=1,_.width=cur.widgetWidth,_.url=cur.url),cur.voteHash&&(_.vote_hash=cur.voteHash);var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"id");t&&(_.voting_id=t);var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"ref");o&&(_.ref=o);var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"hash");i&&(_.hash=i);var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"material");return!r||_.is_board||_.is_widget||(_.material=r),_},votingRevote:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"id");if(this.votingIsLocked(t))return;var o=this.votingExtendParams({act:"revote"},e);ajax.post("al_voting.php",o,{onDone:this.votingUpdateFull.bind(this,t),showProgress:this.votingLock.bind(this,t),hideProgress:this.votingUnlock.bind(this,t)})}},votingIsLocked:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_media_voting"+_),t=!1;return e.forEach(_=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"media_voting_locked")&&(t=!0)}),t},votingLock:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_media_voting"+_).forEach(_=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"disabled")&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"queue")||addClass(_,"media_voting_locked")})},votingUnlock:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_media_voting"+_).forEach(_=>{removeClass(_,"media_voting_locked")})},votingUpdate:function(_,e){ajax.post("al_voting.php",{act:"get_layout",voting_id:_},{onDone:t=>{Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(e)&&!1===e(t)||(this.votingUpdateFull(_,t),this.votingUnlock(_))},onFail:()=>this.votingUnlock(_),showProgress:()=>this.votingLock(_)})},votingUpdateFull:function(_,e){if(_&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.A)(e)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_media_voting"+_);t.length&&(t.forEach(_=>{if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"disabled")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"queue"))if(""===e)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(_);else{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(e);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"media_voting_can_vote")){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(t);addClass(o,"media_voting_just_voted"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(_,t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.nb)(o,"media_voting_just_voted")}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(_,t)}}),window.IMBRIDGE&&setTimeout(IMBRIDGE.syncHistory.bind(IMBRIDGE),0),vk.widget&&window.WPoll&&window.WPoll.resizeWidget())}},votingUpdatePartly:function(_,e){if(_&&isObject(e)&&!this.votingIsLocked(_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_media_voting"+_);if(t.length){var o=e.answers.reduce((_,e)=>Math.max(_,e.rate),0),i={};e.answers.forEach(_=>{_.isLeader=_.rate===o,i[_.id]=_}),t.some(t=>{if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"disabled")){if(t.classList.contains("media_voting_voted")&&!e.votes)return this.votingUpdate(_),!0;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("media_voting_option_wrap",t).forEach(_=>{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"id"),o=i[t];if(_.tt&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.v)(_.tt.destroy)&&_.tt.destroy(),o){var r=geByClass1("media_voting_option_bar",_),a=geByClass1("media_voting_option_percent",_),l=geByClass1("media_voting_option_count",_),s=geByClass1("media_voting_option_counter",_),n=Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.j)(o.votes,"%s",!0),c=new Array(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(n).textContent.split("").length+2).join("0");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.A)(l),c),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.A)(s),n),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(a,e.votes?o.rate:""),r.style.transform=`scaleX(${.01*o.rate})`,r.style.oTransform=`scaleX(${.01*o.rate})`,o.votes?l.classList.remove("media_voting_option_count_hidden"):(l.classList.add("media_voting_option_count_hidden"),_.classList.remove("media_voting_option_voted")),o.isLeader?_.classList.add("media_voting_option_leader"):_.classList.remove("media_voting_option_leader")}});var o=geByClass1("_media_voting_footer_voted_text",t);if(o){var r;r=e.votes?vk.widget?"voting_x_voted_short":"voting_x_voted":"voting_nobody_voted",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(o,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)(r,e.votes,!0));var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("media_voting_footer_voted_friend",t);a.length>e.votes&&a.forEach(_=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(_)})}}}),window.IMBRIDGE&&window.IMBRIDGE.syncHistory(),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()}}},votingUpdateByPostRaw:function(_){if(vk.id){_=_.split("_");var e=positive(_[1]),t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(_[0]),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_post_media_voting"+t+"_"+e);if(o&&o.length){var i=geByClass1("media_voting",o[0]);if(i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"id");this.votingUpdate(r)}}}},votingVote:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"id");if(!this.votingIsLocked(t)&&vk.id){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"queue"))return this.votingUpdate(t,_=>{if(_&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.A)(_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(_));if(t&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"queue")&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"disabled"))return this.votingVote(t,e,!0),!1}});if(e.length){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_),"wk_voting_box"),i=this.votingExtendParams({act:"vote",option_ids:e.join(",")},_);ajax.post("al_voting.php",i,{onDone:(_,e)=>{o?nav.reload():(vk.widget&&window.WPoll&&window.WPoll.updateShareMessage(e),this.votingUpdateFull(t,_))},showProgress:this.votingLock.bind(this,t),hideProgress:()=>{o||this.votingUnlock(t)}})}}else vk.widget&&Widgets.oauth()},votingButtonVote:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"media_voting_multiple")){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("media_voting_option_selected",e),o=[];t.forEach((function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"id");e&&o.push(e)})),this.votingVote(e,o)}},votingOptionVote:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(t){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"media_voting_multiple")){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"id");if(this.votingIsLocked(o)||!vk.id)return void(vk.widget&&Widgets.oauth());Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(_,"media_voting_option_selected");var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("media_voting_option_selected",t).length;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(t,"media_voting_has_selected_options",i)}else{var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"id");this.votingVote(t,[r])}Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(e)}},votingOptionTooltip:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"id"),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"owner-id"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"id"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"board");Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(_,{url:"al_voting.php",params:{act:"option_tt",option_id:t,owner_id:o,is_board:r,voting_id:i},slide:15,ajaxdt:100,showdt:400,hidedt:200,dir:"auto",shift:[0,10,10],typeClass:"voting_tt"})}},votingLayer:function(_,e){var t=!!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"media_voting_option_wrap")&&_,o=t?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"id"):0,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"media_voting")?_:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"id"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"owner-id"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"board"),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"ref"),n={w:(l?"board_poll":"poll")+a+"_"+r};if(o&&(n.opt_id=o),vk.widget)window.open(location.origin+"/"+n.w,"poll");else{var c={queue:1,noloader:!!Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)()};"story"===s&&(c.customRef="story"),Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.H)(n,!1,void 0,c)}Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(e)}},votingExport:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"board")){var t=this.votingExtendParams({act:"export_box"},e);(vk.widget?window.showBox:_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.b)("al_voting.php",t,{onDone:function(){Object(_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_21__.b)().setOptions({width:500})}})}},votingOnMain:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(t){if(this.votingIsLocked(o))return;var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"id"),i=this.votingExtendParams({act:"onmain",state:e?1:0},t);ajax.post("al_voting.php",i,{onDone:this.votingUpdateFull.bind(this,o),showProgress:this.votingLock.bind(this,o),hideProgress:this.votingUnlock.bind(this,o)})}},votingClosed:function(_,e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"id");if(this.votingIsLocked(o))return;var i=this.votingExtendParams({act:"closed",state:e?1:0},t);ajax.post("al_voting.php",i,{onDone:this.votingUpdateFull.bind(this,o),showProgress:this.votingLock.bind(this,o),hideProgress:this.votingUnlock.bind(this,o)})}},votingNarrowAction:function votingNarrowAction(votingId,hash,action){var act,state;switch(action){case 101:act="closed",state=0;break;case 102:act="closed",state=1;break;case 103:act="onmain",state=0;break;case 104:act="onmain",state=1}act&&!cur.votingNarrowActionProgress&&ajax.post("al_voting.php",{act,voting_id:votingId,is_fixed:1,state,narrow:1,hash},{onDone:function onDone(html,js){var votingModuleEl=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("group_voting");if(votingModuleEl&&(votingModuleEl=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(votingModuleEl),html?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(votingModuleEl,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(html)):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(votingModuleEl)),js)try{eval(js)}catch(_){Object(_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_30__.d)(_,js)}},showProgress:function(){cur.votingNarrowActionProgress=!0},hideProgress:function(){cur.votingNarrowActionProgress=!1}})},votingReport:function(_,e){if(!Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.a)(_)){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("media_voting",_);if(t){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"id");if(this.votingIsLocked(o))return;var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"board");ajax.post("al_voting.php",{act:"a_report_form",voting_id:o,is_board:i,hash:e},{onDone:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.h)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"media_voting_board")&&addClass(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(e),"media_voting_board"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(t,e),vk.widget&&window.WPoll&&window.WPoll.resizeWidget()},showProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.n)(_),this.votingLock(o)}.bind(this),hideProgress:function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.v)(_),this.votingUnlock(o)}.bind(this)})}}},foTT:function(_,e,t){t&&t.oid&&(e=t.oid==vk.id?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_my_friends_only"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("wpfo"+t.pid)),Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.b)(_,e)},update:function(){if(cur.wallLayer)WkView.wallUpdateReplies();else{var _="top"===cur.wallType,e="archive"===cur.wallType,t="donut"===cur.wallType;if(("all"===cur.wallType||"own"===cur.wallType||_||e||t)&&("all"===cur.wallTab||"own"===cur.wallTab||"top"===cur.wallTab||"archive"===cur.wallTab||"donut"===cur.wallTab)){var o=e?"all":_||t?"own":cur.wallType,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_more_link"),r=Wall.getPostsWrap(cur.wallType),a=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(cur.deletedCnts[o]),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)(o,r).length-a,s=!1;if((_||e||t)&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(geByClass1("no_posts",r))||_&&cur.wallTopFinished===cur.oid||e&&cur.wallArchiveFinished===cur.oid||t&&(cur.wallDonutFinished===cur.oid||Wall.cantAccessDonutPosts())))s=!0;else{var n;if(n=e?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_archive")):_?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_top")):t?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_donut")):"own"===o?Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_own")):Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_all")),"suggested"!==cur.wallTab){var c=n;cur.oid<0&&cur.options.fixed_post_id&&(c-=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_posts_count",c?Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.j)(c,cur.options.wall_counts):cur.options.wall_no)}var d=l;!_&&!e&&cur.options.fixed_post_id&&cur.options.wall_oid<0&&(d+=1),s=d>=n-a}s?hide(i):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(i),i.onclick=Wall.showMore.pbind(l)),cur.wallTab==cur.wallType&&(shortCurrency(),cur.gifAutoplayScrollHandler&&cur.gifAutoplayScrollHandler(),cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler())}}},getAbsDate:function(_,e){e=e||window.cur;var t,o=new Date(_||Date.now()),i=o.getHours(),r=o.getMinutes(),a="";return e.wallTpl.time_system&&(a=e.wallTpl.time_system[i>11?1:0],i=i%12||12),t=i>9?i:"0"+i,r=r>9?r:"0"+r,e.wallTpl.date_format.replace("{am_pm}",a).replace("{hour}",i).replace("{num_hour}",t).replace("{minute}",r)},getNowRelTime:function(_){_=_||window.cur;var e=Date.now();return'<span class="rel_date rel_date_needs_update" time="'+Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e/1e3-(_.tsDiff||0))+'" abs_time="'+Wall.getAbsDate(e,_)+'">'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_just_now")+"</span>"},getNewPostHTML:function(_,e,t,o){var i,r=(o=o||window.cur).wallTpl.post;if(r){var a,l=[],s=_[2],n=s.split("_")[0],c="",d=_[4].split("|"),b=Wall.getNowRelTime(o),p="1"===_[8];p?c=o.wallTpl.reply_link||"":n!=vk.id&&(c=o.wallTpl.own_reply_link||"");var u=_[3].replace("mem_link","author").replace("memLink","author"),E=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(u),O=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.J)(E.innerText||E.textContent||""));-1!=_[6].indexOf('id="wpfo')&&(b+=`<span class="page_friends_only inl_bl dvd">${Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_post_privacy_friends")}</span>`),o.wallTpl.custom_del&&(e>(_[9]==n?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)||n==vk.id||_[9]==vk.id||_[2].split("_")[0]!=_[4])&&l.push(o.wallTpl.custom_del),e>(_[9]==n?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER)||n==vk.id||_[9]==vk.id?l.push(o.wallTpl.del):_[2].split("_")[0]!=_[4]&&l.push(o.wallTpl.spam);var h=e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR&&_[9]==n||n==vk.id||_[9]==vk.id;h&&"rss"!==_[13]&&l.push(o.wallTpl.edit),n!=vk.id&&_[9]!=vk.id||!_[6]||(_[6]=_[6].replace("vk2017_snippet_show_layer_button","vk2017_snippet_show_layer_button_hidden"));var w=n<0&&_[9]==n&&e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR,v=Object(_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_37__.a)(_,o);return a={oid:n,name:u,actions:l.length&&(null===(i=o.wallTpl)||void 0===i?void 0:i.post_actions)?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(o.wallTpl.post_actions,{actions:l.join("")}):"",replies:"",reply_link:c,own_reply_link:o.wallTpl.own_reply_link,reply_box:p&&o.wallTpl.reply_box?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(o.wallTpl.reply_box,{actions:"",class:w?" reply_fakebox_with_official":""}):"",photo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.jb)(d[0]),link:_[5],text:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.jb)(_[6]),date:b,post_id:_[2],poll_hash:o.wallTpl.poll_hash,date_postfix:"",user_image:"",post_url:"/wall"+s.replace("_wall_reply","_"),can_reply_as_group:w?1:"",owner_photo:w?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.jb)(d[1]||d[0]):"",owner_href:w?_[5]:"",owner_name:w?O:"",online_class:n>0?" online":"",likes:Likes.makeTemplate(o.wallTpl.post_likes,{buttons_prepend:null==v?void 0:v.template,like_class_name:null==v?void 0:v.likeClassName,object_raw:_[2]}),class:""},t&&extend(a,t(a,_)),h&&o.wallTpl.author_data&&(a.date=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(o.wallTpl.author_data,{date:a.date,post_id:s})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(r,a),a)}console.error(new Error("Missing wall post template"))},updateAnonNewPost:function(_,e){if("anon"==_[13]){var t=geByClass1("author",e),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span");o.innerHTML=t.innerHTML,o.className=t.className,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(t,o);var i=geByClass1("post_image",e),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span");r.innerHTML=i.innerHTML,r.className=i.className,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(i,r)}return e},getNewReplyHTML:function(_,e,t,o){var i=o||window.cur,r=i.wallTpl.reply,a=[],l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_field"+_[2])||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+_[2])||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("fwr_text"),s="",n="",c="",d=_[10]||"",b=Object(_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_37__.b)(_,i);if(r){if(e>constants.Groups.GROUPS_ADMIN_LEVEL_USER||!_[2].indexOf(vk.id+"_")||_[4]==vk.id?a.push(i.wallTpl.del_reply):_[2].split("_")[0]!=_[4]&&a.push(i.wallTpl.spam_reply),(e>constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR&&_[4]==Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(_[2])||_[4]==vk.id)&&a.push(i.wallTpl.edit_reply),-1!=_[8].indexOf('class="wall_reply_more"')&&(s+="reply_moreable"),l)s+=" reply_replieable",n=i.wallTpl.reply_link_wrap,wall.getReplyNames()[_[4]]||wall.addReplyName(_[4],[_[11],_[12]]);s&&(c=" onclick=\"Wall.replyClick('%post_id%', %reply_msg_id%, event, %reply_uid%)\""),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(i.wallTpl.reply_actions,{actions:a.join("")});var p={name:_[5].replace("mem_link","author"),photo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.jb)(_[6]),link:_[7],text:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.jb)(_[8]),classname:s,actions:a,attr:c,date:Wall.getNowRelTime(i),to_link:d,answer_link:n,post_id:_[2],reply_id:_[3],like_id:_[3].replace("_","_wall_reply"),reply_msg_id:_[3].split("_")[1],reply_uid:_[4]||"false",likes:Likes.makeTemplate(i.wallTpl.reply_likes,{buttons_prepend:null==b?void 0:b.template,like_class_name:null==b?void 0:b.likeClassName,object_raw:_[2]})};return t&&extend(p,t(p)),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(r,p)}console.error(new Error("Missing wall reply template"))},updatePostImages:function(_){return _.replace(/<img[^>]+>/g,(function(_){return _.match(/class=/)?_.replace("src=","data-src=").replace('class="','class="__need_img '):_}))},loadPostImages:function(_){each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("__need_img",_,"img"),(function(){var _=this.getAttribute("data-src");_&&(this.src=_,this.removeAttribute("data-src")),removeClass(this,"__need_img")}))},openNewComments:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_),t=e.nextSibling,o=geByClass1("wr_header",e,"a"),i=0,r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply",e,"div").length,a=r,l=t.newCnt;Wall.loadPostImages(e),each(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.d)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("new_reply",e,"div")),(function(){if(removeClass(this,"new_reply"),Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(this),100==++i)return!1})),o&&(a=i+Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(o.getAttribute("offs").split("/")[1])),r+=-l+i,(a>3||r<a)&&(o||e.insertBefore(o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("a",{className:"wr_header"}),e.firstChild),Wall.updateRepliesHeader(_,o,r,a)),cur.wallMyOpened[_]=1,t&&"replies_open"==t.className&&(l>100?(t.innerHTML=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("news_x_new_replies_more",Math.min(100,l-i)),t.newCnt-=i):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(t)),Wall.repliesSideSetup(_)},langWordNumeric:function(_,e,t){return Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.n)(_,e,t)},updateTimes:function(_){var e=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Date.now()/1e3),t=[];e-=cur.tsDiff,each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("rel_date_needs_update",_||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_posts"),"span"),(function(_,o){if(o){var i=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(o.getAttribute("time")),r=e-i,a=Object(_web_lib_date__WEBPACK_IMPORTED_MODULE_48__.b)(r);a||(a=o.getAttribute("abs_time"),t.push(o)),o.innerHTML=a}})),each(t,(function(){removeClass(this,"rel_date_needs_update")}))},updateRepliesHeader:function(_,e,t,o){if(!cur.onepost){var i,r,a=e.href,l=3,s=0;if(!a&&(r=_.match(/^(-?\d+)_(photo|video|note|topic|video|)(\d+)$/))){var n=r[2]||"wall";switch(a="/"+n+r[1]+"_"+r[3],n){case"topic":a+="?offset=last&scroll=1";break;case"wall":a+="?offset=last&f=replies"}e.href=a}o>t?t<100?(i=o>100?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_show_n_last_replies",100):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_show_all_n_replies",o),l=!1):i=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_hide_replies"):(i=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_hide_replies"),s=1),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(e,"wrh_all",s),e.innerHTML=i,e.onclick=Wall.showReplies.pbind(_,l,!1),e.setAttribute("offs",t+"/"+o)}},processQueueEvent(_){if(isObject(_)&&_.entity_type)switch(_.entity_type){case"voting":this.votingUpdatePartly(_.data.id,_.data)}},updated:function(_,e,t){var o=_?window.wkcur:window.cur;if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(o.wallQueues)&&Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(t.events)&&t.events.length){var i=o.wallQueues.filter(_=>_.key===e).pop();if(i)if(t.failed)o.wallQueues=!1;else{i.ts=t.ts;var r=_?wkLayerWrap.scrollTop:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.e)(),a=r,l=!(o.wallType||"").indexOf("full"),s=o.onepost,n=!!_,c=_;l&&(nav.objLoc.q||nav.objLoc.search||nav.objLoc.day)||(each(t.events,(function(){if(isObject(this))return Wall.processQueueEvent(this);var e=this.split("<!>"),t=e[0],i=e[1],r=e[2],d=0,b=0,p=_&&window.cur.wallLayer==r&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post");if(p&&"del_reply"!=i||(p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+r),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.db)(p,_?wkLayerWrap:pageNode)||(p=null)),t==o.options.qversion){switch((Wall.isArchiveWall()?"archive_post"===i:"reveal_post"===i)&&(i="res_post"),(Wall.isArchiveWall()?"reveal_post"===i:"archive_post"===i)&&(i="del_post"),i){case"new_post":if(p)break;if(l&&o.pgStart>0){o.pgOffset++;break}if(o.oid==vk.id&&vk.id==e[9]&&window.curNotifier&&curNotifier.idle_manager.is_idle&&Wall.clearInput(),"own"!==o.wallType&&"all"!==o.wallType&&!Wall.hasPosts("own"))break;var u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_posts"),E=u.lastChild,O=!!l&&FullWall.addTetaTet,h=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e[e.length-1]),w=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&h?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&h?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,v=Wall.getNewPostHTML(e,w,O,o);if(!v)break;var m=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(v),P=u.firstChild;if(Wall.updateAnonNewPost(e,m),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+r))break;for(E&&E!=m?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(E):E=!1,l?E||o.pgOffset++:(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_all",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_all"))+1),addClass(m,"all"),Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e[10])&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_own",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_own"))+1),addClass(m,"own"))),0==e[8]&&addClass(m,"closed_comments"),o.deepRepliesActive&&addClass(m,"deep_active");P&&("INPUT"==P.tagName||1!=P.nodeType||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(P,"post_fixed"));)P=P.nextSibling;u!==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(P)&&Wall.sendInsertBeforeError(),u.insertBefore(m,P),Wall.votingUpdateByPostRaw(r),d=m.offsetHeight+15,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(m,c)[1],Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(m),Object(_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_29__.d)(),Wall.updateMentionsIndex(),AudioUtils.updateQueueReceivedPost(m);break;case"edit_post":var D=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wpt"+r);if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(p)||!D)break;var M=geByClass1("wall_post_more",D);M&&(M=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(M))),d=-D.offsetHeight,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(D,c)[1];var g=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.jb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(e[3],{poll_hash:o.wallTpl.poll_hash})),f=o.videoInlinePlayer&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.db)(window._videoLastInlined[0],D),T=f&&"playing"==o.videoInlinePlayer.getState();if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(D,g),f){var C=geByClass1("page_post_sized_thumbs",D);1==Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.p)(C).length&&(C.innerHTML="",C.appendChild(window._videoLastInlined[1]),C.appendChild(window._videoLastInlined[0]),T&&setTimeout((function(){o.videoInlinePlayer.play()}),0))}M&&(M=geByClass1("wall_post_more",D))&&M.onclick(),Wall.votingUpdateByPostRaw(r),d+=D.offsetHeight,Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(D),Wall.updatePostAuthorData(r);break;case"edit_reply":var L=e[3],A=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wpt"+L);if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)("post"+L)||!A)break;var j=geByClass1("wall_reply_more",A);j&&(j=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(j)));var I=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.jb)(e[4]);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(A,I),d=-A.offsetHeight,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(A,c)[1],j&&(j=geByClass1("wall_reply_more",A))&&j.onclick(),d+=A.offsetHeight,Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(A);break;case"post_parsed_link":if(!p)break;var W=geByClass1("wall_postlink_preview_btn_disabled",p);if(!W)break;var R=e[3];if("1"===R)removeClass(W,"wall_postlink_preview_btn_disabled"),removeClass(W,"button_disabled");else if("0"===R)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(W);else if(R){var B=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("a",{href:R,className:"flat_button",innerHTML:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_preview_link")});Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(W,B)}break;case"del_post":p&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(p)&&!o.wallMyDeleted[r]&&!s&&(d-=p.offsetHeight+15,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(p,c)[1],Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.g)(p),addClass(p,"unshown"),l||n||(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_all",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_all"))-1),e[3]&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_own",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_own"))-1),Wall.isArchiveWall()&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_archive",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_archive"))-1)));break;case"res_post":p&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(p)&&((o.wallRnd==e[4]||Wall.isArchiveWall())&&removeClass(p,"unshown"),l?o.pgOffset++:(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_all",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_all"))+1),e[3]&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_own",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_own"))+1),Wall.isArchiveWall()&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_archive",Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)("page_wall_count_archive"))+1)));break;case"new_reply":if(!p||o.wallMyReplied[r]||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e[3])||s&&o.pgOffset<o.pgCount||n&&(o.reverse?o.offset:o.offset+o.loaded<o.count))break;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(n?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+r),"deep_active")){var U=wall.addNewReply(e);d+=U[0],b=U[1];break}var K=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+r),y=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap"+r),k=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e[e.length-1]),S=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&k?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&k?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,x=Wall.getNewReplyHTML(e,S,!1,o);if(!x)break;var F,N=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(x),H=n?K.offsetHeight:p.offsetHeight,J=!1;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(K)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(y)&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)("reply_link"+r)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("wall_fixed",y)){F=K.nextSibling;var V=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("new_reply",K,"div").length+1;if(n||s||o.wallMyOpened[r]){if(!s){F&&"replies_open"==F.className&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(F),J=!0;var z=geByClass1("wr_header",K,"a"),q=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply",K,"div").length+1,G=q;z&&(G=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(z.getAttribute("offs").split("/")[1])+1),(G>5||q<G)&&(z||K.insertBefore(z=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("a",{className:"wr_header"}),K.firstChild),Wall.updateRepliesHeader(r,z,q,G))}}else addClass(N,"new_reply"),F&&"replies_open"==F.className||(F=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{className:"replies_open",onclick:Wall.openNewComments.pbind(r),role:"button",tabIndex:0}),K.parentNode.insertBefore(F,K.nextSibling)),F.innerHTML=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_x_new_replies_more",Math.min(100,V)),F.newCnt=V}else Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)("reply_link"+r),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(y,K),J=!0;_&&o.reverse&&K.firstChild?K.insertBefore(N,K.firstChild):K.appendChild(N),J&&Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(N),n?(o.count++,o.loaded++,WkView.wallUpdateReplies(),d=K.offsetHeight-H,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(N,c)[1]):(s&&(FullWall.repliesSummary(e[13]),o.pgOffset++,o.pgCount++,FullWall.repliesSummary(o.pgCount),Pagination.pageReady(!1),FullWall.onePostOnScroll(!1,!1,!0)),d=p.offsetHeight-H,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(J?N:F)[1],Wall.repliesSideSetup(r)),Wall.updateMentionsIndex(),Likes.update("wall"+r,{comment_num:e[13]});break;case"del_reply":if(o.wallMyDeleted[r]||!p)break;var Y=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",p)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",p);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Y,"deep_active")){var $=wall.removeDeepReply(e);d+=$[0],b=$[1];break}if(d-=p.offsetHeight,b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(p,c)[1],Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.g)(p),o.layerpost)hide(p),o.count--,o.loaded--;else{s&&(o.pgOffset--,o.pgCount--,FullWall.repliesSummary(o.pgCount));var X=p.parentNode.id.match(/replies(-?\d+_\d+)/);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(p),X&&Wall.repliesSideSetup(X[1])}break;case"view_post":Wall.likeUpdate(!1,r,0,Wall.formatCount(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e[3])),void 0,void 0,1);break;case"like_post":case"like_reply":if(!p)break;var Q="like_reply"==i?"wall_reply"+r:r,Z=p&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(p,"_like_wrap"),__=p&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(p,"_share_wrap"),e_=Object(_web_reactions_reactions_wall_reactions_wall__WEBPACK_IMPORTED_MODULE_37__.c)(e);wall.likeFullUpdate(Z,Q,_extends({isQueueUpdate:!0,like_my:Z&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(Z,"my_like"),like_num:e[3],like_title:!1,share_my:__&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(__,"my_share"),share_num:e[4],share_title:!1},e_));break;case"upd_ci":var t_=e[2],o_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("current_info"),i_=o_||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_current_info");if(!i_)break;switch(e[3]){case"audio":var r_=geByClass1("current_audio_cnt");r_&&r_.tt&&r_.tt.hide();var a_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e[5]||""),l_=a_?"":" hidden",s_="";o_||(s_+=" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAudioTip+"', black: 1, shift: [14, 5, 5]})\" onclick=\"Page.playCurrent(this, '"+e[4]+"')\""),t_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(o.options.ciAudioTpl,{text:t_,attrs:s_,count:a_,cnt_class:l_}),wall.updateOwnerStatus(t_,i_,e,o_);break;case"app":var n_=e[6]?"[12, 5, 5]":"[15, 5, 5]",c_=e[6]?" current_app_icon":"",d_=o_?' onclick="cur.ciApp = '+e[4]+'"':" onmouseover=\"showTooltip(this, {forcetoup: true, text: '"+o.options.ciAppTip+"', black: 1, shift: "+n_+'})" href="'+e[5]+'?ref=14" onclick="return showApp(event, '+e[4]+', 1, 14, cur.oid)"';e[6]&&(d_+=" style=\"background-image: url('"+e[6]+"'); background-size: 16px 16px;\""),t_='<a class="current_app'+c_+'"'+d_+">"+t_+"</a>",wall.updateOwnerStatus(t_,i_,e,o_);break;default:stManager.add([jsc("web/emoji.js")],(function(){t_=t_?'<span class="current_text">'+Emoji.emojiToHTML(t_,!0)+"</span>":t_,wall.updateOwnerStatus(t_,i_,e,o_)}))}break;case"upd_ci_cnt":var b_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("current_info"),p_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(e[2]),u_=b_||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_current_info"),E_=u_&&geByClass1("current_audio_cnt",u_);E_&&(E_.tt&&E_.tt.destroy(),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(E_,"hidden",0==p_),Object(_web_lib_fx__WEBPACK_IMPORTED_MODULE_24__.c)(E_,Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.j)(p_,"%s",!0),{str:"auto"}));break;case"cover_updated":var O_=geByClass1("_page_cover");if(O_&&e[2]){var h_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.K)(),w_=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.z)()?e[3]:e[2];h_.src=w_,h_.onload=function(){O_.style.backgroundImage="url('"+w_+"')",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(h_)}}}d&&(_?b<0:a+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)("page_header_cont")[1]>b)&&(a+=d)}})),a!=r&&r>100&&!o.onepost&&(_?wkLayerWrap.scrollTop=a:Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(a,0,!1,!0)),Wall.update())}}},updateOwnerStatus:function(_,e,t,o){o&&(_='<span class="'+(_?"my_current_info":"no_current_info")+'">'+(_||Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("change_current_info"))+"</span>",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e.parentNode.nextSibling,_),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)("currinfo_editor")&&cur.oid>0&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)("currinfo_audio","app"!=t[3]),t[2]&&"app"!=t[3]&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("currinfo_audio"),Boolean(t[2])),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)("currinfo_app","app"==t[3]),addClass("currinfo_app","on")));Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e,_)},updateMentionsIndex:function(_){if(clearTimeout(cur.wallUpdateMentionsIndexTO),_){var e={},t=[],o=new RegExp("^(https?://(vk.com|"+location.host.replace(/\./,"\\.")+"))?/?"),i=[];each(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("author",bodyNode,"a"),(function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(this),i=this.href.replace(o,"");if(void 0===e[i]){var r=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(this.getAttribute("data-from-id"));r&&r!=vk.id&&(e[i]=t.length,t.push([r,_,"@"+i,"/images/camera_c.gif"]))}})),i=(i=i.concat(Array.prototype.slice.apply(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post_image",bodyNode,"a")))).concat(Array.prototype.slice.apply(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply_image",bodyNode,"a"))),each(i,(function(){var _=this.href.replace(o,""),i=e[_];if(void 0!==i){for(var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(this);r&&"IMG"!=r.tagName;)r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(r);r&&(t[i][3]=r.getAttribute("src"),delete e[_])}})),cur.wallMentions=t}else cur.wallUpdateMentionsIndexTO=setTimeout(wall.updateMentionsIndex.pbind(!0),300)},initUpdates:function(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_&&_.length&&window.Notifier){var t=e?window.wkcur:window.cur,o=()=>{t.wallQueues&&t.wallQueues.forEach(_=>{Notifier.addKey(_,(_,t)=>{Wall.updated(e,_,t)})})};if(!t.wallQueues){var i=setInterval(o,1e4);e?t._hide.push(()=>clearInterval(i)):t.destroy.push(()=>clearInterval(i))}t.wallQueues=_,o()}},initWallOptions:function(_){extend(cur,{wallCheckComments:_.check_comments,wallType:_.wall_type,wallTpl:_.wall_tpl,wallMyDeleted:{},tsDiff:_.wall_tpl&&_.wall_tpl.abs_timestamp?900*Math.round((Date.now()/1e3-_.wall_tpl.abs_timestamp)/900):0,wallMyOpened:{},wallMyReplied:{},wallMentions:[],wallMyRepliesCnt:0,wallUploadOpts:_.upload,wallUploadVideoOpts:_.upload_video,hasGroupAudioAccess:_.hasGroupAudioAccess,wallAdsReplacedFeatureTooltip:_.ads_replaced_feature_tooltip,wallAdsReplacedFeatureTooltipHash:_.ads_replaced_feature_tooltip_hash,wallBestFriendsLockFeatureTooltip:_.best_friends_lock_feature_tooltip,wallBestFriendsLockFeatureTooltipHash:_.best_friends_lock_feature_tooltip_hash,wallBestFriendsSettingsFeatureTooltip:_.best_friends_settings_feature_tooltip,wallBestFriendsSettingsFeatureTooltipKey:_.best_friends_settings_feature_tooltip_key,wallBestFriendsSettingsFeatureTooltipHash:_.best_friends_settings_feature_tooltip_hash,wallBestFriendsPostFeatureTooltip:_.best_friends_post_feature_tooltip,wallBestFriendsPostFeatureTooltipKey:_.best_friends_post_feature_tooltip_key,wallBestFriendsPostFeatureTooltipHash:_.best_friends_post_feature_tooltip_hash}),_.wall_tpl&&_.wall_tpl.lang&&(cur.lang=extend(cur.lang||{},_.wall_tpl.lang)),window.Notifier&&Notifier.addRecvClbk("wall_reply_multiline","wall",(function(_){Wall.onReplySubmitChanged(_.value,1)}),!0)},onPostLoaded:function(_,e){if(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)(_),Wall.onAdBlockLoaded(_,e),e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"_post")&&(_=geByClass1("_post",_)),_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"_post")){var t=_.querySelector(".page_best_friends_only");_&&t&&window.cur.wallBestFriendsPostFeatureTooltip&&Wall.showBestFriendsPostFeatureToolTip(t),cur.onPostLoaded&&cur.onPostLoaded(_)}},onAdBlockLoaded:function(_,e){var t;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"_ads_block_data_w")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"_ads_promoted_post_data_w")?t=_:e&&(t=geByClass1("_ads_block_data_w",_)||geByClass1("_ads_promoted_post_data_w",_)),t&&Wall.triggerAdStat(t,"load")},init:function(_){var e;Wall.initWallOptions(_),extend(cur,{wallInited:!0,postField:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_field"),wallSearch:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wall_search"),wallPage:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("profile")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("group")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("public"),wallPageNarrow:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("narrow_column"),wallUploadOpts:_.upload||!1,wallOnClearInput:[],deletedCnts:{own:0,all:0,archive:0},posterFeatureTooltip:_.poster_feature_tooltip,posterFeatureTooltipHash:_.poster_feature_tooltip_hash,postCopyrightFeatureTooltip:_.post_copyright_feature_tooltip,postCopyrightFeatureTooltipHash:_.post_copyright_feature_tooltip_hash}),cur.destroy.push((function(_){Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.s)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.ab),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.s)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.Z),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.s)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.N),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.i)(_.postField)}));var t=removeEvent.pbind(document,"click",Wall.hideEditPostReply);cur._back?(cur._back.hide.push(t),cur._back.show.push(t),cur._back.show.push(addEvent.pbind(document,"click",Wall.hideEditPostReply))):cur.destroy.push(t),cur.wallTab=cur.wallType,Wall.update(),Wall.initUpdates(_.add_queues),_.wall_tpl&&(cur.timeUpdateInt=setInterval((function(){Wall.updateTimes(_.wallCont)}),1e4),cur.destroy.push((function(){clearInterval(cur.timeUpdateInt)})));var o=window;addEvent(o,"scroll",Wall.scrollCheck),addEvent(window,"resize",Wall.scrollCheck),cur.destroy.push((function(){removeEvent(o,"scroll",Wall.scrollCheck),removeEvent(window,"resize",Wall.scrollCheck)})),cur.wallAutoMore=_.automore;var i=!1;if((null===(e=cur.options)||void 0===e?void 0:e.no_draft)||(i=_.draft||cur.oid!=vk.id&&Wall.getOwnerDraft(cur.oid)),Wall.initPostEditable(i),cur.wallSearch&&placeholderInit(cur.wallSearch),removeEvent(document,"click",Wall.hideEditPostReply),addEvent(document,"click",Wall.hideEditPostReply),_.poster_options&&Wall.initPosterEditor(_.poster_options),_.media_types){var r=extend({onAddMediaChange:(_,e,t)=>{cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide(),Wall.hidePosterFeatureTooltip(),Wall.postChanged(10),["poll","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_34__.b].includes(_)||wall.focusOnEnd(),cur.oid!=vk.id&&Wall.saveOwnerDraftMedia(cur.oid,_,e,t),setTimeout(Wall.checkPosterAvailability)},onChangedSize:()=>{setTimeout(()=>{var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"),e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("VideoRestriction",_);each(e,(_,e)=>{var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(e)[1],o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(e)[0];Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(e,"VideoRestriction--onlyIcon",o<200),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(e,"VideoRestriction--small",o>=200&&o<300&&o>t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(e,"VideoRestriction--medium",o>=300&&o<400)})})},onMediaChange:()=>{Wall.postChanged()},onMediaUploadStarted:()=>{Wall.postChanged()},editable:1,from:"ads"===cur.module?"ads":"post",sortable:1,poster:cur.poster},_.media_opts||{});if(cur.wallAddMedia=new MediaSelector(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_add_media"),"media_preview",_.media_types,r),cur.wallAddMedia.menu){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(cur.wallAddMedia.menu.menuNode,"_type_podcast"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("official");a&&l&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("_submit_post_box",l),"from-oid")!=cur.postTo&&hide(a);var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(cur.wallAddMedia.menu.menuNode,"_type_youla");s&&s.addEventListener("mouseenter",_web_youla_preloadYoulaItemCreate__WEBPACK_IMPORTED_MODULE_33__.a,{once:!0})}}if(Wall.initPostVisibilitySelector(cur.wallAddMedia),Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_39__.e)(window.cur)){var n=cur.wallAddMedia&&cur.wallAddMedia.id||"",c=Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_39__.b)(String(n),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_actions_btns"));c&&(window.cur.destroy.push(c.onDestroy),Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(window.cur.wallOnClearInput)&&window.cur.wallOnClearInput.push(c.clearSelection))}if(cur.withUpload=window.WallUpload&&!browser.safari_mobile&&Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.o)(cur.wallType,["all","own","feed","full_all","ads_promoted_stealth"])&&Wall.withMentions&&cur.wallUploadOpts,cur.withUpload&&WallUpload.checkDragDrop()){var d=function(){removeEvent(document,"dragover dragenter drop dragleave",u)},b=!1,p=!1,u=function(_){if(!1!==b&&(clearTimeout(b),b=!1),cur.uploadInited)return d(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(_);switch(_.type){case"drop":p=!1,delete cur.wallUploadFromDrag,hide("post_upload_dropbox");break;case"dragleave":b=setTimeout((function(){p=!1,delete cur.wallUploadFromDrag,hide("post_upload_dropbox")}),100);break;case"dragover":case"dragenter":p||2==(p=!_.target||"IMG"!=_.target.tagName&&"A"!=_.target.tagName?2:1)&&setTimeout(WallUpload.initCallback,0),2==p&&(cur.wallUploadFromDrag=1)}return Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(_)};addEvent(document,"dragover dragenter drop dragleave",u),cur.destroy.push(d)}if(Wall.updateMentionsIndex(),_.top_wall_feature_tooltip?setTimeout((function(){Wall.showTopWallTooltip(_.top_wall_feature_tooltip_hash)}),800):_.order_feature_tooltip&&setTimeout((function(){Wall.showOrderTooltip(_.order_feature_tooltip_hash)}),800),Object(_web_wall_wall_post_render__WEBPACK_IMPORTED_MODULE_44__.a)(),cur.wallBestFriendsLockFeatureTooltip&&Wall.showBestFriendsLockFeatureToolTip(),nav.objLoc.new_post){Wall.showEditPost();var E=nav.objLoc.post_privacy;"friends_only"===E?Wall.togglePostVisibilityAccess(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.ONLY_FRIENDS,"",!0):"best_friends_only"===E&&Wall.togglePostVisibilityAccess(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("best_friends_only"),_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.ONLY_BEST_FRIENDS,"",!0),delete nav.objLoc.new_post,delete nav.objLoc.post_privacy,nav.setLoc(nav.objLoc)}},initPosterEditor:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)('<div class="page_block"></div>'),t=Wall.getMainPostBlock();"feed"===cur.module&&addClass(e,"feed_post_field_wrap");var o=function(){return!1},i=function(){Wall.closeFancyTooltipsInPost(),Wall.openPosterEditor(),cur.poster.sendStatsInfo("open")},r={onPreOpen:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(e,t)},onPostOpen:function(){var _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onPreHide:function(){Wall.saveCaretPositionForPoster(cur.poster.getTextInputEl()),Wall.closeFancyTooltipsInPost();var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_error"),e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_actions_btns"),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post");Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(t,o),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(_)&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(e))},onPostHide:function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_settings_btn"),o=cur.options.suggesting&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("check_sign");_&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(_,cur.openPosterBtn),o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(o,cur.openPosterBtn),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(t);var i=cur.poster.getTextAsHtml();i&&i.match(Emoji.emojiRegex)&&(i=i.replace(Emoji.emojiRegex,Emoji.emojiReplace)),cur.postField.innerHTML=i,Wall.restoreCaretPositionForPoster(cur.postField),setTimeout((function(){Composer.updateArticleConvertSuggest(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(cur.postField,"composer"))})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(e)},onPreUploaderOpen:function(){var _=cur.poster.getTextInputEl();Wall.saveCaretPositionForPoster(_)},onPostUploaderClose:function(){var _=cur.poster.getTextInputEl();Wall.restoreCaretPositionForPoster(_)},onOverTextLimit:function(){Wall.disablePoster(!0),cur.poster.closeEditor(),cur.poster.sendStatsInfo("auto_disable"),cur.poster.state.toggled=!0},onChangeData:Wall.postChanged,onSend:function(_){Wall.sendPost(!0,_)},onDestroy:function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(e)},getPostOwnerId:function(){return+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"),"from-oid")},width:Wall.getMainPostBlock().clientWidth,containerClasses:"poster_wall-creating",placeholder:attr(cur.postField,"placeholder"),appendToElem:e};cur.openPosterBtn=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_poster_btn"),cur.poster=new Poster(_.poster_config,r),addEvent(cur.openPosterBtn,"click",i),addEvent(cur.openPosterBtn,"mousedown",o),cur.destroy.push((function(){removeEvent(cur.openPosterBtn,"click",i),removeEvent(cur.openPosterBtn,"mousedown",o)}))},openPosterEditor:function(_){if(cur.poster&&!cur.poster.state.disabled&&!cur.poster.state.opened){_=_||{},cur.posterFeatureTT&&cur.posterFeatureTT.hide();var e=Wall.getMainPostBlock(),t=_.bkgId,o=window.browser.windows7||window.browser.windowsVista||window.browser.windowsXp;Wall.saveCaretPositionForPoster(cur.postField);var i=_.text||cur.postField.innerHTML;if(i=(i=i.replace(/\n/g,"<br/>")).replace(/<img[^>]*>/g,(function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{innerHTML:_}).firstChild,t=Emoji.getCode(e);return t?o?" ":Emoji.codeToChr(t):_})),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(e))return cur.poster.setBkg(t,!0),void cur.poster.setText(i);hide(e);var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_settings_btn"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_error"),l=cur.options.suggesting&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("check_sign"),s=cur.poster.getPostOptionsWrapperEl();if(r&&s.appendChild(r),l&&s.appendChild(l),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(a)){var n=cur.poster.getErrorWrapperElement();n.innerHTML="",n.appendChild(a)}var c=cur.poster.getBtnsWrapper(),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_actions_btns");d&&(c.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(d,c.firstChild):c.appendChild(d),d.children.length||c.children.length>1?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(c):hide(c)),cur.poster.openEditor(),cur.poster.setBkg(t,!0),cur.poster.setText(i)}},checkPosterAvailability:function(){if(cur.poster){var _=cur.wallAddMedia?cur.wallAddMedia.getMedias():[],e=cur.poster.isTextFieldValid(cur.postField),t=Wall.checkAttachesForPoster(_),o=e&&t;!o!==cur.poster.state.disabled&&Wall.disablePoster(!o),o&&cur.poster.state.toggled&&(Wall.openPosterEditor(),cur.poster.sendStatsInfo("auto_enable"),cur.poster.state.toggled=!1)}},checkAttachesForPoster(_){if(!Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(_))return!1;if(!_.length)return!0;var e=0;return _.some(_=>{if(Object(_shared_lib_common__WEBPACK_IMPORTED_MODULE_40__.h)(_)){var t=_slicedToArray(_,1)[0];["copyright","postpone",_web_donut__WEBPACK_IMPORTED_MODULE_34__.b].includes(t)||++e}}),0===e},disablePoster:function(_){cur.poster&&(void 0===_&&(_=!0),cur.poster.state.disabled=_,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(cur.openPosterBtn,"_disable",_))},isPosterEditorOpen:function(){return cur.poster&&cur.poster.isOpen()},saveCaretPositionForPoster:function(_){if(document.activeElement===_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span"),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("span");e.classList.add("poster__marker","poster__marker_start"),t.classList.add("poster__marker","poster__marker_end");var o=getSelection().getRangeAt(0);(o=o.cloneRange()).insertNode(e),o.collapse(!1),o.insertNode(t)}},restoreCaretPositionForPoster:function(_){var e=geByClass1("poster__marker_start",_),t=geByClass1("poster__marker_end",_);if(e&&t){var o=document.createRange();o.setStartBefore(e),o.setEndBefore(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(e),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(t);var i=window.getSelection();i.removeAllRanges(),i.addRange(o)}else wall.focusOnEnd(_)},getMainPostBlock:function(){var _=cur.mainPostBlock;return _||(_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box")),cur.mainPostBlock=_),_},changeAuthorInPoster:function(_){cur.poster&&_&&cur.poster.changeBkgAuthor({authorName:_.authorName,authorUrl:_.authorUrl})},sendInsertBeforeError:function(){ajax.post("al_page.php",{act:"insert_before_error",trace:(new Error).stack,owner_id:cur.oid,module:cur.module})},closeFancyTooltipsInPost:function(){var _=cur.wallAddMedia.lnkId;cur["postPostponeTT"+_]&&cur["postPostponeTT"+_].hide(),cur["post_action_btn"+_]&&cur["post_action_btn"+_].hide(),Object(_web_discover_category_post_topic__WEBPACK_IMPORTED_MODULE_39__.f)(_)},switchOwner:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(geByClass1("_ui_toggler",_),"on"),uiSearch.showProgress("wall_search"),cur.options.params.owners_only=cur.options.params.owners_only?null:1,nav.change({owners_only:cur.options.params.owners_only,offset:null})},fakeReplyAsGroupOver:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("reply_fakebox_with_official",_)&&wall.replyAsGroupOver(_)},fakeReplyAsGroupCheck:function(_,e,t){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("reply_fakebox_with_official",_))return window.tooltips&&window.tooltips.hide(_),Wall.showEditReply(e,null,!1,!1,!0,(function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_as_group"+e);_&&(_.focus(),_.click())})),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(t)},setReplyAsGroup:function(_,e){if(!_)return!1;if(_.hasAttribute("data-reinit-ads-needs-confirmation")&&window.AdsEdit&&!e.reinitConfirmed&&AdsEdit.reinitCreatingPostFormNeeded())return AdsEdit.reinitCreatingPostFormConfirm(wall.setReplyAsGroup.pbind(_,extend({},e||{},{reinitConfirmed:!0}))),!1;var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("_submit_post_box",_),o=t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("signed"),i=t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("close_comments"),r=t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("mute_notifications"),a=t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("official"),l=t&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("mark_as_ads"),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"tt"),n=e.from||(e.fromGroup?cur.oid:vk.id),c=n==vk.id?wall.replyAsProfileData():window.replyAsData&&window.replyAsData[n]||wall.replyAsGroupDomData(_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"from-oid")==n||!c||c[0]!=n)return!1;var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("submit_post_box"),b=!t&&cur.poster&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("poster",_),p=t===d;b&&(t=d,o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("signed"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("mark_as_ads"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("close_comments"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("mute_notifications"),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("official")),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"from-oid",n),wall.replyAsAnimate(t,c[2],c[1]),cur.poster&&(p||b)&&Wall.changeAuthorInPoster({authorName:c[3],authorUrl:c[2]}),s&&s.rows&&each(s.rows,(function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(this,"active",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(this,"from-oid")==n)})),o&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(o,n>0),l&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(l,n>0),i&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(i,n>0),r&&(Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.l)(l)?(addClass(r,"on"),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(r,1)):Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.e)(r,n>0)),a&&Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(a,n!==vk.id),_.setAttribute("aria-label",Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)(n<0?"wall_reply_as_group":"wall_reply_as_user")),_.hasAttribute("data-replace-owner-name")&&(_.innerHTML=c[3],"A"===_.tagName&&(_.href=c[2])),_.hasAttribute("data-replace-post-to")&&(cur.postTo=c[0]),_.hasAttribute("data-replace-oid")&&(cur.oid=c[0]),_.hasAttribute("data-reinit-ads-post-editor")&&window.AdsEdit&&(e.withoutRedraw?AdsEdit.reinitCreatingPostFormBoundWithoutRedraw():AdsEdit.reinitCreatingPostFormBound()),"official"==_.id&&Wall.postChanged(!0);var u=cur.wallAddMedia&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(cur.wallAddMedia.menu.menuNode,"_type_podcast");if(u){var E=cur.postTo==n;each(cur.wallAddMedia.getMedias()||[],(function(_,e){if("podcast"===e[0])return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(e[2],"attach_disabled",!E),E=!1,!1})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)(u,E)}return _.id&&Wall.hideCheckTimer(_.id.replace("reply_as_group",""),"editing"),cur.wallAddMedia&&cur.wallAddMedia.donutUpdateVisibility(t),!1},replyAsAnimate:function(_,e,t){var o=_&&geByClass1("_post_field_author",_),i=o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_post_field_image",o),r=_&&geByClass1("_post_field_official",_),a=r&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_post_field_image",r),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"author_secondary")?0:1;o&&i&&i[l]&&(o.href=e,i[l].src=t),a&&a[l]&&(a[l].src=t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(_,"author_secondary")},replyAsGroupOver:function(_){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"checkbox_official")&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"reply_fakebox_wrap_image")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"disabled"))return!1;var e,t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_submit_post_box",_),o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("deep_active",_);if(e=o&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",_)?[7,8,8]:o?[2,8,8]:[9,8,8],Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(_,{text:function(){return(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"from-oid")||vk.id)<0?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_on_behalf_group"):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_on_behalf_me")},black:1,shift:e}),!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"reply_fakebox_wrap_image")&&(wall.isWallReply(_)||wall.isAdsCreatingPost(_))){var i="/al_groups.php",r="get_editor_clubs";wall.isAdsCreatingPost(_)&&(i="/ads_edit.php",r="a_get_promoted_post_stealth_groups"),ajax.post(i,{act:r},{cache:1})}},replyAsGroupFocus:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"tt");e&&e.isShown()||wall.replyAsGroupOver(_)},replyAsGroup:function(_,e,t){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"checkbox_official")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"disabled"))return t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(t);if(!(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"can_reply_as_any_group")>0)&&wall.isWallReply(_))return wall.replyAsGroupTT(_,e,[]),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(t);if(!wall.isWallReply(_)&&!wall.isAdsCreatingPost(_)||cur.replyAsLoaded)wall.showReplyAsGroupTooltip(_,e);else{var o="/al_groups.php",i="get_editor_clubs";wall.isAdsCreatingPost(_)&&(o="/ads_edit.php",i="a_get_promoted_post_stealth_groups"),ajax.post(o,{act:i},{cache:1,onDone:function(t){cur.replyAsLoaded=t,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(_)&&wall.showReplyAsGroupTooltip(_,e)}})}return t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(t)},showReplyAsGroupTooltip(_,e){var t=!!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("can_reply_only_verified",_),o=(cur.replyAsLoaded||[]).filter(_=>!t||_[0]>0||_[4]);wall.replyAsGroupTT(_,e,o)},replyAsGroupDomData:function(_){var e,t,o,i,r;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",_)){var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",_),"post-id");a&&(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+a)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+a),t=a.split("_")[0])}else e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_submit_post_box",_),t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"oid");return e&&(o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"owner-photo"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"owner-href"),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"owner-name")),t&&o&&i&&r&&[t,o,i,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.J)(r))]||cur.wallTpl&&cur.wallTpl.ownerData||!1},isWallReply:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_submit_post_box",_);return e&&e.id.match(/reply_box(-?\d+)_(\d+)/)},isAdsCreatingPost:function(_){return!!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("ads_edit_ad_submit_post_header",_)},replyAsProfileData:function(){return window.cur&&cur.wallTpl&&cur.wallTpl.profileData||window.wkcur&&wkcur.wallTpl&&wkcur.wallTpl.profileData||window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData},replyAsGroupList:function(_,e){var t=_.hasAttribute("data-disallow-profile")?[]:[wall.replyAsProfileData()],o=wall.replyAsGroupDomData(_);return o&&t.push(o),(wall.isWallReply(_)||wall.isAdsCreatingPost(_))&&each(window.replyAsList,(function(){this[0]!=e&&t.push(this)})),t},replyAsGroupTT:function(_,e,t){window.replyAsList=t||[],window.replyAsData={},each(window.replyAsList,(function(){window.replyAsData[this[0]]=this}));var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"tt"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_submit_post_box",_),r=i&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"from-oid");if(!wall.replyAsProfileData())return!1;if(!o){var a=wall.replyAsGroupList(_,e),l="";_.hasAttribute("data-enable-search")&&(l+='<div class="post_from_tt_row_search_wrap"><input class="clear_fix post_from_tt_row post_from_tt_row_search" value="" placeholder="'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_search")+'" /><div class="post_from_tt_row_search_progress"></div></div>');var s=function(_,e,t,o,i){return'<a id="_post_from_tt_row_oid_'+e+'" class="clear_fix post_from_tt_row _post_from_tt_row_searchable'+_+'" data-from-oid="'+e+'" href="'+t+'"><img class="post_from_tt_image" src="'+o+'" aria-label="'+i+'">'+i+"</a>"};each(a,(function(){var _=r==this[0]?" active":"";l+=s(_,this[0],this[2],this[1],this[3])}));var n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("deep_active",_);o=new ElementTooltip(_,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+l+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"bottom",offset:function(){return wall.isAdsCreatingPost(_)?[_.offsetWidth/2+8.5,-2]:n?[1,-5]:[-10,-5]},onFirstTimeShow:function(e){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post_from_tt_row",e);each(t,(function(e,t){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"post_from_tt_row_search")||addEvent(t,"click",wall.setReplyAsGroup.pbind(_,{from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(this,"from-oid")}))}));var i=geByClass1("post_from_tt_row_search",e);if(i){var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_post_from_tt_row_searchable",e),a=_.getAttribute("data-search-url"),l={};addEvent(i,"keyup valueChanged",(function(){var t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.I)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(i)).toLowerCase();if(a&&t){_.searchRequestTimeout&&(clearTimeout(_.searchRequestTimeout),delete _.searchRequestTimeout);var n=geByClass1("post_from_tt_row_search_progress",e);geByClass1("pr",n)||Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.u)(n),_.searchRequestTimeout=setTimeout((function(){l[t]?Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.i)(n):ajax.plainpost(a,{str:t},(function(i){l[t]=!0,i=JSON.parse(i),each(i,(function(){if(!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("_post_from_tt_row_oid_"+this[0])){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(s("",this[0],this[2],this[1],this[3]));geByClass1("ui_scroll_content",e).appendChild(t),addEvent(t,"click",wall.setReplyAsGroup.pbind(_,{from:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"from-oid")})),window.replyAsData[this[0]]||(window.replyAsData[this[0]]=this)}})),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_post_from_tt_row_searchable",e),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0),Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.i)(n)}),(function(){Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.i)(n)}))}),500)}each(r,(function(_,e){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.yb)(e,""===t||-1!==e.innerText.toLowerCase().indexOf(t))}))}))}this.rows=t,this.scroll=new uiScroll(geByClass1("_post_scroll_wrap",e)),setTimeout((function(){o.scroll.update(),o.updatePosition()}),0)},onShow:function(_){setTimeout((function(){if(o.scroll){var e=geByClass1("active",_),t=e?e.offsetTop-(o.scroll.data.viewportHeight-Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(e)[1])/2:0;o.scroll.scrollTop(t);var i=geByClass1("post_from_tt_row_search",_);i&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.H)(i)}}),0)},onHide:function(_){var e=geByClass1("post_from_tt_row_search",_);e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e,"")}}),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"tt",o)}e&&o.isShown()&&!_.hasAttribute("data-disallow-profile")&&wall.setReplyAsGroup(_,{from:r==vk.id?e:vk.id}),_.tt&&_.tt.hide&&_.tt.hide(),o.isShown()||o.show()},reportPost:function(_,e,t){stManager.add([jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(_,e,"report_"+t)}))},parsePostId:_web_wall_wall_utils__WEBPACK_IMPORTED_MODULE_45__.a,likeIt:function(_,e,t,o){if(Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.j)(o),!vk.id)return!1;if(cur.viewAsBox)return cur.viewAsBox(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(o);var i,r=wall.parsePostId(e),a=r.type,l=r.id,s=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",_))||wall.domPost(l),n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(s,"_like_wrap"),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(n,"_count"),d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(n,"my_like");i=e==cur.wallLayer?"wkview":cur.wallType?"feed"==cur.wallType?"news"==cur.section?"feed_"+(cur.subsection?cur.subsection:cur.section):"recommended"==cur.section?"feed_recommended"+("recent"!=cur.subsection?"_"+cur.subsection:""):"friends"==cur.section||"groups"==cur.section||"videos"==cur.section||"photos"==cur.section?"feed_"+cur.section+(cur.subsection?"_"+cur.subsection:""):"feed_"+cur.section:"top"==cur.wallType?"wall_top":"wall_"+(cur.onepost?"one":(cur.wallType||"").indexOf("full_")?"page":"full"):cur.module,ajax.post("like.php",{act:d?"a_do_unlike":"a_do_like",object:a+l,hash:t,wall:2,from:i},{onDone:Wall.likeFullUpdate.pbind(_,e),onFail:function(){return!0}});var b=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.H)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(c)).replace(/(\s|,)/g,"");return Wall.likeUpdate(_,e,!d,Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(b)+(d?-1:1)),"wall"==a&&window.cur.onLike&&window.cur.onLike(_,a,e,d),cur.onWallLike&&cur.onWallLike(),"wall"==a&&Wall.triggerAdStat(l,"like_post"),!1},likesShow:function(_,e,t){if(!_.postDontShowLikes){t=t||{};var o=wall.parsePostId(e),i=o.type,r=o.id,a=i+r,l=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",_))||wall.domPost(r),s=t.views?"_views_wrap":t.share?"_share_wrap":"_like_wrap",n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(l,s),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"_feedback_info_item")?_:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(n,"_icon"),d=l&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(l,"_share_wrap");if(c&&!cur.viewAsBox){var b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(n)[0],p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(c)[0],u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(c,!0)[0],E=p+u/2-b-41,O=t.views?{views:1}:t.share?{published:1}:{};if(t.listId&&(O.list=t.listId),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(c,"_feedback_info_item")){var h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.O)("em",c);E=-40,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(c,"feedback_share")&&(E+=7),E+=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(h)[0]/2}var w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(c,"_feedback_info_item")?c:c.parentNode;Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(w,{url:"/like.php",params:extend({act:"a_get_stats",object:a,has_share:d?1:""},O),slide:15,shift:[-E,t.views?2:"wall_reply"==i?-3:7],ajaxdt:100,showdt:400,hidedt:200,dir:"auto",checkLeft:!0,reverseOffset:80,noZIndex:!0,tip:{over:function(){Wall.likesShow(_,e,t)}},onShowStart:function(){var e=w.tt.container;setTimeout((function(){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.vb)(e,{left:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.k)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.T)(e,"left"))+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(c)[0]-p})}),10),Object(_web_lib_stats__WEBPACK_IMPORTED_MODULE_22__.bb)("likes_show",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"shown"))},typeClass:"like_tt",className:t.cl||""})}}},likesShowList:function(_,e,t){t=t||{};var o=wall.parsePostId(e),i=o.type,r=o.id,a=i+r,l=_&&(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_post_content",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",_))||wall.domPost(r),s=t.share?"_share_wrap":"_like_wrap",n=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(l,s);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.m)(n,"_icon")&&!cur.viewAsBox&&Object(_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_14__.H)({w:(t.views?"views":t.share?"shares":"likes")+"/"+Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(a)},!1,!1,{queue:1})},sharesShow:function(_,e,t){Wall.likesShow(_,e,extend(t,{share:1}))},sharesShowList:function(_,e,t){Wall.likesShowList(_,e,extend(t,{share:1}))},viewsShowList:function(_,e,t){Wall.likesShowList(_,e,extend(t,{views:1}))},viewsUpdate:function(_,e){var t=wall.parsePostId(e),o={act:"a_get_stats",object:t.type+t.id,views:1};ajax.post("/like.php",o,{cache:1,onDone:function(t,i){Wall.likeUpdate(!1,e,!1,t,void 0,void 0,1);var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.g)("div",{innerHTML:i});_.setAttribute("title",r.innerText||r.textContent),setTimeout(ajax.invalidate.pbind("/like.php",o),3e3)}})},sharesOpen:function(_,e,t){if(cur.viewAsBox)return cur.viewAsBox(),Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(_);if(!vk.id)return!1;Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.j)(_);var o=wall.parsePostId(e),i=o.type,r=o.id,a=i+r;return Object(_web_lib_message_box__WEBPACK_IMPORTED_MODULE_17__.b)("/like.php",extend({act:"publish_box",object:a},t)),"wall"==i&&Wall.triggerAdStat(r,"share_post"),!1},customCur:function(){return window.wkcur&&wkcur.shown?wkcur:window.mvcur&&mvcur.mvShown?mvcur:window.pvcur&&cur.pvShown?pvcur:cur},processPostReplyActions:function(_){},updatePostAuthorData:function(_){Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("_post_author_data_"+_).forEach((function(_){_.post_author_data_update=!0}))},closeComments:function(_,e,t,o,i){var r=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"closed"))?0:1;ajax.post("al_wall.php",{act:"close_comments",owner_id:e,post_id:t,close:r,hash:o},{onDone:function(){if(i)i(r);else{var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",_);Wall.onCloseComments(r,e)}}})},onCloseComments:function(_,e,t){if(e&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"postponed")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"post")&&!vk.widget){var o=geByClass1("comment",e),i=geByClass1("reply_box_inner_wrap",e),r=cur.pgParams&&cur.pgParams.archive||"wall_archive"===cur.module,a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"Post--with_closed_comments_donut");if(t||a||o&&i){r||a||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(e,"closed_comments",_);var l=geByClass1("action_closing_comments",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(l,"closed",_),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(l,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)(_?"wall_open_comments":"wall_closing_comments"))}else{var s=e.id.replace("post","").split("_");ajax.post("al_wall.php",{act:"comment_box",owner_id:s[0],post_id:s[1]},{onDone:function(t,o){if(!r){var i=geByClass1("comment",e),a=geByClass1("reply_box_inner_wrap",e);if(!i&&t){var l=geByClass1("like",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.B)(l))}if(!a&&o){var s=geByClass1("replies_list",e);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(o),s)}}Wall.onCloseComments(_,e,!0)}})}}},showPostEditedTime:function(_){var e=(cur.lang||{}).wall_changed;if(e){var t=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"time")),o=60*((new Date).getTimezoneOffset()+180);t&&Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(_,{text:e.replace("{time}",Object(_web_lib_lang__WEBPACK_IMPORTED_MODULE_26__.c)(t,o)),black:1,shift:[0,4]})}},showPostAuthorData:function(_,e){var t=_.className.match(/_post_author_data_(-?\d+_\d+)/)[1]||"",o=e?e.target:window.event.srcElement;!t||o!=_&&o.onmouseover||(_.post_author_data_update&&(delete _.post_author_data_update,_.post_author_data_tt&&(_.post_author_data_tt.destroy(),_.post_author_data_tt=!1)),_.post_author_data_tt||ajax.post("al_page.php",{act:"post_author_data_tt",raw:t},{onDone:function(e){var o=geByClass1("post_link",_)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(_);if(e&&o){var i={content:e,arrowSize:"mini",cls:"post_author_data",defaultSide:"bottom",align:"left",id:"author_tt_"+t},r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("_im_mess_stack",_);r?i.appendTo=r:i.appendToParent=!0,vk.widget&&(i.offset=[0,-2],i.forceSide="bottom"),_.post_author_data_tt=new ElementTooltip(o,i),_.post_author_data_tt.show()}else _.post_author_data_tt=!0}}))},hideAdsReplacedTT:function(){cur.adsReplacedFeatureTT.destroy(),cur.wallAdsReplacedFeatureTooltip=null,cur.adsReplacedFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.wallAdsReplacedFeatureTooltipHash,type:"ads_in_post_replaced"})},showAdsReplacedTooltip:function(){if(!cur.adsReplacedFeatureTT){var _=setTimeout((function(){var _=geByClass1("addpost_opt");_&&(cur.adsReplacedFeatureTT=new ElementTooltip(_,{content:'<div class="ads_replaced_feature_tt__close" onclick="cur.adsReplacedFeatureTT.hide();"></div>'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_ads_in_post_replaced"),forceSide:"top",cls:"feature_intro_tt ads_replaced_feature_tt",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendTo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_),offset:[1,-10],onHide:Wall.hideAdsReplacedTT}),cur.adsReplacedFeatureTT.show())}),800);cur.destroy.push((function(){clearTimeout(_)})),cur.destroy.push((function(){cur.adsReplacedFeatureTT&&cur.adsReplacedFeatureTT.destroy()}))}},createPostTooltip:_web_page_wall_post_tooltip__WEBPACK_IMPORTED_MODULE_41__.a,showTopWallTooltip:function(_){if(!cur.topWallFeatureTT){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_top");e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(e)||(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_wall_top_more")),e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.fb)(e)&&(cur.topWallFeatureTT=new ElementTooltip(geByClass1("ui_tab",e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("ui_tab",e),{content:'<div class="feature_tooltip__close" onclick="cur.topWallFeatureTT.hide();"></div>'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_top_feature_text"),forceSide:"top",cls:"feature_intro_tt feature_info_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendTo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.q)("page_block",e),onHide:function(){ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"top_wall_web"})}}),cur.topWallFeatureTT.show())}},hidePostCopyrightFeatureTooltip:function(){cur.postCopyrightFeatureTooltip&&cur.postCopyrightFeatureTooltipHash&&(cur.postCopyrightFeatureTooltip=!1,cur.postCopyrightFeatureTT.hide(),setTimeout(()=>{cur.postCopyrightFeatureTT.destroy()},ElementTooltip.FADE_SPEED),ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"}))},showPostCopyrightFeatureTooltip:function(){if(cur.postCopyrightFeatureTooltip&&!cur.postCopyrightFeatureTT){var _=setTimeout(()=>{var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_settings_btn");_&&cur.postCopyrightFeatureTooltip&&(cur.postCopyrightFeatureTT=new ElementTooltip(_,{content:'<div class="feature_tooltip__close" onclick="Wall.hidePostCopyrightFeatureTooltip();"></div>'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_post_copyright_feature_text"),cls:"feature_intro_tt feature_info_tooltip",forceSide:"bottom",autoShow:!1,noOverflow:!1,noHideOnClick:!0,appendToParent:!0,offset:[-6.5,-8],onShow:()=>{ajax.post("al_index.php",{act:"show_feature_tt",hash:cur.postCopyrightFeatureTooltipHash,type:"post_copyright"})},onWindowClick:()=>{cur.postCopyrightFeatureTT&&(cur.postCopyrightFeatureTT.hide(),cur.postField.blur())}}),cur.postCopyrightFeatureTT.show())},800);cur.destroy.push(()=>clearTimeout(_))}},hidePosterFeatureTooltip:function(){cur.posterFeatureTooltip=!1,cur.posterFeatureTT&&cur.posterFeatureTooltipHash&&(cur.posterFeatureTT.destroy(),cur.posterFeatureTT=null,ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.posterFeatureTooltipHash,type:"poster_new_year"}))},showPosterFeatureTooltip:function(){if(cur.posterFeatureTooltip){var _=setTimeout((function(){var _=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.F)(".poster__open-btn",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("page_poster_btn"));if(_&&cur.posterFeatureTooltip){var e='<div class="poster_feature_tt__layout" onclick="cur.posterFeatureTT.hide(); cancelEvent(event);"><div class="poster_feature_tt__close"></div><div class="poster_feature_tt__info">'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_new_posters_new_year")+"</div>";cur.posterFeatureTT=new ElementTooltip(_,{content:e,forceSide:"bottom",cls:"eltt_fancy poster_feature_tt",autoShow:!1,noOverflow:!1,align:"left",centerShift:-28,noHideOnClick:!0,appendToParent:!0,offset:[0,-8],onHide:Wall.hidePosterFeatureTooltip,onWindowClick:function(){cur.posterFeatureTT.hide(),cur.postField.blur()}}),cur.posterFeatureTT.show(),cur.poster&&cur.poster.sendStatsInfo("new_bkg_tooltip_show")}}),800);cur.destroy.push((function(){clearTimeout(_)}))}},toggleRecommFriend:_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_35__.a.toggleRecommFriend,hideRecommFriend:_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_35__.a.hideRecommFriend,onClickRecommFriend:_web_page_friends_recommend__WEBPACK_IMPORTED_MODULE_35__.a.onClickRecommFriend,replyEditPhoto:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!1,(function(){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_more_attaches"+e);if(t){var o=geByClass1("ms_item_photo",t);tooltips.hide(_),o&&o.click()}})),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(t)},replyMoreAttachShow:function(_,e,t){return Wall.showEditReply(e,null,!1,!1,!0,(function(){var _=geByClass1("ms_items_more_wrap",Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_more_attaches"+e));_&&(_.focus(),_.click())})),t&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(t)},replyFakeEmojiOver:function(_){wall.initEditReply(_,!1,!0,(function(){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_smile"+_);if(e){var t=geByClass1("emoji_smile",e);t&&t.onmouseover()}}))},hideDeepReplies:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"reply")&&(e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",e),_=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"post-id"));var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"replies-offset")||0,o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"replies-limit")||3,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+_),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(cur.wallTpl.reply_deep_next,{post_id:_,reply_id:_,offset:t,count:o,text:"",class:" replies_next_main"}));i.innerHTML="",i.appendChild(r),Object(_web_lib_scroll__WEBPACK_IMPORTED_MODULE_23__.g)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(i)[1]-100,0,null,!0),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(r,"collapse",!0),r.click(),cur.wallMyOpened[_]=0},addNewReply:function(_){var e,t=_[2],o=(_[10]||"").match(/wall.showReply\([^-)0-9]*(-?[_0-9]+)[^-)0-9]*(-?[_0-9]+)[^-)0-9]*\)/),i=o&&o[2]||"",r=i&&i!==t,a=cur.wallLayer&&cur.wallLayer===t,l=a?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+t):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+t),s=l.offsetHeight,n=0,c=0;e=r?wall._addDeepReply(_,i):wall._addRootReply(_);var d=a?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("wl_post"):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+t);return wall.incReplyCounter(d,1,_[13]),a?(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(geByClass1("wl_replies_wrap",d)),cur.count++,cur.loaded++):(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)("replies_wrap"+t),Wall.repliesSideSetup(t)),Wall.updateMentionsIndex(),e&&(n=l.offsetHeight-s,c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(e,a)[1]),[n,c]},_addDeepReply:function(_,e){var t,o=_[2],i=_[10]||"",r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(i),a=r&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(r,"root-id")||e,l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+a),s=l&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",l),n=cur.wallLayer&&cur.wallLayer===o?wkcur:cur;if(s&&(a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"post-id"),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+a)),!l)return null;var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+a);if(!c){wall.addDeepRepliesBlock(a);var d=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+a)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+a);d&&hide(d),t=c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+a)}if(!c)return null;if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("reply",c).length){var b=wall._addNewReplyShowMore(o,a,c,"replies_next_deep");t=t||b}else{var p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_short_deep"+a),u=wall.isDescRepliesOrder(o);if(p){var E=geByClass1("replies_short_text_count",p),O=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(E).replace(/[^0-9]/g,""))||0;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(E,Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_replied_to_reply_count",O+1))}else{p=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(n.wallTpl.reply_deep_short,{post_id:o,reply_id:a,reply_msg_id:a.split("_")[1],img_src:_[6]||"",name:_[5]||"",count:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("global_replied_to_reply_count",1)}));var h=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(c);if(h)Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(p,h),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(h,"replies_next_deep")&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.zb)(h,"replies_prev",u);else{c.appendChild(p);var w=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(n.wallTpl.reply_deep_next,{post_id:o,reply_id:a,offset:0,count:1,text:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_next_n_replies",1),class:" replies_next_deep"+(u?" replies_prev":"")}));c.appendChild(w)}}addClass(s,"replies_deep_has_short"),t=p}return wall.updateCollapseDeepReplies(a),removeClass(s,"replies_deep_empty_list"),t},_addRootReply:function(_){var e=_[2],t=cur.wallLayer&&cur.wallLayer===e,o=t?wkcur:cur,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+e),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.p)(i).length,a="full"===o.wallType,l=!r||r<3&&(t||a),s=wall.isDescRepliesOrder(e);if(l){var n=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.r)(_[_.length-1]),c=void 0!==o.options.is_admin?o.options.is_admin:o.options.wall_oid<0?8&n?constants.Groups.GROUPS_ADMIN_LEVEL_EDITOR:2&n?constants.Groups.GROUPS_ADMIN_LEVEL_MODERATOR:constants.Groups.GROUPS_ADMIN_LEVEL_USER:constants.Groups.GROUPS_ADMIN_LEVEL_USER,d=Wall.getNewReplyHTML(_,c,!1,o);if(!d)throw new Error("Failed to add root reply");var b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(d);return Object(_web_lib_legacy__WEBPACK_IMPORTED_MODULE_28__.k)(b),s&&i.firstChild?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(b,i.firstChild):i.appendChild(b),b}return wall._addNewReplyShowMore(e,e,i,"replies_next_main",s)},_addNewReplyShowMore:function(_,e,t,o,i){var r,a,l=cur.wallLayer&&cur.wallLayer===_?wkcur:cur,s=l.options.replies_page_count||20,n=i?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.x)(t):Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.A)(t);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(n,"replies_next"))return(r=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(n,"count")||0)<s?(r++,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(n,"count",r),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(n,i?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_prev_n_replies",r):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_next_n_replies",r))):i&&(a=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(n,"offset")||0,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(n,"offset",a+1)),n;if(i)a=0;else{var c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)(o,t),d=c[c.length-1],b=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.p)(t);if(d){var p=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(d,"count")||s,u=+Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(d,"offset")||0,E=b.indexOf(d);E=(E>=0?E:0)+1,a=u+p+b.slice(E).filter((function(_){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"reply")})).length}else a=b.filter((function(_){return Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(_,"reply")})).length}var O=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(l.wallTpl.reply_deep_next,{post_id:_,reply_id:e,offset:a,count:1,text:i?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_prev_n_replies",1):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_next_n_replies",1),class:" "+(i?" replies_prev":"")+(o?" "+o:"")}));return i?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.z)(O,t.firstChild):t.appendChild(O),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.xb)(O),O},removeDeepReply:function(_){var e=_[2],t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+e),o=0,i=0;if(cur.wallMyDeleted[e]||!t)return[o,i];i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.V)(t,cur.layerpost)[1],Object(_web_lib_video__WEBPACK_IMPORTED_MODULE_25__.g)(t);var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",t)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",t),a=r?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(r,"post-id"):"",l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("replies_wrap_deep",t);if(l)o=-t.offsetHeight,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(t),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.S)(l)[1]&&addClass(l,"replies_deep_empty_list"),wall.updateCollapseDeepReplies(e);else if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+e)){var s=cur.wallLayer&&cur.wallLayer===a?wkcur:cur,n=geByClass1("reply_date",t),c=geByClass1("reply_link_wrap",t),d="",b=attr(t,"onclick");b&&(d+=' onclick="'+b+'"');var p=e.split("_")[0],u=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(p<0?s.wallTpl.reply_deleted_group:s.wallTpl.reply_deleted_user,{reply_id:e,date:n?n.innerHTML:"",answer:c?c.outerHTML:"",class:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"reply_replieable")?" reply_replieable":"",attr:d})),E=t.offsetHeight;Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.G)(t,u),o=u.offsetHeight-E}else o=-t.offsetHeight,Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.kb)(t);return cur.layerpost&&(cur.count--,cur.loaded--),r&&(wall.repliesSideSetup(a),wall.incReplyCounter(r,-1)),[o,i]},addDeepRepliesBlock:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post"+_);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(e,"reply")){var t=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("wl_post",e)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("post",e);if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.ab)(t,"deep_active")){var o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(t,"post-id"),i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies_wrap_deep"+_),r=(cur.wallLayer?wkcur:cur).wallTpl;i||(i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(r.reply_deep,{post_id:o,reply_id:_,reply_msg_id:_.split("_")[1],text:"",offset:0,class:" replies_next_deep"})),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.y)(i,e));var a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+_),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+_);if(!a&&!l){var s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_fakebox"+o)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("reply_box"+o),n=geByClass1("checkbox_official",s)||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Y)("reply_fakebox_with_official",s),c=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(r.reply_box,{post_id:_,owner_name:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.c)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"owner-name")||""),owner_photo:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"owner-photo")||"",owner_href:Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(s,"owner-href")||"",can_reply_as_group:n||"",class:n?" reply_fakebox_with_official":""}));i.appendChild(c),addClass(i,"replies_deep_has_field")}}}},addReplyName:function(_,e){var t={};t[_]=e,wall.addReplyNames(t)},addReplyNames:function(_){var e=cur.wallLayer?wkcur:cur;e.options||(e.options={}),e.options.reply_names=extend({},e.options.reply_names,_)},getReplyNames:function(){return(cur.wallLayer?wkcur:cur).options.reply_names||{}},getReplyName:function(_){return cur.pvShown&&cur.pvReplyNames?cur.pvReplyNames[_]||[]:window.mvcur&&mvcur.mvShown&&!mvcur.minimized?mvcur.mvReplyNames[_]||[]:wall.getReplyNames()[_]||[]},showReorderRepliesTooltip:function(_,e){var t=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;if(!t["postRepliesReorderTT"+e]&&!Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.l)(_,"ett")){var o,i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.C)(_);o=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"hide-smart")||!1?t.wallTpl.replies_reorder_tooltip:t.wallTpl.replies_reorder_tooltip_with_smart;var r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(o||"",{postId:e})),a=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("radiobtn",r),l=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"order")||"asc";radioBtns["post_replies_reorder"+e]={val:l,els:a},a.some((function(_){if(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"order")===l)return Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.c)(_,!0),!0}));var s=new ElementTooltip(_,{appendTo:i,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-10,0],content:r,align:"left"});t["postRepliesReorderTT"+e]=s,cur.destroy.push((function(){s&&s.destroy()})),s.show()}},reorderReplies:function(_,e,t){var o=cur.wallLayer&&cur.wallLayer===e?wkcur:cur;t=t||"asc",Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.r)(_,t,"post_replies_reorder"+e);var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_replies_reorder"+e),r=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"label")||Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(_);Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(i,r),i.setAttribute("aria-label",r),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"order",t),o["postRepliesReorderTT"+e]&&o["postRepliesReorderTT"+e].hide(),wall.moreReplies(e,0,0,{deep:!0,clear:!0,order:t,onDone:function(_,t,o){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("replies"+e);if(o.count>o.offset+o.num){var r=cur.wallLayer&&cur.wallLayer===e?wkcur:cur,a=r.options.replies_page_count||20,l=Math.min(a,o.count-o.offset-o.num),s=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.rb)(Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.qb)(r.wallTpl.reply_deep_next,{post_id:e,reply_id:e,offset:o.offset+o.num,count:l,text:Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_next_n_replies",l),class:" replies_next_main"}));i.appendChild(s)}o.top_reply_ids&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(i,"top-ids",o.top_reply_ids.join(",")),cur.wallMyOpened=cur.wallMyOpened||{},cur.wallMyOpened[e]=1,wall.repliesSideSetup(e)}})},getRepliesOrder:function(_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("post_replies_reorder"+_);return(e?Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(e,"order"):"")||"asc"},isDescRepliesOrder:function(_,e){return"desc"===(e=e||wall.getRepliesOrder(_))},postEventChangeStatus:function(_,e,t,o){var i=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"context");return stManager.add([jsc("web/groups.js")],()=>{Groups.enter(_,e,t,i,(_,t,o)=>{var r=i.split("_"),a=!r[1],l=r[0]+"_"+(a?"decline":""),s=a?Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("events_snippet_will_participate_active"):Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("events_snippet_cant_participate_active");o=o||{},Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post_event_action_btn"+e).forEach(_=>{addClass(_,"secondary"),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(_,s),Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.v)(_,"context",l)}),o.members&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("page_media_event"+e).forEach(_=>{var e=geByClass1("page_media_event_members",_);e&&Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.Cb)(e,o.members)})},{showProgress:()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post_event_action_btn"+e).forEach(_=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.o)(_)})},hideProgress:()=>{Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.K)("post_event_action_btn"+e).forEach(_=>{Object(_web_lib_ui__WEBPACK_IMPORTED_MODULE_18__.w)(_)})}})}),o&&Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(o)},showEventFriends:function(_,e){Object(_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.c)(_,{url:"/al_groups.php",params:{act:"a_event_friends_tt",owner_id:e},ajaxdt:100,showdt:400,hidedt:200,dir:"auto",noZIndex:!0,typeClass:"like_tt"})},showOrderTooltip:function(_){var e=geByClass1("post_replies_reorder");e&&(cur.orderFeatureTT=new ElementTooltip(e,{content:'<div class="feature_tooltip__close" onclick="cur.orderFeatureTT.hide();"></div>'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_order_feature_text"),forceSide:"top",cls:"feature_intro_tt feature_info_tooltip order_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendToParent:!0,offset:[0,-4],onHide:()=>{ajax.post("al_index.php",{act:"hide_feature_tt",hash:_,type:"order_web"}),cur.orderFeatureTT.destroy(),delete cur.orderFeatureTT}}),cur.orderFeatureTT.show())},updateRepliesOnScroll:function(){cur.wallLayer?WkView.wallUpdateRepliesOnScroll():"full"===cur.wallType&&FullWall.onePostOnScroll()},showBestFriendsLockFeatureToolTip(){window.cur.bestFriendsLockFeatureToooltip&&window.cur.bestFriendsLockFeatureToooltip.destroy();var _=document.querySelector(".BestFriendsSettingsEntrypoint");if(_){var e='<div class="feature_intro_tt_hide" onclick="wall.hideBestFriendsLockFeatureTooltip(event);"></div>'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_best_friends_lock_feature_tt");window.cur.bestFriendsLockFeatureToooltip=new ElementTooltip(_,{forceSide:"bottom",autoShow:!1,content:e,appendToParent:!0,cls:"feature_intro_tt feature_intro_blue_tt",offset:[12,-4],onHide:()=>{window.cur.bestFriendsLockFeatureToooltip&&window.cur.bestFriendsLockFeatureToooltip.destroy()},onShow:()=>{ajax.post("/al_index.php",{act:"show_feature_tt",type:"best_friends_lock",hash:cur.wallBestFriendsLockFeatureTooltipHash})}});var t=setTimeout(()=>{window.cur.bestFriendsLockFeatureToooltip.show()},500);window.cur.destroy.push(()=>{window.cur.bestFriendsLockFeatureToooltip&&window.cur.bestFriendsLockFeatureToooltip.destroy(),clearTimeout(t)})}},hideBestFriendsLockFeatureTooltip(_){Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(_),window.cur.bestFriendsLockFeatureToooltip&&(window.cur.bestFriendsLockFeatureToooltip.hide(),cur.wallBestFriendsLockFeatureTooltip=!1,ajax.post("/al_index.php",{act:"hide_feature_tt",type:"best_friends_lock",hash:cur.wallBestFriendsLockFeatureTooltipHash}))},chooseBestFriends(){stManager.add([jsc("web/best_friends.js"),"BestFriends.css"],()=>{window.bestFriendsBoxSettings(_=>{if(0!==_){var e=Object(_web_lib_dom__WEBPACK_IMPORTED_MODULE_13__.J)("best_friends_only"),t=Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_best_friends_settings_box_conversation_friends_count",_);e.innerHTML=Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.n)("visibility_access_best_friends_only_option",{html:Object(_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_20__.n)("visibility_access_best_friends_only_item",{count_text:t}),count:_}),Wall.showEditPost(),Wall.togglePostVisibilityAccess(e,_web_page_wall_constants__WEBPACK_IMPORTED_MODULE_36__.a.ONLY_BEST_FRIENDS,"",!0);var o=document.querySelector(".BestFriendsSettingsEntrypoint");null==o||o.remove()}})})},showBestFriendsSettingsFeatureToolTip(){window.cur.bestFriendsSettingsFeatureToooltip&&window.cur.bestFriendsSettingsFeatureToooltip.destroy();var _=document.getElementById("post_visibility_btn");if(_){var e=`\n        <div class="feature_intro_tt_hide" onclick="wall.hideBestFriendsSettingsFeatureTooltip(event);"></div>\n        ${Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_best_friends_settings_feature_tt")}\n        <button class="flat_button button_small" onclick="wall.chooseBestFriends()">${Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_choose_best_friends")}</button>\n      `;window.cur.bestFriendsSettingsFeatureToooltip=new ElementTooltip(_,{forceSide:"bottom",autoShow:!1,content:e,appendToParent:!0,cls:"feature_intro_tt feature_intro_blue_tt BestFriendsSettingsFeatureTooltip",offset:[50,-4],centerShift:60,onHide:()=>wall.hideBestFriendsSettingsFeatureTooltip()});var t=setTimeout(()=>{window.cur.bestFriendsSettingsFeatureToooltip.show()},500);window.cur.destroy.push(()=>{window.cur.bestFriendsSettingsFeatureToooltip&&window.cur.bestFriendsSettingsFeatureToooltip.destroy(),clearTimeout(t)})}},hideBestFriendsSettingsFeatureTooltip(_){Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(_),window.cur.bestFriendsSettingsFeatureToooltip&&(window.cur.wallBestFriendsSettingsFeatureTooltip=!1,window.cur.bestFriendsSettingsFeatureToooltip.destroy(),window.cur.bestFriendsSettingsFeatureToooltip=null,ajax.post("/al_index.php",{act:"help_hints_hide",hint_id:window.cur.wallBestFriendsSettingsFeatureTooltipKey,hash:window.cur.wallBestFriendsSettingsFeatureTooltipHash}))},showBestFriendsPostFeatureToolTip(_){if(window.cur.wallBestFriendsPostFeatureTooltip=!1,window.cur.bestFriendsPostFeatureToooltip&&window.cur.bestFriendsPostFeatureToooltip.destroy(),_){var e='<div class="feature_intro_tt_hide BestFriendsPostFeatureTooltipButton" onclick="wall.hideBestFriendsPostFeatureTooltip(event);"></div>'+Object(_web_lib_react_lang_utils__WEBPACK_IMPORTED_MODULE_50__.b)("wall_best_friends_post_feature_tt");window.cur.bestFriendsPostFeatureToooltip=new ElementTooltip(_,{forceSide:"bottom",autoShow:!1,content:e,appendToParent:!0,cls:"feature_intro_tt feature_intro_blue_tt",offset:[0,-4],onHide:()=>wall.hideBestFriendsPostFeatureTooltip()});var t=setTimeout(()=>{window.cur.bestFriendsPostFeatureToooltip.show()},500);window.cur.destroy.push(()=>{window.cur.bestFriendsPostFeatureToooltip&&window.cur.bestFriendsPostFeatureToooltip.destroy(),clearTimeout(t)})}},hideBestFriendsPostFeatureTooltip(_){Object(_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_15__.c)(_),window.cur.bestFriendsPostFeatureToooltip&&(window.cur.bestFriendsPostFeatureToooltip.destroy(),window.cur.bestFriendsPostFeatureToooltip=null,ajax.post("/al_index.php",{act:"help_hints_hide",hint_id:window.cur.wallBestFriendsPostFeatureTooltipKey,hash:window.cur.wallBestFriendsPostFeatureTooltipHash}))}};__webpack_exports__.a=Wall},xqyG:function(_,e,t){"use strict";t.d(e,"b",(function(){return i})),t.d(e,"c",(function(){return r})),t.d(e,"a",(function(){return a}));var o=function(){return(o=Object.assign||function(_){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(_[i]=e[i]);return _}).apply(this,arguments)},i=function(_){return function(e){var t,i,r=e.animationData,a=e.animationURL,l=e.container,s=e.loadAnimationParams,n=void 0===s?{}:s,c=r?{animationData:r}:{path:a},d={renderer:"svg",autoplay:null!==(t=null==n?void 0:n.autoplay)&&void 0!==t&&t,loop:null===(i=null==n?void 0:n.loop)||void 0===i||i,rendererSettings:{progressiveLoad:!0}},b=o(o(o({},c),d),{container:l});return _.loadAnimation(b)}},r=function(_,e){_.isLoaded?e():_.addEventListener("DOMLoaded",(function(){e()}))};var a=function(_){var e=_.animationItemGet,t=_.animationItemSet,o=_.loadAnimation;return function(_,i,r){var a=_,l=e({animationId:a}),s=o({animationData:l,animationURL:_,container:i,loadAnimationParams:null==r?void 0:r.loadAnimationParams});return l||function(_,e){_.addEventListener("data_ready",(function(){e(_.animationData)}))}(s,(function(_){t({animationId:a,loadedAnimationData:_})})),s}}},yTQ2:function(_,e,t){"use strict";t("pIFo"),t("HEwt"),t("rGqo"),t("rE2o"),t("ioFf"),t("OG14"),t("a1Th"),t("Btvt");var o=t("Nk8j");function i(_,e){return function(_){if(Array.isArray(_))return _}(_)||function(_,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(_)))return;var t=[],o=!0,i=!1,r=void 0;try{for(var a,l=_[Symbol.iterator]();!(o=(a=l.next()).done)&&(t.push(a.value),!e||t.length!==e);o=!0);}catch(_){i=!0,r=_}finally{try{o||null==l.return||l.return()}finally{if(i)throw r}}return t}(_,e)||function(_,e){if(!_)return;if("string"==typeof _)return r(_,e);var t=Object.prototype.toString.call(_).slice(8,-1);"Object"===t&&_.constructor&&(t=_.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(_,e)}(_,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(_,e){(null==e||e>_.length)&&(e=_.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=_[t];return o}var a="friends_dropdown__list_item",l="friends_dropdown__list_item system_message";var s=class{constructor(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=extend({onUserSelected:()=>!1,onEscapePress:()=>!1,onKeyUp:()=>!1},_),cur.pvServerFriendsIndex&&cur.pvServerFriendsIds||(cur.pvServerFriendsIndex=new vkIndexer([],_=>{var e=i(_,2);e[0];return e[1]}),cur.pvServerFriendsIds=[]),this.topUsers=new vkIndexer([],_=>{var e=i(_,2);e[0];return e[1]}),this.isInited=!1,this.lastSeachTerm="",this.hoverItem=null,this.keyboardNavigation=!1,this.freeTerm=null,this._handleInputKeyEvent=this._handleInputKeyEvent.bind(this),this._handleMouseMoveOnce=this._handleMouseMoveOnce.bind(this)}init(){this.isInited&&this.friendsdListNode||(Object(o.c)()||this.fetchFriendsList(),this.isInited=!0,this._initElement(),this._initScroll());return this.friendsdListNode}update(){var _=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._resetScroll(),this.setTopUsers(_),this._hideDropdown()}setTopUsers(_){this.topUsers.list.forEach(_=>{this.topUsers.remove(_)}),_.forEach(_=>{this.topUsers.add(_)}),this.topUsers.list=_}_hideDropdown(){removeClass(this.friendsdListNode,"show-dropdown")}_getItemHtml(_,e,t,o){return`<div class="${a}" data-id="${_}" data-name="${e}">\n      <img src="${o}" alt="${e}" class="friends_dropdown__list_image">\n      <div class="friends_dropdown__list_info">\n        <div class="friends_dropdown__list_name">${e} ${_===vk.id.toString()?`(${getLang("photos_tags_user_you")})`:""}</div>\n        <div class="friends_dropdown__list_label">${t}</div>\n      </div>\n    </div>`}_initElement(){this.friendsdListNode=ce("div",{className:"friends_dropdown__list"}),this.listInput=ce("input",{className:"friends_dropdown__list_input",placeholder:""+replaceEntities(getLang("photos_tags_dropdown_placeholder"))}),this.listDropdown=ce("div",{className:"friends_dropdown__list_dropdown"}),this.listContent=ce("div",{className:"friends_dropdown__list_content"}),this.listDropdown.appendChild(this.listContent),this.friendsdListNode.appendChild(this.listInput),this.friendsdListNode.appendChild(this.listDropdown),this._setListHTML(`<div class="${l}">${getLang("box_loading")}</div>`),addEvent(this.friendsdListNode,"click",cancelEvent),addEvent(this.listDropdown,"click",_=>{this._handleItemSelected(_.target)}),addEvent(this.listDropdown,"mouseover",_=>{if(!this.keyboardNavigation){var e=hasClass(_.target,a)?_.target:gpeByClass(a,_.target);this._setHoverItem(e)}}),addEvent(this.listInput,"keyup keydown keypress",this._handleInputKeyEvent),addEvent(this.listInput,"click",()=>{this.show()})}_handleItemSelected(_){var e=hasClass(_,a)?_:gpeByClass(a,_),t=domData(e,"name"),o=domData(e,"id");o&&this.options.onUserSelected(o,t),hasClass(_,"add_term_tag")&&this.freeTerm&&this.options.onUserSelected(0,this.freeTerm)}_getItemEleById(_){return window.domQuery1(`[data-id="${_}"]`,this.listDropdown)}_setListHTML(_){(this.listContent.__uiScroll__?this.listContent.__uiScroll__.content:this.listContent).innerHTML=_}_setHoverItem(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=domData(_,"id");if(t&&t!==this.hoverItem){if(this.hoverItem){var o=this._getItemEleById(this.hoverItem);removeClass(o,"hover")}this.hoverItem=t,addClass(_,"hover"),e&&this.scroll&&this.scroll&&this.scroll.scrollIntoView(_)}}show(_){hasClass(this.friendsdListNode,"show-dropdown")||(this._renderFriendsList(this.lastSeachTerm,_),addClass(this.friendsdListNode,"show-dropdown"),this._resetScroll(),this.scroll&&this.scroll.update())}_renderFriendsList(_){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_=trim(_),Object(o.c)()){var t=this._doSearch(_);this._renderFriendsDropdown(_,t,e)}else this._setListHTML(`<div class="${l}">${getLang("box_loading")}</div>`);clearTimeout(this.requestTimeout),_.length>0&&_!==this.lastSeachTerm&&(this.requestTimeout=setTimeout(()=>{this.fetchFriendsWithQuery(_)},300))}_initScroll(){browser.safari||stManager.add(["ui_common.css","ui_common.js"],()=>{this.scroll=new window.uiScroll(this.listContent,{global:!0})})}_handleInputKeyEvent(_){if("keyup"===_.type){switch(_.keyCode){case KEY.ENTER:this._handleEnter();break;case KEY.ESC:return this.options.onEscapePress(),void this._hideDropdown();default:var e=_&&_.target.value;e!==this.lastSeachTerm&&(this._renderFriendsList(e),this.lastSeachTerm=e,this.hoverItem=null)}this.options.onKeyUp(),this.show()}else switch(_.keyCode){case KEY.UP:case KEY.DOWN:this._handleArrows(_.keyCode===KEY.DOWN)}}_handleArrows(){var _,e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.keyboardNavigation||(this.keyboardNavigation=!0,addEvent(this.listDropdown,"mousemove",this._handleMouseMoveOnce)),this.hoverItem)_=this._getItemEleById(this.hoverItem),e=t?domNS(_):domPS(_);else{var o=this.listContent.__uiScroll__?this.listContent.__uiScroll__.content:this.listContent;e=domFC(o)}e&&this._setHoverItem(e,!0)}_handleMouseMoveOnce(){this.keyboardNavigation=!1,removeEvent(this.listDropdown,"mousemove",this._handleMouseMoveOnce)}_handleEnter(){if(this.hoverItem){var _=this._getItemEleById(this.hoverItem);this._handleItemSelected(_)}}_doSearch(){var _,e,t,r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",l=Object(o.d)("tagged"),s=Object(o.c)();a.length>0?(e=this.topUsers.search(a),t=s.search(a),r=cur.pvServerFriendsIndex.search(a)):(e=this.topUsers.list,t=s.list,r=cur.pvServerFriendsIndex.list),_=e.concat(t,r);var n=[];return(_=_.filter(_=>{var e=i(_,1)[0],t=n.indexOf(e)<0&&(!l||!l[e]);return n.push(e),t})).length>20&&(_=_.slice(0,20)),_}_renderFriendsDropdown(_,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="";if(e.forEach(_=>{var e=i(_,4),t=e[0],r=e[1],a=e[2],l=e[3],s="id"+t;o+=this._getItemHtml(t,r,a,l,s)}),!o&&t){this.freeTerm=_,_=clean(_);var r=getLang("photos_tags_not_found_tag_text").replace("{tagName}",`<span class="add_term_tag">${_}</span>`);o=`<div class="${l}">${r}</div>`,this._setListHTML(o)}else o&&(this._setListHTML(o),this.freeTerm=null,this._resetScroll());this.hoverItem=null}focus(){this.listInput.focus()}reset(){this.listInput.value="",this.lastSeachTerm="",this.hoverItem=null,this._resetScroll()}_resetScroll(){this.scroll?this.scroll.scrollTop():this.listContent.scrollTop=0}fetchFriendsList(){ajax.post("hints.php",{act:"a_json_friends",from:"photo_tags"},{onDone:_=>{Object(o.f)(_,()=>{this._renderFriendsList(this.lastSeachTerm)})}})}fetchFriendsWithQuery(_){ajax.post("hints.php",{act:"a_json_friends",from:"photo_tags",str:_,photo:Object(o.d)("id")},{onDone:e=>{this._handleFetchFriends(_,e)}})}_handleFetchFriends(_){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(this.lastSeachTerm===_){var t,r=0,a=Object(o.d)("tagged");(t=a?e.filter(_=>{var e=i(_,1)[0];return!a[e]}):e).forEach(_=>{var e=_[0];cur.pvServerFriendsIds.indexOf(e)<0&&(cur.pvServerFriendsIds.push(e),cur.pvServerFriendsIndex.add(_),r++)}),(r>0||0===t.length)&&this._renderFriendsList(_,!0)}}},n=t("4+be");e.a=class{constructor(_){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=extend({closeOnClick:!0,resetDropdownOnShow:!0,onUserSelected:()=>!1,onMouseLeave:()=>!1,onEscapePressed:()=>!1,onDeleteClicked:()=>!1,onSuggestionDeclined:()=>!1},e),this.container=_,this.friendsDropdown=new s({onUserSelected:this._handleUserSelected.bind(this),onEscapePress:this._handleEscapePress.bind(this),onKeyUp:this._handleStartInteraction.bind(this)}),this.friendsDropdownNode=this.friendsDropdown.init(),this._handleConfirmedTooltipClick=this._handleConfirmedTooltipClick.bind(this),this._handleDocumentClick=this._handleDocumentClick.bind(this),this.renderTooltip()}renderTooltip(){this.tooltipNode=ce("div",{className:"photo_tooltip"},{display:"none"});var _=ce("div",{className:"photo_tooltip__content"});this.sugggestionNode=ce("div"),this.nameNode=ce("div",{className:"photo_tooltip__name"},{display:"none"}),this.listNode=ce("div",{className:"photo_tooltip__suggestion"}),this.listNode.appendChild(this.friendsDropdownNode),addEvent(this.nameNode,"click",this._handleConfirmedTooltipClick),_.appendChild(this.nameNode),_.appendChild(this.sugggestionNode),_.appendChild(this.listNode),this.tooltipNode.appendChild(_),this.container.appendChild(this.tooltipNode),addEvent(this.tooltipNode,"mouseenter",()=>{this.isActive=!0}),addEvent(this.sugggestionNode,"click",_=>{switch(cancelEvent(_),window.domData(_.target,"button")){case"yes":this.options.onUserSelected(this.suggestedUserId,this.suggestedUserName,!0);break;case"no":this.options.onSuggestionDeclined(),hide(this.sugggestionNode),this.userHref=null,this.options.hideAfterDecline?this.hide():(this.showFriendsList(),this.showAndFocusFriendsList())}}),addEvent(this.tooltipNode,"mouseleave",()=>{this.interaction||(this.isActive=!1,this.options.onMouseLeave())}),this.options.closeOnClick&&addEvent(document,"click",this._handleDocumentClick)}_handleDocumentClick(_){this.options.onMouseLeave(),this.interaction=!1,this.isActive=!1,this.hide()}_handleUserSelected(_,e){this.isActive=!1,this.options.onUserSelected(_,e)}_handleEscapePress(){this.isActive=!1,this.interaction=!1,this.friendsDropdown.reset(),this.options.onEscapePressed()}_handleStartInteraction(){this.interaction=!0}_handleConfirmedTooltipClick(_){cancelEvent(_),"button"===_.target.tagName.toLowerCase()?this.options.onDeleteClicked():this.userHref&&this._go(this.userHref,_)}updatePosition(_){var e=_.top,t=_.right,o=_.bottom,i=_.left,r=t-i,a=getSize(this.tooltipNode),l=a[0]?a[0]:280,s="bottom",n=i+Math.floor(r/2)-l/2,c=o;if((n<10||this.hasDropdown&&o>window.clientHeight()-300)&&(s="right_top"),"right_top"===s){n=t,c=e;var d=window.clientHeight()-e;d<300&&(c=e-300+d)}domData(this.tooltipNode,"dir",s),setStyle(this.tooltipNode,{top:c,left:n})}updateSuggestionQuestion(_,e){this.sugggestionNode.innerHTML=this._getSuggestionHTML(_,e),this.suggestedUserName=e,this.suggestedUserId=_}_getSuggestionHTML(_,e){var t=_===vk.id?getLang("photos_tags_user_you"):e;return`<div class="suggested_tag_user">\n      ${Object(n.m)("<div>","</div>",getLang("photos_tags_suggestion_question"),"tag_span").replace("{userName}",`<div class="suggested_tag_user__name">&nbsp;${t}</div>`)}\n      <div class="suggested_tag_user__actions">\n        <button data-button="yes" class="yes">${getLang("box_yes")}</button>\n        <span>&middot;</span>\n        <button data-button="no">${getLang("box_no")}</button>\n      </div>\n    </div>`}updateState(_){var e=_.suggestedUserName,t=_.suggestedUserId,o=_.usersList,i=_.userName,r=_.userHref,a=_.canDeleteTag;this.suggestedUserName=!1,this.suggestedUserId=!1,this.userHref=r,this.hasDropdown=!1,removeClass(this.tooltipNode,"tagged"),i?(this.nameNode.innerHTML=`${i} ${a?"<button>Delete</button>":""}`,toggleClass(this.nameNode,"show_delete",a),show(this.nameNode),hide(this.listNode),hide(this.sugggestionNode),addClass(this.tooltipNode,"tagged")):t?(this.updateSuggestionQuestion(t,e),hide(this.nameNode),hide(this.listNode),show(this.sugggestionNode)):(this.friendsDropdown.update(o),hide(this.nameNode),hide(this.sugggestionNode),this.showFriendsList(),this.hasDropdown=!0)}showFriendsList(){show(this.listNode),this.options.resetDropdownOnShow&&this.resetFriendsDropdown()}resetFriendsDropdown(){this.friendsDropdown.reset()}show(_){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isActive=!1,this.interaction=!1,this.updateState(e),this.updatePosition(_),show(this.tooltipNode),t&&this.friendsDropdown.show(!0),this.friendsDropdown.focus()}hide(){hide(this.tooltipNode)}showAndFocusFriendsList(_){this.userHref?this._go(this.userHref,_):(this.friendsDropdown.focus(),this.friendsDropdown.show())}unMount(){removeEvent(document,"click",this._handleDocumentClick),re(this.tooltipNode)}_go(_,e){e&&e.ctrlKey?window.open(_):nav.go(_,e)}}},zmTt:function(_,e,t){"use strict";t("a1Th"),t("Btvt");var o=t("zxIV"),i=t("Egk5"),r=t("lXE5"),a={init:function(_,e){cur.lSTL&&Object(o.kb)(cur.lSTL);var t=(e=e||{}).parent=e.parent||boxLayerWrap;extend(cur,{lSTLWrap:t,lSTL:t.appendChild(ce("div",{id:"layer_stl",innerHTML:`<div id="layer_stl_bg" class="fixed"></div><div id="layer_stl_cl"></div><nobr id="layer_stl_text" class="fixed">${getLang("global_to_top")}</nobr>`,el:_.bodyNode,onclick:i.c,onmousedown:a.lSTLDown,sc:a.onScroll})),lSTLText:ge("layer_stl_text",t),lSTLShown:0,lSTLWas:0,lSTLWasSet:0,lSTLOpts:e}),_&&_.setOptions({onShow:a.show,onHide:a.hide}),_&&_.scrollInited||(addEvent(t,"scroll",a.onScroll),_&&(_.scrollInited=!0)),onBodyResize(),a.onScroll()},hide:function(_){function e(){return _.apply(this,arguments)}return e.toString=function(){return _.toString()},e}((function(){var _=cur.lSTLOpts;_&&_.parent&&(removeEvent(_.parent,"scroll",a.onScroll),hide(cur.lSTL),cur.lSTLShown=0,_.onHide&&_.onHide())})),show:function(){var _=cur.lSTLOpts;_&&_.parent&&(addEvent(_.parent,"scroll",a.onScroll),setTimeout(a.onScroll,0),_.onShow&&_.onShow())},lSTLDown:function(_){if(_=_||window.event,!Object(i.d)(_)){var e=cur.lSTLWrap;if(!__afterFocus){var t=0,o=e.scrollTop;cur.lSTLWasSet&&cur.lSTLWas?(t=cur.lSTLWas,cur.lSTLWas=0):cur.lSTLWas=o,e.scrollTop=t}return Object(i.c)(_)}},onScroll:function(){if(cur.lSTL){var _=cur.lSTLWrap.scrollTop,e=cur.lSTLWas||_>200,t=0;if(cur.lSTL.style.marginTop=Math.min(_,boxLayer.scrollHeight-cur.lSTL.scrollHeight-1)+"px",vk.staticheader){var i=Object(o.S)("page_header_wrap")[1];cur.lSTLText.style.marginTop=Math.max(-Math.min(Object(r.e)(),bodyNode.clientHeight-(window.lastWindowHeight||0)),-i)+"px"}e?(1!==cur.lSTLShown&&(Object(o.xb)(cur.lSTL),cur.lSTLShown=1),cur.lSTLWas&&_>500&&(cur.lSTLWas=0),_>200?(t=(_-200)/200,cur.lSTLWasSet&&(cur.lSTLWasSet=0,val(Object(o.A)(cur.lSTL),getLang("global_to_top")),removeClass(Object(o.A)(cur.lSTL),"down"))):(t=(200-_)/200,cur.lSTLWas&&(cur.lSTLWasSet||(cur.lSTLWasSet=1,val(Object(o.A)(cur.lSTL),""),addClass(Object(o.A)(cur.lSTL),"down"))))):0!==cur.lSTLShown&&(hide(cur.lSTL),cur.lSTLShown=0),setStyle(cur.lSTL,{opacity:Math.min(Math.max(t,0),1)})}}};e.a=a},zqir:function(_,e,t){"use strict";t.d(e,"a",(function(){return i}));var o=t("ToGb"),i=function(){Object(o.a)()}}});